(this["webpackJsonpe-learn"]=this["webpackJsonpe-learn"]||[]).push([[2],{1010:function(e,t,a){"use strict";a(0);var n=a(13),r=a(1311),o=Object(n.a)((function(e){return{badge:{backgroundColor:"#44b700",color:"#44b700",boxShadow:"0 0 0 2px ".concat(e.palette.background.paper),"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(r.a);t.a=o},1011:function(e,t,a){},1012:function(e,t,a){"use strict";var n=a(812),r=a(0),o=a.n(r),i=a(25),c=a(4),s=a(797),l=a(747),u=a(800),d=a(31),m=(a(900),a(61)),f=a.n(m),p=a(808),h=a(77),v=a.n(h),g=a(1010),b=a(80),y=a(341),E=a(876),k=a.n(E);t.a=Object(i.b)((function(e){return{students:e.common.students,course:e.common.selectedCourse,userId:e.authentication.userId,token:e.authentication.token,configuration:e.common.configuration}}),(function(e){return{setChatUser:function(t){e(c.Cc(t))},setTab:function(t){e(c.Sc(t))}}}))((function(e){var t=e.instructorPanel,a=e.studentPanel,i=e.students,c=e.course,m=e.userId,h=e.setChatUser,E=e.setTab,w=e.token,x=e.isOfficeHour,O=e.configuration,S=Object(y.a)().t,j=o.a.useState([]),C=Object(n.a)(j,2),I=C[0],P=C[1],R=O.isChatAllowedOutsideOfficehours;a&&(R=(O.coursesIsChatAllowedOutsideOfficehours||[]).includes(c._id)),Object(r.useEffect)((function(){var e=v()("https://mernstackelearn.herokuapp.com/",{query:{token:w}});return e.emit("initializeContacts"),e.on("activeUsers",(function(e){P(e)})),function(){return e.off("activeUsers")}}),[]);var _=function(e){var t=i.find((function(t){return e===t._id}));"instructor"===e&&(t=c.courseInstructor),h(t),E(1)},N=o.a.createElement(d.a,null,!x&&!R&&o.a.createElement(b.a,{gutterBottom:!0,variant:"subtitle1"},S(a?"chat.chatInstructorOnlyOfficeHours":"chat.chatStudentOnlyOfficeHours")),(c.regularOfficeHours||[]).map((function(e,t){var a=k()(new Date(Date.now())).tz(e.timezoneRegion).format("z");return o.a.createElement(d.a,{key:e._id},o.a.createElement(d.a,null,o.a.createElement(b.a,{variant:"caption",style:{display:"block",fontWeight:"bold"}},S("courseForm.days.".concat(e.day.toLowerCase()))),o.a.createElement(b.a,{variant:"caption"},"".concat(S("chat.from")," ").concat(e.startTime," ").concat(S("chat.to")," ").concat(e.endTime," ").concat(a))))})),(c.irregularOfficeHours||[]).map((function(e,t){var a=k()(new Date(Date.now())).tz(e.timezoneRegion).format("z");return o.a.createElement(d.a,{key:e._id},o.a.createElement(d.a,null,o.a.createElement(b.a,{variant:"caption",style:{display:"block",fontWeight:"bold"}},"".concat(f()(parseInt(e.date)).locale(localStorage.getItem("i18nextLng")).format("MMMM DD YYYY")," ")),o.a.createElement(b.a,{variant:"caption"}," ".concat(S("chat.from")," ").concat(e.startTime," ").concat(S("chat.to")," ").concat(e.endTime," ").concat(a))))})));return o.a.createElement(s.a,null,a&&o.a.createElement(d.a,null,!x&&a&&!R&&o.a.createElement(d.a,null,N),o.a.createElement(l.a,null,o.a.createElement(u.a,{secondary:S("chat.instructor")})),o.a.createElement(l.a,{disabled:!x&&!R,button:!0,onClick:function(){return _("instructor")}},I.includes(c.courseInstructor._id)?o.a.createElement(g.a,{overlap:"circle",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot"},o.a.createElement(p.a,{style:{marginRight:10},src:c.courseInstructor.profilePicture})):o.a.createElement(p.a,{style:{marginRight:10},src:c.courseInstructor.profilePicture}),o.a.createElement(u.a,{primary:"".concat(c.courseInstructor.firstName," ").concat(c.courseInstructor.lastName)}))),o.a.createElement(d.a,null,!x&&!a&&!R&&o.a.createElement(d.a,null,N),(i||[]).map((function(e,n){return o.a.createElement(d.a,{key:e._id},m!==e._id&&o.a.createElement(d.a,null,0===n&&t||1===n&&a&&o.a.createElement(l.a,null,o.a.createElement(u.a,{secondary:S("chat.students")})),0===n&&o.a.createElement(l.a,null,o.a.createElement(u.a,{secondary:S("chat.students")})),o.a.createElement(l.a,{disabled:t&&!x&&!R,button:!0,onClick:function(){return _(e._id)}},I.includes(e._id)?o.a.createElement(g.a,{overlap:"circle",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot"},o.a.createElement(p.a,{style:{marginRight:10},src:e.profilePicture})):o.a.createElement(p.a,{style:{marginRight:10},src:e.profilePicture}),o.a.createElement(u.a,{primary:"".concat(e.firstName," ").concat(e.lastName)}),o.a.createElement(u.a,{secondary:"ID: ".concat(e._id.replace(/\D/g,""))}))))}))))}))},1013:function(e,t,a){"use strict";var n=a(84);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a(0)),o=(0,n(a(100)).default)(r.default.createElement("path",{d:"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess");t.default=o},1014:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return m}));var n=a(900),r=a(61),o=a.n(r),i=a(876),c=a.n(i),s=function(e){return new Date("01/01/2020 ".concat(e)).getTime()},l=function(e){if(!e)return{isIrregOfficeHour:null,isRegOfficeHour:null};var t="".concat(o()().hour(),":").concat(o()().minutes());return{isRegOfficeHour:(e.regularOfficeHours||[]).findIndex((function(e){var a=s((e||{}).startTime),r=60*c.a.tz.zone((e||{}).timezoneRegion).utcOffset(a)*1e3+a,o=s((e||{}).endTime),i=60*c.a.tz.zone((e||{}).timezoneRegion).utcOffset(o)*1e3+o,l=60*c.a.tz.zone((e||{}).timezoneRegion).utcOffset(s(t))*1e3+s(t);if((new Date).getDay()===Object(n.a)(e.day)&&l>=r&&l<i)return e}))>-1,isIrregOfficeHour:(e.irregularOfficeHours||[]).findIndex((function(e){var a=s((e||{}).startTime),n=60*c.a.tz.zone((e||{}).timezoneRegion).utcOffset(a)*1e3+a,r=s((e||{}).endTime),o=60*c.a.tz.zone((e||{}).timezoneRegion).utcOffset(r)*1e3+r,i=60*c.a.tz.zone((e||{}).timezoneRegion).utcOffset(s(t))*1e3+s(t);if(new Date(Date.now()).setHours(0,0,0,0).toString()===parseInt(e.date).toString()&&i>=n&&i<o)return e}))>-1}},u=function(e,t,a){if(e)return(e.regularOfficeHours||[]).map((function(e){for(var a,r=o()(Date.now()),i=o()(parseInt(Date.now()+1728e5)),c=Object(n.a)(e.day),s=r.clone();s.day(0+c).isBefore(i);){a=s.clone()._d;var l=new Date("".concat(o()(new Date(a)).format("MM/DD/YYYY")," ").concat(e[t])).getTime();return l<Date.now()?null:new Date(l).getTime()}})).sort().filter((function(e){return e}))[0]},d=function(e,t,a){if(e)return(e.irregularOfficeHours||[]).map((function(e){var n=new Date("".concat(o()(parseInt(e.date)).format("MM/DD/YYYY")," ").concat(e[t])).getTime();return n<=(a||Date.now())?null:n})).sort().filter((function(e){return e}))[0]},m=function(e,t){var a,n,r,o,i=l(e),c=i.isIrregOfficeHour,s=i.isRegOfficeHour;return(c||s)&&(n=u(e,"endTime"),o=d(e,"endTime",t)),c||s||(a=u(e,"startTime"),r=d(e,"startTime",t)),[r,a,o,n].filter((function(e){return e})).sort()[0]}},1018:function(e,t,a){"use strict";var n=a(29),r=a(35),o=a(52),i=a(53),c=a(56),s=a(55),l=a(0),u=a.n(l),d=a(25),m=a(77),f=a.n(m),p=a(4),h=a(439),v=a(80),g=a(808),b=a(1010),y=a(6),E=a.n(y),k=a(73),w=a(739),x=a(22),O=a(1259),S=a(445),j=a(1312),C=a(864),I=a.n(C),P=a(1220),R=a.n(P),_=a(437),N=a(746),T=a(242),A=(a(1218),function(){return u.a.createElement("div",{className:"spinner"})}),D=a(895),z=a.n(D),U=a(896),L=a.n(U),M=a(1219),F=a.n(M),H=a(863),B=(a(1011),a(814)),W=a(844),Y=Object(w.a)((function(e){var t;return{formLayout:{display:"flex",justifyContent:"space-between"},appBar:(t={bottom:"48px",top:"auto",width:"100%"},Object(n.a)(t,e.breakpoints.up(500),{bottom:0}),Object(n.a)(t,e.breakpoints.up(600),{width:"calc(100vw - 216px)"}),t),inputContainer:{backgroundColor:Object(x.c)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(x.c)(e.palette.common.white,.25)},borderRadius:e.shape.borderRadius,position:"relative",width:"100%"},icon:{width:e.spacing(7),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit"},inputInput:{padding:e.spacing(1,1,1,7),width:"100%"}}}));var K=Object(N.a)("common")((function(e){var t,a,n,r=e.handleContent,o=e.handleSubmit,i=e.content,c=e.t,s=e.isSelectedInstructor,l=e.isOfficeHour,d=e.isInstructorPanel,m=(e.configuration,e.chatAlwaysOpen),f=e.handleAttachedFile,p=e.loadedFile,h=e.isUploading,v=e.onSetRecorder,g=e.onSetAudioRecorder,b=e.recorder,y=e.stream,w=e.audioRecorder,x=e.audioTimeoutId,C=e.isFile,P=Y();p&&(t=(p||{}).name.toLowerCase().split(".").pop()),"pdf"===t&&(a=u.a.createElement("i",{className:"far fa-file-pdf fa-2x"})),"mp3"===t&&(n="audio"),"docx"!==t&&"doc"!==t||(a=u.a.createElement("i",{className:"fas fa-file-word fa-2x"})),"jpeg"!==t&&"jpg"!==t&&"jfif"!==t||(n="image"),"avi"!==t&&"mp4"!==t&&"mkv"!==t&&"webm"!==t||(n="video");var N,D=w||b||h||!m&&(s&&!l||d&&!l);return p&&(N=URL.createObjectURL(p)),u.a.createElement(O.a,{position:"fixed",className:P.appBar},b&&u.a.createElement(H.a,{muted:!0,playAutomatically:!0,url:y}),p&&u.a.createElement("div",{style:{display:"flex",padding:5}},u.a.createElement("div",{style:{display:"contents"}},"audio"===n&&u.a.createElement(W.a,{audioSource:N}),"image"===n&&u.a.createElement("div",{style:{backgroundImage:'url("'.concat(N,'")'),backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",height:80,borderRadius:"3px",width:"30%"}}),"video"===n&&u.a.createElement(H.a,{url:N})),h&&u.a.createElement("div",{style:{marginLeft:25}}," ",u.a.createElement(A,null)),u.a.createElement("div",{style:{opacity:h?.3:1,color:"white",marginLeft:15}},a),u.a.createElement("div",{style:{marginLeft:15,cursor:"pointer"},onClick:function(){return f("")}},u.a.createElement("i",{style:{color:"#ffc000"},className:"fas fa-window-close fa-2x"}))),u.a.createElement(j.a,{style:{padding:"5px"}},u.a.createElement("div",{className:P.inputContainer},u.a.createElement("form",{onSubmit:o,className:P.formLayout},u.a.createElement("div",{style:{display:"flex",flexDirection:"column-reverse",width:"100%"}},u.a.createElement("div",{style:{display:"flex",flexDirection:"column-reverse",justifyContent:"center"}},u.a.createElement("div",{className:P.icon},u.a.createElement(I.a,null)),u.a.createElement(S.a,{multiline:!0,disabled:!m&&(s&&!l||d&&!l),onChange:r,onKeyPress:function(e){13!==e.keyCode&&13!==e.charCode||D||o(e)},value:i,placeholder:c("chat.typeMessage"),style:{width:"100%"},classes:{root:P.inputRoot,input:P.inputInput},inputProps:{"aria-label":"content"}})),u.a.createElement("div",{style:{display:"flex",alignItems:"flex-end"}},u.a.createElement(_.a,{disabled:p||b,onClick:function(){var e=Object(k.a)(E.a.mark((function e(t){var a,n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w){e.next=10;break}return e.next=3,Object(B.c)(t,null,null,"chatAudioRecorder",function(){var e=Object(k.a)(E.a.mark((function e(t){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:return a=e.sent,e.next=5,f(a.file);case 5:g({audioRecorder:null,audioTimeoutId:null});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0={};case 6:a=e.t0,g({audioRecorder:a.recorder,audioTimeoutId:a.recordingTimeout}),e.next=19;break;case 10:return e.next=12,Object(B.d)(t,null,"chatAudioRecorder",x,w);case 12:if(e.t1=e.sent,e.t1){e.next=15;break}e.t1={};case 15:return n=e.t1,g({audioRecorder:null,audioTimeoutId:null}),e.next=19,f(n.file);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),component:"span"},w?u.a.createElement(L.a,{style:{color:"white"}}):u.a.createElement(z.a,{style:{color:"white",opacity:p||b?.3:1}})),u.a.createElement(_.a,{disabled:p||w,onClick:Object(k.a)(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b){e.next=5;break}return e.next=3,Object(B.a)((function(e){var t=e.recorder,a=e.stream;v({recorder:t,stream:a})}),function(){var e=Object(k.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=6;break;case 5:b.stopRecording(Object(k.a)(E.a.mark((function e(){var t,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=b.getBlob(),a=new File([t],"video-recording.webm",{type:"video/webm"}),e.next=4,f(a);case 4:v({recorder:null,stream:null}),y.stop();case 6:case"end":return e.stop()}}),e)}))));case 6:case"end":return e.stop()}}),e)}))),component:"span"},b?u.a.createElement(L.a,{style:{color:"white"}}):u.a.createElement(F.a,{style:{color:"white",opacity:p||w?.3:1}})),u.a.createElement(T.a,{mimeTypesAllowed:"audio/*, video/*, video/x-matroska, image/jpeg, application/pdf, .doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document",extensionsAllowed:["jpeg","jpg","jfif","png","pdf","docx","doc","mp4","avi","mkv","mp3","webm"],input:{value:"",onChange:function(e){f(e)}},onChangeFile:function(e){},attachIcon:!0,disabled:p||b||w}),C&&u.a.createElement(_.a,{style:{color:"white",opacity:D?.3:1},size:"medium","aria-label":"delete",onClick:o,disabled:D},u.a.createElement(R.a,null))))))))})),V=a(21),q=a(103),G=function(e){Object(c.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleWindowClose=function(e){e.preventDefault(),e.returnValue="";var t="".concat("https://mernstackelearn.herokuapp.com/","delete-files"),a=new FormData;a.append("url",n.state.fileAWSKey),a.append("Authorization","Bearer "+n.props.token),n.setState({fileAWSKey:"",file:""}),fetch(t,{method:"put",headers:new Headers({Authorization:"Bearer "+n.props.token}),body:a,keepalive:!0})},n.handleSetRecorder=function(e){var t=e.recorder,a=e.stream;n.setState({recorder:t,stream:a})},n.handleSetAudioRecorder=function(e){var t=e.audioRecorder,a=e.audioTimeoutId;n.setState({audioRecorder:t,audioTimeoutId:a})},n.handleSubmit=function(e){n.state.content.replace(/\s/g,"").length&&(e.preventDefault(),(n.state.file||n.state.content)&&n.setState((function(e){return n.socket.emit("message",{content:e.content,recipient:n.props.selectedChatUser,course:n.props.course._id,userType:n.props.userType,file:e.fileAWSKey?e.fileAWSKey:null}),{chat:[].concat(Object(r.a)(e.chat),[{sender:n.props.userId,content:e.content,file:e.file}]),content:"",file:"",fileAWSKey:"",recorder:null,audioRecorder:null,audioTimeoutId:null}}),n.scrollToBottom))},n.onHandleAttachedFile=function(e){if(!e)return n.setState({file:"",fileAWSKey:""}),void(n.state.fileAWSKey&&n.props.deleteFile([n.state.fileAWSKey],n.props.token));var t="users/".concat(n.props.userId,"/chat"),a=Object(V.a)(e,t);n.props.uploadFile(e,a,n.props.token,"chat"),n.setState({file:e,fileAWSKey:a})},n.state={chat:[],activeUsers:[],content:"",file:"",fileAWSKey:"",recorder:null,stream:null,audioRecorder:null,audioTimeoutId:null},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("visibilitychange",this.handleWindowClose),this.socket=f()("https://mernstackelearn.herokuapp.com/",{query:{token:this.props.token}});var t=(this.props.notifications||[]).find((function(t){if(t.toSpecificUser===e.props.userId&&t.fromUser===e.props.selectedChatUser._id||t.toSpecificUser===e.props.selectedChatUser._id&&t.fromUser===e.props.userId)return t}));t&&(this.props.markAsSeen(t._id,this.props.token),this.props.fetchNotifications(this.props.token)),this.socket.emit("join",{recipient:this.props.selectedChatUser,course:this.props.course._id}),this.socket.on("init",(function(t){var a=t.messages,n=t.activeUsers;e.setState((function(e){return{chat:[].concat(Object(r.a)(e.chat),Object(r.a)(a.reverse())),activeUsers:n}}),e.scrollToBottom)})),this.socket.on("activeUsers",(function(t){e.setState({activeUsers:t})})),this.socket.on("push",(function(t){e.setState((function(e){return{chat:[].concat(Object(r.a)(e.chat),[t])}}),e.scrollToBottom)}))}},{key:"componentDidUpdate",value:function(e){var t=this;if(this.props.selectedChatUser._id!==e.selectedChatUser._id){var a=(this.props.notifications||[]).find((function(e){if(e.toSpecificUser===t.props.userId&&e.fromUser===t.props.selectedChatUser._id||e.toSpecificUser===t.props.selectedChatUser._id&&e.fromUser===t.props.userId)return e}));a&&(this.props.markAsSeen(a._id,this.props.token),this.props.fetchNotifications(this.props.token)),this.socket.emit("join",{recipient:this.props.selectedChatUser,course:this.props.course._id}),this.socket.on("init",(function(e){var a=e.messages,n=e.activeUsers;t.setState((function(e){return{chat:[].concat(Object(r.a)(e.chat),Object(r.a)(a.reverse())),activeUsers:n}}),t.scrollToBottom)}))}else console.log("user did not change")}},{key:"componentWillUnmount",value:function(){window.removeEventListener("visibilitychange",this.handleWindowClose),this.state.fileAWSKey,this.socket.emit("leave",{recipient:this.props.selectedChatUser}),this.socket.off("activeUsers"),this.socket.off("push")}},{key:"handleContent",value:function(e){this.setState({content:e.target.value})}},{key:"scrollToBottom",value:function(){var e=document.getElementById("chat");e.scrollTop=e.scrollHeight}},{key:"render",value:function(){var e=this.props,t=e.selectedChatUser,a=void 0===t?{}:t,r=e.course,o=e.students,i=void 0===o?[]:o,c=e.isOfficeHour,s=e.instructorPanel,l=e.configuration,d=e.userId,m=e.width,f=e.uploading,p=l.isChatAllowedOutsideOfficehours;s||(p=(l.coursesIsChatAllowedOutsideOfficehours||[]).includes((r||{})._id));var y=(r||{}).courseInstructor,E=(a||{})._id===(y||{})._id,k=200;return m<460&&(k=150),m<360&&(k=100),u.a.createElement("div",{className:"Chat"},u.a.createElement("div",{style:{display:"flex"}},this.state.activeUsers.includes(a._id)?u.a.createElement(b.a,{overlap:"circle",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot"},u.a.createElement(g.a,{src:a.profilePicture})):u.a.createElement(g.a,{src:a.profilePicture}),u.a.createElement(v.a,{style:{padding:"10px"}},"".concat((a||{}).firstName," ").concat((a||{}).lastName))),u.a.createElement(h.a,Object(n.a)({style:{maxHeight:"calc(93vh - 219px)"},id:"chat",elevation:3},"style",{display:"flex",flexDirection:"column",marginBottom:m<500?this.state.file?150:120:this.state.file?100:70}),this.state.chat.map((function(e,t){var a,n;e.file&&(e.file instanceof File?(n=URL.createObjectURL(e.file),a=(e.file||{}).name.toLowerCase().split(".").pop()):(n=e.file,a=(Object(q.a)(e.file)||"").toLowerCase().split(".").pop()));(i||[]).find((function(t){return t._id===e.sender})),y._id,e.sender;var r="jfif"===a||"jpeg"===a||"jpg"===a||"png"===a,o="mp4"===a||"avi"===a||"mkv"===a||"webm"===a,c="mp3"===a,s="pdf"===a,l="docx"===a||"doc"===a;return u.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:e.sender===d?"flex-end":"flex-start",alignSelf:e.sender===d?"flex-end":"flex-start",maxWidth:"80%",minWidth:e.file?c?"20%":"50%":"10%",borderRadius:5,padding:5,marginBottom:5,backgroundColor:e.sender===d?"#0288d1":"#455a64"},key:t},e.file&&r&&u.a.createElement("div",{style:{backgroundImage:'url("'.concat(n,'")'),backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",height:k,borderRadius:"3px",width:"100%"}}),e.file&&(s||l)&&u.a.createElement("a",{href:n},u.a.createElement("div",{style:{borderRadius:"3px",width:"50%"}},l&&u.a.createElement("i",{style:{color:"white"},className:"fas fa-file-word fa-2x"}),s&&u.a.createElement("i",{style:{color:"white"},className:"far fa-file-pdf fa-2x"}))),e.file&&c&&u.a.createElement("div",{className:"chatAudio[".concat(t,"]")},u.a.createElement(W.a,{noSeek:!0,audioSource:n})),e.file&&o&&u.a.createElement(H.a,{url:n}),e.file&&(o||r||c)&&u.a.createElement("a",{href:n},u.a.createElement("i",{style:{color:"white",padding:"5px 0"},className:"fas fa-file-download fa-2x"})),u.a.createElement(v.a,{style:{fontSize:"0.8em",color:"white"},variant:"body1",className:"content"},e.content))}))),u.a.createElement(K,{isOfficeHour:c,isSelectedInstructor:E,content:this.state.content,handleContent:this.handleContent.bind(this),handleSubmit:this.handleSubmit.bind(this),isInstructorPanel:s,chatAlwaysOpen:p,handleAttachedFile:this.onHandleAttachedFile,loadedFile:this.state.file,isUploading:f,onSetRecorder:this.handleSetRecorder,onSetAudioRecorder:this.handleSetAudioRecorder,recorder:this.state.recorder,stream:this.state.stream,audioRecorder:this.state.audioRecorder,audioTimeoutId:this.state.audioTimeoutId,isFile:!!this.state.file}))}}]),a}(u.a.Component);t.a=Object(d.b)((function(e){return{students:e.common.students,userId:e.authentication.userId,course:e.common.selectedCourse,token:e.authentication.token,selectedChatUser:e.common.selectedChatUser,notifications:e.common.notifications,configuration:e.common.configuration,uploading:e.common.uploading,width:e.common.width}}),(function(e){return{fetchNotifications:function(t){e(p.Fb(t))},markAsSeen:function(t,a){e(p.fc(t,a))},uploadFile:function(t,a,n,r){e(p.sd(t,a,n,r))},deleteFile:function(t,a){e(p.P(t),a)}}}))(G)},1218:function(e,t,a){},1219:function(e,t,a){"use strict";var n=a(84);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a(0)),o=(0,n(a(100)).default)(r.default.createElement("path",{d:"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"}),"Videocam");t.default=o},1220:function(e,t,a){"use strict";var n=a(84);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a(0)),o=(0,n(a(100)).default)(r.default.createElement("path",{d:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"}),"Send");t.default=o},814:function(e,t,a){"use strict";a.d(t,"d",(function(){return f})),a.d(t,"c",(function(){return p})),a.d(t,"b",(function(){return h})),a.d(t,"a",(function(){return v}));var n=a(6),r=a.n(n),o=a(812),i=a(73),c=a(934),s=a.n(c),l=a(451),u=a(935),d=a.n(u),m=function(){var e=Object(i.a)(r.a.mark((function e(t,a,n,i){var c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("saving"),c=new s.a({bitRate:128}),(i||{}).lameEncoder&&(c=i),(t||{}).lameEncoder&&(c=t),console.log("is recorder: ",c),!c){e.next=9;break}return e.next=8,c.stop().getMp3().then((function(e){var t=Object(o.a)(e,2),r=t[0],i=t[1];return{blob:URL.createObjectURL(i),file:new File(r,a?"".concat(n,"-[").concat(a,"]recording.mp3"):"".concat(n,"-recording.mp3"),{type:i.type,lastModified:Date.now()}),index:n}}));case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})));return function(t,a,n,r){return e.apply(this,arguments)}}(),f=function(e,t,a,n,r){if(e){e.preventDefault();var o=m(null,t,a,r);return clearTimeout(n),o}},p=function(){var e=Object(i.a)(r.a.mark((function e(t,a,n,o,i){var c,u,d,f;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=new s.a({bitRate:128}),t){e.next=3;break}return e.abrupt("return");case 3:return t.preventDefault(),e.prev=4,e.next=7,c.start();case 7:return u=l.store.getState(),d=u.common.configuration.voiceRecordTimeLimit||60,f=setTimeout((function(){var e=m(c,a,n);i(e)}),1e3*d),e.abrupt("return",{recordingTimeout:f,isRecording:!0,recorder:c,index:n});case 13:return e.prev=13,e.t0=e.catch(4),e.abrupt("return",{isRecording:!1});case 16:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t,a,n,r,o){return e.apply(this,arguments)}}(),h=function(e){var t=document.getElementById(e);t&&t.play()},v=function(){var e=Object(i.a)(r.a.mark((function e(t,a){var n,o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({video:!0,audio:!0});case 3:n=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log("e: ",e.t0);case 9:return o=d()(n,{type:"video",mimeType:"video/webm;codecs=h264",canvas:{width:640,height:480}}),t({recorder:o,stream:n}),o.startRecording(),c=function(e){return new Promise((function(t){return setTimeout(t,e)}))},6e4,e.next=16,c(6e4);case 16:o.stopRecording(Object(i.a)(r.a.mark((function e(){var i,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=o.getBlob(),c=new File([i],"video-recording.webm",{type:"video/webm"}),a(c),t({recorder:null,stream:null}),n.stop();case 5:case"end":return e.stop()}}),e)}))));case 17:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,a){return e.apply(this,arguments)}}()},818:function(e,t,a){"use strict";var n=a(812),r=a(0),o=a.n(r),i=a(739),c=a(1305),s=a(1308),l=a(1307),u=a(80),d=a(893),m=a.n(d),f=Object(i.a)((function(e){return{root:{width:"100%",marginBottom:"20px"},heading:{fontSize:e.typography.pxToRem(15),flexShrink:0},headingModules:{fontSize:e.typography.pxToRem(18),flexShrink:0},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary,marginLeft:"10px"},flex:{display:"flex",marginTop:10,justifyContent:"space-between"},searchItem:{flexGrow:1,width:"98%"}}}));t.a=function(e){var t,a=e.index,i=e.disabled,d=e.summary,p=e.expandedSummary,h=e.secondaryText,v=e.noDetails,g=e.children,b=f(),y=o.a.useState(!1),E=Object(n.a)(y,2),k=E[0],w=E[1];return o.a.createElement(r.Fragment,null,o.a.createElement(c.a,{disabled:i,expanded:k===a,onChange:v?null:(t=a,function(e,a){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),w(a?t:-1)})},o.a.createElement(l.a,{expandIcon:v?null:o.a.createElement(m.a,null),"aria-controls":"panel1bh-content",id:"panel1bh-header"},o.a.createElement("div",null,o.a.createElement(u.a,{className:b.heading},k&&-1!==k&&p||d),o.a.createElement(u.a,{className:b.secondaryHeading},h))),v?null:o.a.createElement(s.a,null,g)))}},822:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(739),i=a(434),c=a(438),s=Object(o.a)((function(e){return{SuccessButton:{background:"#4caf50","&:hover":{backgroundColor:"#388e3c",color:"#FFF"}},ErrorButton:{background:"#c62828","&:hover":{backgroundColor:"#b71c1c",color:"#FFF"}}}})),l=Object(i.a)(c.a)({border:0,borderRadius:3,color:"white",height:48,padding:"0 30px"});t.a=function(e){var t=e.isError,a=e.children,o=e.clicked,i=e.disabled,c=s();return r.a.createElement(n.Fragment,null,r.a.createElement(l,{disabled:i,onClick:o,fullWidth:!0,className:t?c.ErrorButton:c.SuccessButton},a))}},830:function(e,t,a){"use strict";a.d(t,"b",(function(){return h})),a.d(t,"c",(function(){return v})),a.d(t,"a",(function(){return g}));var n=a(0),r=a.n(n),o=a(438),i=a(895),c=a.n(i),s=a(896),l=a.n(s),u=a(837),d=a.n(u),m=a(31),f=a(80),p=a(341),h=function(e){var t=e.onPreview,a=e.audioSource,n=e.id,i=e.previewType,c=e.previewText,s=e.disabled,l=e.fullWidth,u=Object(p.a)().t;return r.a.createElement(m.a,null,"button"===i?r.a.createElement(m.a,null,r.a.createElement("audio",{id:n,src:a}),r.a.createElement(o.a,{fullWidth:l,onClick:t,color:"primary",disabled:!a||""===a||s},c||u("audioRecorder.buttons.preview"))):r.a.createElement("div",{className:d.a.AudioAlignment},r.a.createElement("audio",{id:n,src:a}),r.a.createElement("span",{className:d.a.Pointer,onClick:t},r.a.createElement("i",{className:"fa fa-volume-down fa-2x ".concat(a?d.a.greenIcon:d.a.redIcon)}))))},v=function(e){var t=e.onClear,a=e.clearDisabled,n=Object(p.a)().t;return r.a.createElement("div",{className:d.a.flexPositioningEven},r.a.createElement(o.a,{color:"secondary",onClick:t,disabled:a},n("audioRecorder.buttons.clearAudio")))},g=function(e){var t=e.onStart,a=e.onStop,n=e.onPreview,i=e.recordDisabled,s=e.audioSource,u=e.id,g=e.meta,b=void 0===g?{}:g,y=e.error,E=e.onClear,k=e.clearDisabled,w=(e.playerDisabled,e.recordButtonText),x=e.previewType,O=e.isMicAlert,S=(e.chatRecorder,e.token,Object(p.a)().t);return r.a.createElement(m.a,null,"button"===x&&r.a.createElement("div",{className:d.a.flexPositioningEven},r.a.createElement(o.a,{onClick:t,disabled:i||O,startIcon:r.a.createElement(c.a,null),fullWidth:!0},w||S("audioRecorder.buttons.record"))),r.a.createElement("div",{style:{margin:"auto",display:"block",width:"60%"}},O&&r.a.createElement(f.a,{style:{textAlign:"center"},variant:"caption",color:"error"},S("audioRecorder.errors.micBlocked"))),r.a.createElement("div",{className:d.a.flexPositioningEven},"button"!==x&&r.a.createElement(o.a,{onClick:t,disabled:i||O,startIcon:r.a.createElement(c.a,null)},w||S("audioRecorder.buttons.record")),r.a.createElement(o.a,{onClick:a,disabled:!i||O,startIcon:r.a.createElement(l.a,null)},S("audioRecorder.buttons.stop")),r.a.createElement(h,{onPreview:s?n:null,audioSource:s,id:u,previewType:x})),r.a.createElement("div",{className:d.a.flexPositioningEven},r.a.createElement("span",{className:d.a.errorText},(b.error||y)&&b.touched?b.error||y:""," ")),r.a.createElement("div",{className:d.a.flexPositioningEven},r.a.createElement(v,{onClear:E,clearDisabled:k})))}},832:function(e,t,a){"use strict";var n=a(52),r=a(53),o=a(56),i=a(55),c=a(0),s=a.n(c),l=a(870),u=a.n(l),d=a(922),m=a(248),f=a.n(m),p=a(247),h=a.n(p),v=a(438),g=a(437),b=a(931),y=a.n(b),E=a(930),k=a.n(E),w=a(237),x=a(746);d.pdfjs.GlobalWorkerOptions.workerSrc="//cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(d.pdfjs.version,"/pdf.worker.js");var O=function(e){Object(o.a)(a,e);var t=Object(i.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state={numPages:null,pageNumber:1,scale:.6},e.onDocumentLoadSuccess=function(t){var a=t.numPages;e.setState({numPages:a,pageNumber:1})},e.previousPdfPage=function(){e.state.pageNumber>1&&e.setState({pageNumber:e.state.pageNumber-1})},e.nextPdfPage=function(){e.state.pageNumber<e.state.numPages&&e.setState({pageNumber:e.state.pageNumber+1})},e.setPdfPage=function(t){var a=parseInt(t.target.value),n=a;a>e.state.numPages&&(n=e.state.numPages),a<1&&(n=1),NaN!==a&&a||(n=1),e.setState({pageNumber:parseInt(n)})},e.handleScale=function(t){"in"===t&&e.setState((function(e){return{scale:e.scale+.2}})),"out"===t&&e.setState((function(e){return{scale:e.scale-.2}}))},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.pageNumber,n=t.numPages,r=t.scale,o=this.props,i=o.url,c=o.t,l={label:c("pdf.goToPage"),size:"small"};return s.a.createElement("div",null,s.a.createElement("p",{className:u.a.pageNumberDisplay},c("pdf.page")," ",a," ",c("pdf.of")," ",n),s.a.createElement("div",{className:u.a.flexPositioningEven},s.a.createElement(v.a,{disabled:1===a,color:"default",onClick:this.previousPdfPage,startIcon:s.a.createElement(h.a,null),size:"small"},c("pdf.page")," ",1===a?1:a-1),s.a.createElement(v.a,{disabled:a===n,onClick:this.nextPdfPage,color:"default",endIcon:s.a.createElement(f.a,null),size:"small"},c("pdf.page")," ",a===n?n:a+1)),s.a.createElement("div",{style:{display:"flex",justifyContent:"space-evenly"}},s.a.createElement(w.a,{options:l,input:{onChange:this.setPdfPage}})),s.a.createElement("div",{style:{overflow:"scroll",maxHeight:"450px"}},s.a.createElement(d.Document,{className:u.a.pdfCanvas,file:i,onLoadSuccess:this.onDocumentLoadSuccess,onLoadError:function(e){return console.log(e)},renderMode:"svg"},s.a.createElement(d.Page,{scale:r,pageNumber:a}))),s.a.createElement("div",{className:u.a.flexPositioningEven},s.a.createElement(g.a,{onClick:function(){e.state.scale>=0&&e.handleScale("out")},color:"primary",component:"span"},s.a.createElement(k.a,null)),s.a.createElement(g.a,{onClick:function(){e.handleScale("in")},color:"primary",component:"span"},s.a.createElement(y.a,null))))}}]),a}(c.Component);t.a=Object(x.a)("common")(O)},837:function(e,t,a){e.exports={greenIcon:"AudioPlayer_greenIcon__knaj_",redIcon:"AudioPlayer_redIcon__VtpzN",flexPositioningEven:"AudioPlayer_flexPositioningEven__mBu5R",AudioAlignment:"AudioPlayer_AudioAlignment__1RjTd",Pointer:"AudioPlayer_Pointer__3IoHf",errorText:"AudioPlayer_errorText__1KeLa",advancedAudioPlayer:"AudioPlayer_advancedAudioPlayer__2hxRe","audio-player":"AudioPlayer_audio-player__q667P"}},844:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(932),i=a.n(o),c=(a(837),{width:"fit-content"}),s=[{className:"tier-top",style:{padding:"5px 0",margin:"auto",textAlign:"center"},innerComponents:[{type:"play",style:c},{type:"time",style:c}]}],l=[{className:"tier-top",style:{padding:"5px 0",margin:"auto",textAlign:"center"},innerComponents:[{type:"play",style:c},{type:"time",style:c},{type:"seek"}]}];t.a=function(e){var t=e.audioSource,a=e.noSeek,n=e.id;return r.a.createElement(i.a,{id:n||"audioplayerabc",playerWidth:"100%",audioFiles:[{src:t}],rearrange:a?s:l,iconSize:"1.5rem",fontSize:"1.2rem",sliderClass:"invert-blue-grey",hideForward:!0,hideRewind:!0,hideLoop:!0})}},853:function(e,t,a){"use strict";var n=a(35),r=a(52),o=a(53),i=a(56),c=a(55),s=a(0),l=a.n(s),u=a(332),d=a(13),m=a(1124),f=a(741),p=a(440),h=a(442),v=a(806),g=a(80),b=(a(31),function(e){Object(i.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(r.a)(this,a);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).field=function(t){var a=t.input,r=t.meta,o=t.options,i=t.classes,c=t.column,s=t.error,u=(a.name,a.onChange),d=a.value,b=o.map((function(t,a){var r=t.label,o=t.value,i=t.name,c=d.includes(o);return l.a.createElement("div",{key:r+a,style:{display:"flex",alignItems:"center"}},e.props.numbered&&l.a.createElement(g.a,{style:{marginRight:10},variant:"subtitle1"},a+1),l.a.createElement(f.a,{key:"checkbox-".concat(a),control:l.a.createElement(v.a,{name:"".concat(i,"[").concat(a,"]"),value:o,checked:c,onChange:function(e){var t=Object(n.a)(d);return e.target.checked?t.push(o):t.splice(t.indexOf(o),1),u(t)}}),label:r}))}));return l.a.createElement(p.a,{component:"fieldset"},l.a.createElement(g.a,{variant:"h6"},e.props.title),l.a.createElement(m.a,{row:!c,className:i.Margin},b),l.a.createElement(h.a,null,(r.error||s)&&r.touched?s||r.error:""))},e}return Object(o.a)(a,[{key:"render",value:function(){return l.a.createElement(u.a,Object.assign({name:"checkbox"},this.props,{type:"checkbox",component:this.field}))}}]),a}(s.Component));t.a=Object(d.a)((function(){return{MuiFormLabel:{fontSize:"1.2em"},Margin:{marginBottom:"15px"}}}))(b)},858:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=858},863:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(1002),i=a.n(o);t.a=function(e){var t=e.url,a=e.play,n=e.ended,o=e.pause,c=e.playAutomatically,s=e.muted;return r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(i.a,{playing:c,onPlay:a,onEnded:n,onPause:o,controls:!0,width:"100%",height:"100%",url:t,muted:s}))}},865:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(4),i=a(31),c=a(800),s=a(61),l=a.n(s),u=a(747),d=a(437),m=a(144),f=a.n(m),p=a(821),h=a.n(p),v=a(25),g=a(80),b=a(1309),y=a(847),E=a.n(y),k=a(806),w=a(741),x=a(341),O=function(e){var t=e.lessonSlides.length,a=e.lessonSlides.filter((function(e){return e.seen})).length/t*100;return Number.isNaN(a)?0:Math.round(100*(a+Number.EPSILON))/100};t.a=Object(v.b)((function(e){return{course:e.common.selectedCourse,studentLoggedIn:e.authentication.studentLoggedIn,instructorLoggedIn:e.authentication.instructorLoggedIn,token:e.authentication.token,notifications:e.common.notifications,testInSession:e.studentTest.testInSession}}),(function(e){return{onEditLesson:function(t,a){return e(o.zb(t,a))},changeTab:function(t){return e(o.Sc(t))},openModal:function(t,a){return e(o.nc(t,a))}}}))((function(e){var t=e.course,a=void 0===t?{}:t,n=e.instructorLoggedIn,o=e.studentLoggedIn,s=e.token,m=e.folder,p=e.isModules,v=e.onEditLesson,y=e.openModal,S=e.changeTab,j=e.testInSession,C=Object(x.a)().t;return((a||{}).lessons||[]).map((function(e,t){var x=a.lessons.map((function(e){return e._id})),I=(m||[]).filter((function(e){return"lesson"===e.documentType})).map((function(e){return e.documentId}))||[];if(!I.includes(e._id)&&p)return null;var P=[];return x.forEach((function(e){I.includes(e)&&P.push(e)})),r.a.createElement(i.a,{key:e._id},j&&0===t&&r.a.createElement(g.a,{style:{margin:20},variant:"h4"},"Lessons"),p&&P[0]===e._id&&r.a.createElement(u.a,{style:{background:"#2196f3"}},r.a.createElement(g.a,{style:{color:"white"}},C("lessons.lessons"))),r.a.createElement("div",null,r.a.createElement(u.a,{onClick:function(){y(e,"lesson")},button:!0,disabled:o&&Date.now()<e.availableOnDate},o&&0===(e.lessonSlides||[]).length&&r.a.createElement(w.a,{control:r.a.createElement(k.a,{disabled:!0,checked:!1,value:"checked"})}),o&&(e.lessonSlides||[]).length>0&&r.a.createElement(w.a,{control:r.a.createElement(k.a,{checked:-1===e.lessonSlides.findIndex((function(e){return!e.seen})),value:"checked"})}),p&&r.a.createElement(b.a,{style:{margin:"auto",minWidth:"30px"}},r.a.createElement(E.a,{color:"primary"})),r.a.createElement(c.a,{primary:p?o?"".concat(e.lessonName," ").concat(O(e),"%"):e.lessonName:o?"".concat(C("lessons.lesson")," ").concat(t+1," ").concat(e.lessonName," ").concat(O(e),"%"):"".concat(C("lessons.lesson")," ").concat(t+1," ").concat(e.lessonName),secondary:Date.now()<e.availableOnDate?"".concat(C("lessons.availableOn")," ").concat(l()(parseInt(e.availableOnDate)).locale(localStorage.getItem("i18nextLng")).format("dddd, MMMM DD YYYY, HH:mm")):null}),n&&r.a.createElement(i.a,null,r.a.createElement(d.a,{onClick:function(t){t.stopPropagation(),v((e||{})._id,s),S(1)}},r.a.createElement(h.a,{color:"primary"})),r.a.createElement(d.a,{onClick:function(t){t.stopPropagation(),y(e,"deleteLesson")}},r.a.createElement(f.a,{color:"secondary"}))))))}))}))},870:function(e,t,a){e.exports={pdfCanvas:"PdfViewer_pdfCanvas__2nu4D",flexPositioningEven:"PdfViewer_flexPositioningEven__1Lffj",pageNumberDisplay:"PdfViewer_pageNumberDisplay__qHBe7"}},900:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=function(e){var t;switch(e){case"Sunday":t=0;break;case"Monday":t=1;break;case"Tuesday":t=2;break;case"Wednesday":t=3;break;case"Thursday":t=4;break;case"Friday":t=5;break;case"Saturday":t=6}return t}},923:function(e,t){},924:function(e,t){},925:function(e,t){},926:function(e,t){},927:function(e,t){},937:function(e,t){}}]);
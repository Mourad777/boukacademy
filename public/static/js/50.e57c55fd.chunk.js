(this["webpackJsonpe-learn"]=this["webpackJsonpe-learn"]||[]).push([[50],{1319:function(n,e,t){"use strict";t.r(e);var o=t(19),c=t(0),r=t.n(c),u=t(30),i=t(4),s=t(38),a=t(154),f=t.n(a),l=t(148),d=t(82);e.default=Object(u.b)((function(n){return{token:n.authentication.token,userId:n.authentication.userId,notification:n.common.notification,selectedCourse:n.common.selectedCourse,courses:n.common.courses,tab:n.common.tab,initialPath:n.authentication.initialPath,loading:n.authentication.loading||n.instructorCourse.loading||n.common.loading,instructorLoggedIn:n.authentication.instructorLoggedIn}}),(function(n){var e;return e={fetchUser:function(e){return n(i.Zb(e))},fetchInstructors:function(e){return n(i.Bb(e))},fetchAllStudents:function(e,t){return n(i.pb(e,t))},fetchQuestionBank:function(e,t){return n(i.Nb(e,t))},fetchStudents:function(e,t){return n(i.Qb(e,t))},fetchConfig:function(e){return n(i.sb(e))},setChatUser:function(e){n(i.Hc(e))},setNotification:function(e,t){return n(i.Oc(e,t))},fetchCourses:function(e,t){return n(i.yb(e,t))},fetchNotifications:function(e,t){n(i.Kb(e,t))}},Object(o.a)(e,"fetchUser",(function(e,t){return n(i.Zb(e,t))})),Object(o.a)(e,"markAsSeen",(function(e,t){n(i.kc(e,t))})),Object(o.a)(e,"logout",(function(e){n(i.ic(e))})),e}))((function(n){var e=n.loading,t=n.token,o=n.fetchUser,u=n.fetchAllStudents,i=n.fetchStudents,a=n.fetchInstructors,p=n.fetchNotifications,h=n.fetchCourses,g=n.fetchConfig,b=n.selectedCourse,m=n.logout,S=Object(d.g)();return Object(c.useEffect)((function(){var n=localStorage.getItem("token"),e=localStorage.getItem("userId");if(n){var t=f()("https://mernstackelearn.herokuapp.com/",{query:{token:n}}),c=function(){t.emit("loggedOut",{user:e})};return window.addEventListener("beforeunload",c),t.open(),t.on("newAccount",(function(e){u(n,"noSpinner"),a(n,"noSpinner"),p(n,"noSpinner")})),t.on("updateCourses",(function(e){"instructor"!==e.userType&&"all"!==e.userType||h(n,"noSpinner"),p(n)})),t.on("updateStudents",(function(t){"instructor"!==t.userType&&"all"!==t.userType||t.userId!==e&&t.courseId!==b||(console.log("fetching courses"),b&&(console.log("fetching students"),i(b,n,"noSpinner")),h(n,"noSpinner")),t.userId===e&&t.fetchNotifications&&p(n,"noSpinner")})),t.on("activateAccount",(function(t){t.userId===e&&(o(n,"noSpinner"),g(n,"noSpinner"),p(n,"noSpinner"),h(n,"noSpinner"),a(n,"noSpinner"))})),t.on("suspendAccount",(function(n){n.userId===e&&m(S)})),t.emit("loggedIn",{user:e}),t.on("alert",(function(e){p(n,"noSpinner")})),function(){t.emit("loggedOut",{user:e}),window.removeEventListener("beforeunload",c),t.disconnect()}}}),[t]),Object(c.useEffect)((function(){if(t){var n=f()("https://mernstackelearn.herokuapp.com/",{query:{token:t}});return n.on("updateConfig",(function(n){"all"===n.userType&&g(t)})),function(){n.disconnect()}}}),[b,t]),r.a.createElement(s.a,null,r.a.createElement(l.a,{active:e,transparent:!0}))}))}}]);
(this["webpackJsonpe-learn"]=this["webpackJsonpe-learn"]||[]).push([[11],{1228:function(e,t,n){"use strict";var a=n(83);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(0)),r=(0,a(n(98)).default)(o.default.createElement("path",{d:"M20 6h-8l-2-2H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-1 8h-3v3h-2v-3h-3v-2h3V9h2v3h3v2z"}),"CreateNewFolder");t.default=r},1229:function(e,t,n){"use strict";var a=n(83);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(0)),r=(0,a(n(98)).default)(o.default.createElement("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"}),"Description");t.default=r},1230:function(e,t,n){},1231:function(e,t,n){e.exports={SlideCustomizationContainer:"LessonForm_SlideCustomizationContainer__1urpL",TextEditor:"LessonForm_TextEditor__YGRGl",FormList:"LessonForm_FormList__rwmsr"}},1328:function(e,t,n){"use strict";n.r(t);var a=n(34),o=n(814),r=n(0),s=n.n(r),i=n(4),c=n(30),l=n(1025),u=n(1019),d=n(334),m=n(337),f=n(332),p=n(141),g=n(740),b=n(800),h=n(35),E=n(421),v=n(333),k=n(239),F=n(748),y=n(1316),w=n(803),O=n(1313),T=n(849),x=n.n(T),j=n(824),S=n.n(j),A=n(850),C=n.n(A),_=n(78),D=Object(c.b)((function(e){return{course:e.common.selectedCourse}}))((function(e){var t=e.course,n=e.folderDocs,a=e.folderType,o=e.classes,r=e.isDisabledInput,i=e.childFolderType,c=e.fieldArrayName,l=e.moduleIndex,u=e.subjectIndex,m=e.index,f=e.t,p=e.subjects,g=e.modules,E=e.handleOpenFolder,v=e.updateCategories,k=e.secondaryBlue,O=e.onSelectDocument,T=e.modulesFormValues,j=(t||{}).lessons,A=((t||{}).tests||[]).filter((function(e){return!e.assignment})),D=((t||{}).tests||[]).filter((function(e){return e.assignment}));return s.a.createElement("div",{style:{marginLeft:15,borderLeft:"4px ".concat(k," solid")}},(n||[]).map((function(e){var t,a,i=(n||[]).find((function(e){return"lesson"===e.documentType}))||{},c=(n||[]).find((function(e){return"test"===e.documentType}))||{},l=(n||[]).find((function(e){return"assignment"===e.documentType}))||{};return"test"===e.documentType&&(t=(A||[]).find((function(t){return e.documentId===t._id}))),"assignment"===e.documentType&&(t=(D||[]).find((function(t){return e.documentId===t._id}))),"lesson"===e.documentType&&(t=(j||[]).find((function(t){return e.documentId===t._id}))),t?("test"===e.documentType&&(a=s.a.createElement(x.a,{fontSize:"small",color:"primary"})),"assignment"===e.documentType&&(a=s.a.createElement(S.a,{fontSize:"small",color:"primary"})),"lesson"===e.documentType&&(a=s.a.createElement(C.a,{fontSize:"small",color:"primary"})),s.a.createElement(h.a,{key:e.documentId},["assignment","test","lesson"].map((function(t,n){var a;return 0===n&&(a=l),1===n&&(a=c),2===n&&(a=i),e.documentId===a.documentId&&e.documentType===t?s.a.createElement(F.a,{key:"".concat(t,"[document.documentId]"),style:{marginLeft:15}},s.a.createElement(w.a,{primary:f("instructorModules.".concat(t,"s"))})):null})),s.a.createElement(F.a,{className:o.nestedFile,key:e.documentId,button:!0,onClick:function(){r||O(e.documentType,e.documentId)}},s.a.createElement(y.a,null,a),"test"===e.documentType&&s.a.createElement(w.a,{primary:"".concat(t.testName)}),"assignment"===e.documentType&&s.a.createElement(w.a,{primary:"".concat(t.testName)}),"lesson"===e.documentType&&s.a.createElement(w.a,{primary:"".concat(t.lessonName)})))):null})),"topic"!==a&&s.a.createElement(b.a,{component:"div",disablePadding:!0,subheader:s.a.createElement(_.a,{variant:"h6",align:"center",style:{color:k}},f("instructorModules.".concat(i)))},s.a.createElement(d.a,{name:c,component:G,moduleIndex:"module"===a?m:l,subjectIndex:"subject"===a?m:u,topicIndex:"topic"===a?m:null,t:f,topics:"subject"===a?(p[m]||{}).topics:null,subjects:"module"===a?(g[m]||{}).subjects:null,tests:A,assignments:D,lessons:j,handleOpenFolder:function(e){E(e)},updateCategories:function(e,t,n){return v(e,t,n)},secondaryBlue:k,modulesFormValues:T,folderType:i,onSelectDocument:function(e,t){O(e,t)}})))})),Q=n(440),B=n(1229),N=n.n(B),R=n(1228),q=n.n(R),I=n(250),W=n.n(I),L=n(145),M=n.n(L),V=n(1020),P=n.n(V),z=n(895),U=n.n(z),H=Object(g.a)((function(e){return{root:{overflowX:"hidden",maxWidth:600,margin:"30px auto",paddingLeft:e.spacing(1),paddingTop:30},nested:{paddingLeft:e.spacing(1.5)},nestedTwice:{paddingLeft:e.spacing(2)},nestedFile:{paddingLeft:e.spacing(5)}}})),G=function(e){var t=e.fields,n=(e.meta.error,e.moduleIndex),r=e.subjectIndex,i=(e.topicIndex,e.subjects),c=e.topics,l=e.handleOpenFolder,u=e.updateCategories,d=e.modulesFormValues,m=e.onSelectDocument,f=e.secondaryBlue,p=e.t,g=e.folderType,b=e.modules,E=H(),T=s.a.useState(-1),x=Object(o.a)(T,2),j=x[0],S=x[1];return s.a.createElement(h.a,null,(t||[]).map((function(e,t){var o,T,x,A,C,_;"module"===g&&(o="node[".concat(t,"]"),T="modules.".concat(t,".moduleName"),x=[t],A="modules.".concat(t,".subjects"),C=(b[t]||{}).folder,_="subject"),"subject"===g&&(o="node[".concat(n,"][").concat(t,"]"),T="modules.".concat(n,".subjects.").concat(t,".subjectName"),x=[n,t],A="modules.".concat(n,".subjects.").concat(t,".topics"),C=(i[t]||{}).folder,_="topic"),"topic"===g&&(o="node[".concat(n,"][").concat(r,"][").concat(t,"]"),T="modules.".concat(n,".subjects.").concat(r,".topics.").concat(t,".topicName"),x=[n,r,t],C=(c[t]||{}).folder);var B=-1!==j&&j!==o;return s.a.createElement(h.a,{key:o},s.a.createElement(F.a,{style:{opacity:B?.2:1,cursor:B?"auto":"pointer",borderLeft:B||-1===j?"":"4px ".concat(f," solid"),marginLeft:15},button:!0,onClick:function(){B||function(e,t){S(j===t?-1:t)}(0,o)},className:E.nested},s.a.createElement(w.a,{style:{flex:"none"},primary:"".concat(t+1,".")}),s.a.createElement(v.a,{simple:!0,disabled:B,name:T,onBlur:u,component:k.a,label:"".concat(p("instructorModules.".concat(g))," ").concat(t+1)}),s.a.createElement(y.a,null,s.a.createElement(Q.a,{style:{cursor:B?"auto":"pointer"},onClick:function(e){B||(e.stopPropagation(),l(x))}},s.a.createElement(q.a,null))),s.a.createElement(Q.a,{style:{cursor:B?"auto":"pointer"},onClick:function(e){if(!B){e.stopPropagation();var o=function(e,t,n,o,r,s){var i=(e||{}).modules,c=Object(a.a)(i);return"module"===t&&(c||[]).splice(s,1),"subject"===t&&(((c||[])[n]||{}).subjects||[]).splice(s,1),"topic"===t&&(((((c||[])[n]||{}).subjects||[])[o]||{}).topics||[]).splice(s,1),c}(d,g,n,r,0,t);u(e,o,"deleting")}}},s.a.createElement(M.a,{fontSize:"small",style:{color:f}})),j===o?s.a.createElement(P.a,null):s.a.createElement(U.a,null)),s.a.createElement(O.a,{in:j===o,timeout:"auto",unmountOnExit:!0},s.a.createElement(D,{folderDocs:C,folderType:g,childFolderType:_,fieldArrayName:A,moduleIndex:n,subjectIndex:r,index:t,t:p,subjects:i,modules:b,secondaryBlue:f,onSelectDocument:m,handleOpenFolder:l,updateCategories:u,modulesFormValues:d,classes:E,isDisabledInput:B})))})),s.a.createElement(F.a,{button:!0,onClick:function(){return t.push()}},s.a.createElement(W.a,{style:{color:f}},s.a.createElement(N.a,null)),s.a.createElement(_.a,{style:{color:f}},p("instructorModules.buttons.add".concat(g)))))},Y=Object(g.a)((function(e){return{root:{overflowX:"hidden",maxWidth:600,margin:"30px auto",paddingLeft:e.spacing(1),paddingTop:30},nested:{paddingLeft:e.spacing(1.5)},nestedTwice:{paddingLeft:e.spacing(2)},nestedFile:{paddingLeft:e.spacing(5)}}}));var X=Object(f.a)({form:"category",enableReinitialize:!0,destroyOnUnmount:!1})((function(e){var t=e.initialValues,n=e.token,a=e.formValues,o=e.course,r=e.updateCategory,i=e.loading,c=e.openModal,l=e.closeModal,u=e.width,m=e.isDarkTheme,f=Object(E.a)().t,g=Y(),v=(a||{}).modules,k=(o||{}).lessons,F=((o||{}).tests||[]).filter((function(e){return!e.assignment})),y=((o||{}).tests||[]).filter((function(e){return e.assignment})),w="#0058AE";return m&&(w="#2196f3"),s.a.createElement(h.a,null,s.a.createElement(p.a,{active:i,transparent:!0}),s.a.createElement(b.a,{component:"nav","aria-labelledby":"nested-list-subheader",className:g.root},s.a.createElement(d.a,{name:"modules",component:G,width:u,modules:v||[],secondaryBlue:w,t:f,folderType:"module",updateCategories:function(e,s,i){!function(e,s,i){var c=!!(t||{})._id;r("deleting"===i?{modules:s}:a,n,c,o._id),l()}(0,s,i)},handleOpenFolder:function(e){!function(e){var t,n=e,a=(v||[]).findIndex((function(e,t){return t===(n||[])[0]})),o=(((v||[]).find((function(e,t){return t===(n||[])[0]}))||{}).subjects||[]).findIndex((function(e,t){return t===(n||[])[1]})),r=(((((v||[]).find((function(e,t){return t===(n||[])[0]}))||{}).subjects||[]).find((function(e,t){return t===(n||[])[1]}))||{}).topics||[]).findIndex((function(e,t){return t===(n||[])[2]}));a>-1&&(t="modules.".concat(a,".folder")),o>-1&&(t="modules.".concat(a,".subjects.").concat(o,".folder")),r>-1&&(t="modules.".concat(a,".subjects.").concat(o,".topics.").concat(r,".folder")),c({folderId:e,tests:F,assignments:y,lessons:k,field:t},"contents")}(e)},modulesFormValues:a,onSelectDocument:function(e,t){if("lesson"===e){var n=o.lessons.find((function(e){return e._id===t}));c(n,"lesson")}if("test"===e||"assignment"===e){var a=o.tests.find((function(e){return e._id===t}));c(a,"testSummary")}}})))})),J=Object(c.b)((function(e){return{formValues:Object(m.a)("category")(e),openFolderPath:e.instructorModules.openFolderPath,token:e.authentication.token,initialValues:e.common.modules,course:e.common.selectedCourse,loading:e.instructorModules.loading,width:e.common.width,isDarkTheme:e.common.isDarkTheme}}),(function(e){return{updateCategory:function(t,n,a,o){e(i.rc(t,n,a,o))},clearModalStates:function(){return e(i.p())},openModal:function(t,n){return e(i.tc(t,n))},closeModal:function(){return e(i.v())}}}))(X),K=n(1012),Z=n.n(K),$=Object(c.b)((function(e){return{course:e.common.selectedCourse,token:e.authentication.token,notifications:e.common.notifications}}),(function(e){return{editTest:function(t,n){e(i.Xb(t,!1,n)),e(i.Oc())},openModal:function(t,n){return e(i.tc(t,n))}}}))((function(e){var t=e.course,n=e.token,i=e.editTest,c=e.openModal,l=e.isTest,u=e.isAssignment,d=[];t.studentsEnrollRequests.forEach((function(e){return d.push(e.student)}));var m=Object(E.a)().t,f=Object(r.useState)(-1),p=Object(o.a)(f,2),g=p[0],v=p[1],k=Object(r.useState)([]),y=Object(o.a)(k,2),O=y[0],T=y[1],x=[];(d||[]).forEach((function(e){e.testResults.forEach((function(e){x.push(e.test)}))})),Object(r.useEffect)((function(){return function(){O.forEach((function(e){clearTimeout(e)}))}}),[O]);return s.a.createElement(h.a,null,s.a.createElement(b.a,null,(t.tests||[]).map((function(e,t){return e.assignment&&l||!e.assignment&&u?null:s.a.createElement(h.a,{key:e._id},s.a.createElement(F.a,{dense:!0,button:!0,onClick:function(){c(e,"testSummary")}},s.a.createElement(w.a,{primary:e.testName}),s.a.createElement(w.a,{secondary:e.testType.charAt(0).toUpperCase()+e.testType.slice(1)}),s.a.createElement(Q.a,{onClick:function(t){t.stopPropagation(),c(e,"resetTest")}},s.a.createElement(Z.a,{color:g===t?"primary":"inherit"})),s.a.createElement(Q.a,{disabled:g===t,onClick:function(o){return function(e,t,o){if(e.stopPropagation(),x.includes(t._id)){v(o);var r=setTimeout((function(){v(-1),clearTimeout(r)}),3e3);T([].concat(Object(a.a)(O),[r]))}else i(t._id,n)}(o,e,t)}},s.a.createElement(S.a,{color:g!==t?"primary":"secondary"})),s.a.createElement(Q.a,{onClick:function(t){t.stopPropagation(),c(e,"deleteTest")}},s.a.createElement(M.a,{color:"secondary"}))),x.includes(e._id)&&g===t&&s.a.createElement(_.a,{variant:"caption",color:"error"},m(l?"testForm.errors.resetTestToMakeChanges":"testForm.errors.resetAssignmentToMakeChanges")))}))))})),ee=n(820),te=n(856),ne=n(825),ae=n(244),oe=n(7),re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={isValid:!0,resourcesAreValid:!0};return t.resources=(e.resources||[]).map((function(n,a){var o;return(n||{}).resourceName&&(n.resourceName||"").trim()||(o=oe.a.t("resources.errors.giveResourceName")),(n||{}).resource||(o=oe.a.t("resources.errors.selectResource")),(n||{}).resource instanceof File&&(n||{}).resource.size>1e6*e.instructorFileSizeLimit&&(o=oe.a.t("resources.errors.fileSize",{size:"".concat(e.instructorFileSizeLimit,"MB")})),(o||o)&&(t.resourcesAreValid=!1,t.isValid=!1),{resourceName:o}})),t},se=n(31),ie=function(e){var t=e.fields,n=e.formValues,a=void 0===n?{}:n,o=e.changeDocument,r=e.openModal,i=e.t,c=e.isDarkTheme;return s.a.createElement(h.a,null,s.a.createElement(b.a,null,t.map((function(e,n){var c,l=((a.resources||[])[n]||{}).loadedResource,u=((a.resources||[])[n]||{}).resource instanceof File?((((a.resources||[])[n]||{}).resource||{}).name||"").toLowerCase().split(".").pop():(((a.resources||[])[n]||{}).resource||"").toLowerCase().split(".").pop();return"pdf"===u&&(c=s.a.createElement("i",{className:"far fa-file-pdf fa-2x"})),"docx"!==u&&"doc"!==u||(c=s.a.createElement("i",{className:"fas fa-file-word fa-2x"})),"jpeg"!==u&&"jpg"!==u&&"jfif"!==u||(c=s.a.createElement("i",{className:"fas fa-file-image fa-2x"})),"avi"!==u&&"mp4"!==u||(c=s.a.createElement("i",{className:"far fa-file-video fa-2x"})),s.a.createElement(F.a,{key:n},l&&c&&s.a.createElement("span",{style:{marginRight:20,cursor:"pointer"},onClick:function(e){e.stopPropagation(),r({loadedFile:l,ext:u},"courseResource")}},c),s.a.createElement(v.a,{simple:!0,label:i("resources.buttons.resourceName"),name:"resources.".concat(n,".resourceName"),component:k.a,errorAbsolutePosition:!0}),s.a.createElement(v.a,{name:"resources.".concat(n,".resource"),component:ae.a,loadedFile:l,mimeTypesAllowed:"video/*, image/jpeg, application/pdf, .doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document",extensionsAllowed:["jpeg","jpg","jfif","pdf","docx","doc","mp4","avi"],onChangeFile:function(e){o("resources.".concat(n,".loadedResource"),e)},preview:!1,compressImage:!0,index:n,uploadButtonText:i("resources.buttons.select")}),s.a.createElement(Q.a,{onClick:function(e){e.stopPropagation(),t.remove(n)}},s.a.createElement(M.a,{fontSize:"small",style:{color:"red"}})))}))),s.a.createElement(F.a,{button:!0,onClick:function(){return t.push()}},s.a.createElement(W.a,{style:{color:c?"#2196f3":"#0058AE"}}),s.a.createElement(_.a,{style:{color:c?"#2196f3":"#0058AE"}},i("resources.buttons.addResource"))))},ce=Object(f.a)({form:"courseResources",enableReinitialize:!1,destroyOnUnmount:!0,validate:re})((function(e){var t=e.token,n=e.course,a=(e.modalDocument,e.formValues),i=e.updateResources,c=e.changeDocument,l=e.initialValues,u=e.openModal,m=e.touchField,f=e.configuration,p=e.isDarkTheme,g=Object(r.useState)(null),b=Object(o.a)(g,2),v=b[0],k=b[1],F=Object(r.useState)(!1),y=Object(o.a)(F,2),w=y[0],O=y[1];Object(r.useEffect)((function(){var e=l.resources.map((function(e){return e.resource}));k(e)}),[]);var T=Object(E.a)().t,x=re(a,f).isValid;return s.a.createElement(h.a,null,s.a.createElement(d.a,{name:"resources",formValues:a,component:ie,changeDocument:c,openModal:u,isDarkTheme:p,t:T}),s.a.createElement(ne.a,{clicked:function(){var e=re(a,f).isValid;if(a.resources.forEach((function(e,t){m("resources.".concat(t,".resourceName")),m("resources.".concat(t,".resource"))})),O(!0),e){var o=a.resources.map((function(e){return e.resource})),r=(v||[]).filter((function(e){if(!o.includes(e))return e}));i(n._id,a.resources,r,t)}},isError:w&&!x},T("resources.buttons.updateResources")))})),le=Object(c.b)((function(e){var t=((e.common.courses||[]).find((function(t){return t._id===(e.common.selectedCourse||{})._id}))||{}).resources||[],n=e.common.configuration.instructorFileSizeLimit,a=0===t.length?[{resourceName:""}]:t;return{formValues:Object(m.a)("courseResources")(e),courses:e.common.courses,course:e.common.selectedCourse,modalDocument:e.common.modalDocument,configuration:e.common.configuration,token:e.authentication.token,initialValues:{resources:a,instructorFileSizeLimit:n},isDarkTheme:e.common.isDarkTheme}}),(function(e){return{updateResources:function(t,n,a,o){return e(i.yd(t,n,a,o))},changeDocument:function(t,n){e(Object(se.a)("courseResources",t,n))},openModal:function(t,n){e(i.tc(t,n))},touchField:function(t){e(Object(se.d)("courseResources",t))}}}))(ce),ue=n(24),de=n(51),me=n(52),fe=n(57),pe=n(56),ge=n(339),be=n(247),he=n(252),Ee=n(142),ve=n(238),ke=n(864),Fe=n(240),ye=n(935),we=n(936),Oe=n(938),Te=n(937),xe=n(886),je=n(818),Se=n(446),Ae=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.reduce((function(e,n){return n._id!==t._id?e+n.weight:e}),0),a=t.testWeight||t.assignmentWeight;return!a||parseFloat(a)<0?n:n+(t.isGradeIncluded?parseFloat(parseFloat(a).toFixed(2)):0)},Ce=Object(f.a)({form:"testForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0,validate:Ee.a})((function(e){var t=e.isTest,n=e.course,a=e.formValues,o=void 0===a?{}:a,r=Object(E.a)("common").t,i=[{label:r("testForm.fields.quiz"),value:"quiz",placement:"end",color:"primary"},{label:r("testForm.fields.midterm"),value:"midterm",placement:"end",color:"primary"},{label:r("testForm.fields.final"),value:"final",placement:"end",color:"primary"}],c={label:"".concat(r(t?"testForm.fields.testWeight":"testForm.fields.assignmentWeight")),size:"small",disabled:!o.isGradeIncluded},l={label:r("testForm.fields.testTime"),size:"small",disabled:!o.timedTest,minWidth:223},u={label:r("testForm.fields.passingGrade"),size:"small"},d={label:r("testForm.fields.passingRequired"),size:"small",disabled:"quiz"===o.testType},m={label:r("testForm.fields.dailyPenalty"),size:"small",disabled:!o.allowLateSubmission,minWidth:223},f={label:r("testForm.fields.lateDaysAllowed"),size:"small",disabled:!o.allowLateSubmission,minWidth:223},p={label:r("testForm.fields.timedTest"),checked:!1},g={label:r("testForm.fields.blockLessons"),checked:!1},b={label:r("testForm.fields.allowLateSubmission"),checked:!1},F={label:r("testForm.fields.publish"),checked:!1},y={label:r("testForm.fields.includeGrade"),checked:!0},w=o.testWeight||o.assignmentWeight&&parseFloat(o.testWeight||o.assignmentWeight)>0&&parseFloat(o.testWeight||o.assignmentWeight)<=1e3,O=n.tests.map((function(e){return e._id===o._id?null:["".concat(e.testName," (").concat(e.assignment?r("testForm.assignment"):r("testForm.fields.".concat(e.testType)),")"),"".concat(e.weight," ").concat(r("testForm.points")," (").concat(parseFloat(parseFloat(e.weight/Ae(n.tests,o)*100).toFixed(2)).toString(),"%)")]})).filter((function(e){return e})),T=parseFloat(parseInt(o.testWeight||o.assignmentWeight||0)/Ae(n.tests,o)*100).toFixed(2),x=[{id:"".concat(r(t?"testForm.currentTest":"testForm.currentAssignment")," ").concat(parseFloat(parseFloat(T).toFixed(2)).toString(),"%"),label:r(t?"testForm.currentTest":"testForm.currentAssignment"),value:parseFloat(parseFloat(T).toFixed(2)).toString(),color:"hsl(88, 70%, 50%)"},{id:"".concat(r("testForm.others")," ").concat(parseFloat(parseFloat(100-T).toFixed(2)).toString(),"%"),label:r("testForm.others"),value:parseFloat(parseFloat(100-T).toFixed(2)).toString(),color:"hsl(245, 70%, 50%)"}];return s.a.createElement(h.a,null,s.a.createElement(_.a,{paragraph:!0,variant:"h4",gutterBottom:!0},r(t?"testForm.testCustomization":"testForm.assignmentCustomization")),s.a.createElement(v.a,{name:t?"testName":"assignmentName",type:"text",component:k.a,label:r(t?"testForm.fields.testName":"testForm.fields.assignmentName")}),s.a.createElement(v.a,{name:"published",options:F,component:Fe.a}),s.a.createElement(v.a,{name:"isGradeIncluded",options:y,component:Fe.a}),s.a.createElement("div",{style:{display:"flex",justifyContent:"flex-start"}},s.a.createElement(v.a,{name:t?"testWeight":"assignmentWeight",component:ve.a,options:c}),!!w&&!!o.isGradeIncluded&&s.a.createElement("div",{style:{minWidth:50}},s.a.createElement(_.a,{style:{lineHeight:3,marginLeft:10},paragraph:!0,variant:"body1",gutterBottom:!0}," / ".concat(Ae(n.tests,o))))),!!w&&!!o.isGradeIncluded&&s.a.createElement("div",null,s.a.createElement(_.a,{paragraph:!0,variant:"body1"},r("testForm.worthXOfTheCourse",{weight:o.isGradeIncluded?parseFloat(parseFloat(T).toFixed(2)).toString():0}))),!!w&&!!o.isGradeIncluded&&s.a.createElement("div",{style:{height:200}},s.a.createElement(xe.a,{data:x,testForm:!0})),s.a.createElement(ee.a,{index:"testWeightDistribution",summary:r("testForm.otherTestsWeights")},s.a.createElement(ye.a,{"aria-label":"simple table"},s.a.createElement(we.a,null,O.map((function(e,t){return s.a.createElement(Te.a,{key:t},s.a.createElement(Oe.a,{component:"th",scope:"row"},e[0]),s.a.createElement(Oe.a,{align:"right"},e[1]))}))))),t?s.a.createElement(h.a,null,s.a.createElement(v.a,{name:"blockedNotes",options:g,component:Fe.a}),s.a.createElement(v.a,{name:"timedTest",options:p,component:Fe.a}),s.a.createElement(v.a,{name:"testTime",component:ve.a,options:l}),s.a.createElement(v.a,{component:ke.a,name:"testType",title:r("testForm.fields.testType"),required:!0,options:i,orientation:"horizontal"}),s.a.createElement(v.a,{name:"passingRequired",options:d,component:Fe.a}),s.a.createElement(v.a,{name:"passingGrade",component:ve.a,compact:!0,options:u}),s.a.createElement(v.a,{name:"notes",component:je.a,placeholder:r("testForm.fields.notesPlaceholder"),label:r("testForm.fields.notes"),options:{multiline:!0,rows:3,variant:Se.a},textLabel:!0})):s.a.createElement(h.a,null,s.a.createElement(v.a,{name:"allowLateSubmission",options:b,component:Fe.a}),s.a.createElement(v.a,{disabled:!0,name:"latePenalty",component:ve.a,compact:!0,options:m}),s.a.createElement(v.a,{disabled:!0,name:"lateDaysAllowed",component:ve.a,compact:!0,options:f})))})),_e=Object(c.b)((function(e){return{formValues:Object(m.a)("testForm")(e),course:e.common.selectedCourse}}))(Ce),De=n(855);function Qe(e){var t=Object(r.useRef)();return Object(r.useEffect)((function(){t.current=e})),t.current}var Be=Object(f.a)({form:"testForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0,validate:Ee.a})((function(e){var t=e.formValues,n=void 0===t?{}:t,a=e.setDefaultSectionWeights,o=e.touchCheckboxes,r=e.isTest,i=Object(E.a)("common").t,c=[{label:i("testForm.fields.mc"),value:"mc",placement:"start",color:"primary",name:"mc"},{label:i("testForm.fields.essay"),value:"essay",placement:"start",color:"primary",name:"essay"},{label:i("testForm.fields.speaking"),value:"speaking",placement:"start",color:"primary",name:"speaking"},{label:i("testForm.fields.fillblanks"),value:"fillblanks",placement:"start",color:"primary",name:"fillBlanks"}],l={label:i("testForm.fields.equallyDistributeMarks"),checked:!1,disabled:!((n.testSections||[]).length>1)},u=["Multiple-choice","Essay","Speaking","Fill-in-the-blanks"].map((function(e,t){var a;return"Multiple-choice"===e&&(a="mc"),"Essay"===e&&(a="essay"),"Speaking"===e&&(a="speaking"),"Fill-in-the-blanks"===e&&(a="fillblanks"),{label:i("testForm.fields.".concat(a)),size:"small",disabled:!(n.testSections||[]).includes(a)||n.equalSectionWeight||!((n.testSections||[]).length>1)}})),d=n.equalSectionWeight,m=Qe(d),f=(n.testSections||[]).length,p=Qe(f);return(m!==d||p!==f&&d||1===f)&&a(n.testSections,d),s.a.createElement(h.a,null,s.a.createElement(_.a,{paragraph:!0,variant:"h4",gutterBottom:!0},i("testForm.marksDistribution")),s.a.createElement(v.a,{name:"testSections",title:i(r?"testForm.fields.testSections":"testForm.fields.assignmentSections"),component:De.a,onChange:function(){return o("testSections")},options:c,required:!1,column:!0}),s.a.createElement(v.a,{name:"equalSectionWeight",options:l,component:Fe.a}),s.a.createElement(_.a,{variant:"h6",style:{marginBottom:20}},i("testForm.fields.sectionWeights")),s.a.createElement(v.a,{name:"mcSectionWeight",component:ve.a,options:u[0]}),s.a.createElement(v.a,{name:"essaySectionWeight",component:ve.a,options:u[1]}),s.a.createElement(v.a,{name:"speakingSectionWeight",component:ve.a,options:u[2]}),s.a.createElement(v.a,{name:"fillBlankSectionWeight",component:ve.a,options:u[3]}))})),Ne=Object(c.b)((function(e,t){return{formValues:Object(m.a)("testForm")(e),testForm:e.form.testForm}}),(function(e){return{touchCheckboxes:function(t){e(Object(se.d)("testForm",t))},setDefaultSectionWeights:function(t,n){var a=100/(t||[]).length;(t||[]).includes("mc")?e(Object(se.a)("testForm","mcSectionWeight",n||1!==(t||[]).length?parseFloat(a.toFixed(2)):100)):e(Object(se.a)("testForm","mcSectionWeight",null)),(t||[]).includes("essay")?e(Object(se.a)("testForm","essaySectionWeight",n||1!==(t||[]).length?parseFloat(a.toFixed(2)):100)):e(Object(se.a)("testForm","essaySectionWeight",null)),(t||[]).includes("speaking")?e(Object(se.a)("testForm","speakingSectionWeight",n||1!==(t||[]).length?parseFloat(a.toFixed(2)):100)):e(Object(se.a)("testForm","speakingSectionWeight",null)),(t||[]).includes("fillblanks")?e(Object(se.a)("testForm","fillBlankSectionWeight",n||1!==(t||[]).length?parseFloat(a.toFixed(2)):100)):e(Object(se.a)("testForm","fillBlankSectionWeight",null))}}}))(Be),Re=n(88),qe=Object(f.a)({form:"testForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0,validate:Ee.a})((function(e){var t=e.formValues,n=void 0===t?{}:t,a=e.changeDateTime,o=e.isTest,r=n.createdAt||null,i=Object(E.a)("common").t;return s.a.createElement(h.a,null,s.a.createElement(_.a,{paragraph:!0,variant:"h4",gutterBottom:!0},i("testForm.importantDates")),s.a.createElement(v.a,{name:"availableOnDate",type:"dateTime",handleChange:function(e){return a(e,"availableOnDate")},component:Re.a,options:{disablePast:!0,label:i("testForm.fields.availableOnDate"),minDate:r}}),s.a.createElement(v.a,{name:"gradeReleaseDate",type:"dateTime",handleChange:function(e){return a(e,"gradeReleaseDate")},component:Re.a,options:{disablePast:!0,label:i("testForm.fields.gradeReleaseDate"),minDate:r}}),s.a.createElement(v.a,{name:"dueDate",type:"dateTime",handleChange:function(e){return a(e,"dueDate")},component:Re.a,options:{disablePast:!0,label:i(o?"testForm.fields.closeDate":"testForm.fields.dueDate"),minDate:r},noPaddingBottom:!0}))})),Ie=Object(c.b)((function(e,t){return{formValues:Object(m.a)("testForm")(e)}}),(function(e){return{changeDateTime:function(t,n){e(Object(se.a)("testForm",n,t)),t||e(Object(se.d)("testForm",n))}}}))(qe),We=n(6),Le=n.n(We),Me=n(53),Ve=n(27),Pe=n(241),ze=n(841),Ue=n(835),He=n(816),Ge=n(833),Ye=(n(1230),Object(f.a)({form:"testForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0,validate:Ee.a})((function(e){var t,n=e.formValues,a=void 0===n?{}:n,i=e.changeField,c=e.errors,l=e.isTest,u=e.path,d=Object(E.a)("common").t,m=Object(r.useState)(!1),f=Object(o.a)(m,2),p=f[0],g=f[1],b=Object(r.useState)(null),k=Object(o.a)(b,2),F=k[0],y=k[1];Object(r.useEffect)((function(){return function(){clearTimeout(F)}}),[]);var w,O=a.audioMaterial||{},T=a.readingMaterial||{},x={label:d("testForm.fields.useUploadDoc"),checked:!1},j={label:d("testForm.fields.useUploadAudio"),checked:!1},S=a.materialsDisplay||"",A=((a.audioMaterial||[])[S]||{}).recordingTimeout,C=((a.audioMaterial||[])[S]||{}).recorder||{},D=a.testSections||[],Q=D.includes("mc"),B=D.includes("essay"),N=D.includes("speaking"),R=D.includes("fillblanks"),q=[Q?{value:"multipleChoice",primaryText:d("testForm.fields.mc")}:null,B?{value:"essay",primaryText:d("testForm.fields.essay")}:null,N?{value:"speaking",primaryText:d("testForm.fields.speaking")}:null,R?{value:"fillInTheBlanks",primaryText:d("testForm.fields.fillblanks")}:null,{value:"test",primaryText:d(l?"testForm.fields.atBeginningOfTest":"testForm.fields.atBeginningOfAssignment")}].filter((function(e){return e})),I=function(e,t,n,a){a?(i("audioMaterial.".concat(n,".recording"),a),i("audioMaterial.".concat(n,".recorder"),e),i("audioMaterial.".concat(n,".recordingTimeout"),t)):function(){clearTimeout(F),g(!0);var e=setTimeout((function(){g(!1)}),5e3);y(e)}()},W=function(e,t,n){i("audioMaterial.".concat(n,".recording"),!1),i("audioMaterial.".concat(n,".recordedBlob"),e),i("audioMaterial.".concat(n,".audioFile"),t)},L=((a.audioMaterial||{})[S]||{}).recording,M=(O[S]||{}).recordedBlob,V=["multipleChoice","essay","speaking","fillInTheBlanks","test"],P=V.find((function(e){return((c.readingMaterial||{})[e]||{}).file})),z=V.find((function(e){return((c.audioMaterial||{})[e]||{}).audioFile}));return w=(T[S]||{}).file instanceof File?(((T[S]||{}).file||{}).name||"").split(".").pop():((T[S]||{}).file||"").split(".").pop(),s.a.createElement(h.a,null,s.a.createElement(_.a,{paragraph:!0,variant:"h4",gutterBottom:!0},d(l?"testForm.testResources":"testForm.assignmentResources")),s.a.createElement(v.a,{name:"materialsDisplay",component:ze.a,label:d("testForm.fields.section"),variant:"outlined",options:q,disabled:!(!P&&!z)}),S&&s.a.createElement(h.a,null,s.a.createElement(_.a,{paragraph:!0,variant:"h6",gutterBottom:!0},d("testForm.text")),s.a.createElement(v.a,{name:"readingMaterial.".concat(S,".fileUpload"),options:x,component:Fe.a,type:"checkbox"}),(T[S]||{}).fileUpload&&s.a.createElement(h.a,null,s.a.createElement("div",{style:{textAlign:"center"}},s.a.createElement(v.a,{name:"readingMaterial.".concat(S,".file"),onChangeFile:function(e){i("readingMaterial.".concat(S,".loadedPDF"),e)},fullSizeImage:!0,index:S,loadedFile:(T[S]||{}).loadedPDF,uploadButtonText:d("testForm.buttons.selectDoc"),component:ae.a,mimeTypesAllowed:"image/jpeg, application/pdf, .doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document",extensionsAllowed:["jpeg","jpg","jfif","pdf","docx","doc"]})),(T[S]||{}).loadedPDF&&"pdf"===w&&s.a.createElement(Ue.a,{url:(T[S]||{}).loadedPDF,index:S})),!(T[S]||{}).fileUpload&&s.a.createElement(h.a,null,V.map((function(e){return e===S&&s.a.createElement(v.a,{key:S,name:"readingMaterial.".concat(S,".content"),component:Pe.a,reduxForm:"testForm",field:"readingMaterial.".concat(S,".content"),path:u})}))),s.a.createElement(_.a,{paragraph:!0,variant:"h6",gutterBottom:!0},d("testForm.audio")),s.a.createElement(v.a,{name:"audioMaterial.".concat(S,".fileUpload"),options:j,component:Fe.a,type:"checkbox"})),S&&s.a.createElement(h.a,null,(O[S]||{}).fileUpload?s.a.createElement(h.a,null,s.a.createElement("div",{style:{display:"flex",textAlign:"center",justifyContent:"space-between",margin:"auto",width:"60%"}},s.a.createElement(v.a,(t={name:"audioMaterial.".concat(S,".audioFile"),component:ae.a,uploadButtonText:d("testForm.buttons.selectAudioFile"),index:"materialSectionAudio[".concat(S,"]"),onChangeFile:function(e){i("audioMaterial.".concat(S,".recordedBlob"),e)},loadedFile:L,mimeTypesAllowed:"audio/*",extensionsAllowed:["mp3","wav","wma"]},Object(Ve.a)(t,"mimeTypesAllowed","audio/*"),Object(Ve.a)(t,"extensionsAllowed",["mp3","wav","wma"]),t)),s.a.createElement(Ge.b,{onPreview:function(){M&&Object(He.b)("audioMaterial[".concat(S,"]"))},id:"audioMaterial[".concat(S,"]"),audioSource:M})),s.a.createElement(Ge.c,{onClear:function(){return W(null,null,S)}})):s.a.createElement(Ge.a,{onStart:function(){var e=Object(Me.a)(Le.a.mark((function e(t){var n;return Le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(He.c)(t,null,S,null,function(){var e=Object(Me.a)(Le.a.mark((function e(t){var n;return Le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:n=e.sent,W(n.blob,n.file,S);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:n=e.t0,I(n.recorder,n.recordingTimeout,S,n.isRecording);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onStop:function(){var e=Object(Me.a)(Le.a.mark((function e(t){var n;return Le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(He.d)(t,null,S,A,C);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:n=e.t0,W(n.blob,n.file,S);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onPreview:function(){Object(He.b)("audioMaterial[".concat(S,"]"))},onClear:function(){return W(null,null,S)},id:"audioMaterial[".concat(S,"]"),recordDisabled:L,audioSource:M,isMicAlert:p})))}))),Xe=Object(c.b)((function(e,t){return{formValues:Object(m.a)("testForm")(e),errors:Object(ge.a)("testForm")(e),editing:e.common.editing}}),(function(e){return{changeField:function(t,n){e(Object(se.a)("testForm",t,n))}}}))(Ye),Je=n(263),Ke=n(441),Ze=n(845),$e=n.n(Ze),et=function(e){var t=e.input,n=e.label,a=e.type,o=e.meta,r=o.touched,i=o.error;return s.a.createElement("div",null,s.a.createElement("label",null,n),s.a.createElement("div",null,s.a.createElement("input",Object.assign({className:[$e.a.InputField,$e.a.FullWidth].join(" ")},t,{placeholder:n,type:a})),r&&i&&s.a.createElement("span",null,i)))},tt=function(e){var t=e.clearAnswers,n=e.questionIndex,a=e.fields,o=e.meta.error,r=e.t;return s.a.createElement(h.a,null,s.a.createElement(_.a,{variant:"subtitle1",gutterBottom:!0},r("testForm.writeAnswers")),s.a.createElement(b.a,null,a.map((function(e,o){return s.a.createElement(F.a,{key:o},s.a.createElement(Ke.a,{onClick:function(){a.remove(o),t(n)},color:"secondary",startIcon:s.a.createElement(M.a,null)},""),s.a.createElement(v.a,{name:e,type:"text",component:et,label:""}))})),o&&s.a.createElement(F.a,{className:"error"},o)),s.a.createElement(Ke.a,{fullWidth:!0,color:"primary",onClick:function(){return a.push()}},r("testForm.buttons.addAnswer")))},nt=function(e){var t=e.fields,n=e.meta,a=n.error,o=n.submitFailed,r=e.touchCheckboxes,i=e.clearAnswers,c=e.formValues,l=void 0===c?{}:c,u=e.path,m=e.t;return s.a.createElement("ul",{className:$e.a.TestFormList},t.map((function(e,n){var a=(((l.mcQuestions||[])[n]||{}).answers||[]).map((function(t,n){return{label:"".concat(t||""),value:"".concat(n+1),placement:"start",color:"primary",name:"".concat(e,".correctAnswers")}})),o=s.a.createElement(h.a,null,s.a.createElement(_.a,{variant:"subtitle1",gutterBottom:!0},m("testForm.selectCorrectAnswers")),s.a.createElement(v.a,{name:"".concat(e,".correctAnswers"),component:De.a,onChange:function(){return r("".concat(e,".correctAnswers"))},options:a,required:!1,column:!0}));return s.a.createElement("li",{key:n,className:$e.a.QuestionCustomizationContainer},s.a.createElement(_.a,{variant:"h6",gutterBottom:!0},"".concat(m("testForm.question")," ").concat(n+1)),s.a.createElement("div",{className:$e.a.TextEditor},s.a.createElement(v.a,{name:"".concat(e,".question"),field:"".concat(e,".question"),reduxForm:"testForm",component:Pe.a,index:n,path:u})),s.a.createElement(d.a,{name:"".concat(e,".answers"),questionIndex:n,clearAnswers:i,component:tt,t:m}),o,s.a.createElement(v.a,{name:"".concat(e,".solution"),component:je.a,label:m("testForm.fields.solution"),options:{multiline:!0,rows:3,variant:Se.a},textLabel:!0}),s.a.createElement("div",{style:{marginTop:15}},s.a.createElement(v.a,{name:"".concat(e,".marks"),component:ve.a,options:{label:m("testForm.fields.marks"),size:"small"}})),s.a.createElement(Ke.a,{fullWidth:!0,color:"default",onClick:function(){return t.remove(n)},disabled:1===(l.mcQuestions||[]).length},m("testForm.buttons.removeQuestion")))})),s.a.createElement("li",null,s.a.createElement(Ke.a,{color:"default",onClick:function(){return t.push({marks:1})},fullWidth:!0},m("testForm.buttons.addQuestion")),o&&a&&s.a.createElement("span",null,a)))},at=Object(f.a)({form:"testForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0,enableReinitialize:!1,validate:Ee.a})((function(e){var t=e.clearAnswers,n=e.formValues,a=void 0===n?{}:n,o=Object(Je.a)(e,["clearAnswers","formValues"]),r=Object(E.a)(),i=r.t,c=(r.i18n,(a.mcQuestions||[]).length);return s.a.createElement(h.a,null,s.a.createElement(_.a,{variant:"h4",gutterBottom:!0},i("testForm.mcSection")),s.a.createElement(d.a,{name:"mcQuestions",clearAnswers:t,props:o,formValues:a,component:nt,t:i}),s.a.createElement(ee.a,{index:0,summary:i("testForm.selectQuestion")},s.a.createElement(te.a,{questionType:"Multiple-choice questions",selecting:!0,indexToAdd:c})))})),ot=Object(c.b)((function(e){return{formValues:Object(m.a)("testForm")(e),initialValues:e.instructorTest.loadedTestFormData}}),(function(e){return{clearAnswers:function(t){e(Object(se.a)("testForm","mcQuestions[".concat(t,".correctAnswers]"),[]))},touchCheckboxes:function(t){e(Object(se.d)("testForm",t))}}}))(at),rt=function(e){var t=e.fields,n=e.meta,a=n.error,o=n.submitFailed,r=e.formValues,i=e.path,c=e.t;return s.a.createElement("ul",{className:$e.a.TestFormList},t.map((function(e,n){return s.a.createElement("li",{className:$e.a.QuestionCustomizationContainer,key:n},s.a.createElement(_.a,{variant:"h6",gutterBottom:!0},"".concat(c("testForm.question")," ").concat(n+1)),s.a.createElement("div",{className:$e.a.TextEditor},s.a.createElement(v.a,{name:"".concat(e,".question"),field:"".concat(e,".question"),reduxForm:"testForm",component:Pe.a,index:n,path:i})),s.a.createElement(v.a,{name:"".concat(e,".solution"),component:je.a,label:c("testForm.fields.solution"),options:{multiline:!0,rows:3,variant:Se.a},textLabel:!0}),s.a.createElement("div",{style:{marginTop:15}},s.a.createElement(v.a,{name:"".concat(e,".marks"),component:ve.a,options:{label:c("testForm.fields.marks"),size:"small"}})),s.a.createElement(Ke.a,{onClick:function(){return t.remove(n)},fullWidth:!0,disabled:1===((r||{}).essayQuestions||[]).length},c("testForm.buttons.removeQuestion")))})),s.a.createElement("li",null,s.a.createElement(Ke.a,{onClick:function(){return t.push({marks:1})},fullWidth:!0},c("testForm.buttons.addQuestion")),o&&a&&s.a.createElement("span",null,a)))},st=Object(f.a)({form:"testForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0,validate:Ee.a})((function(e){var t=e.formValues,n=void 0===t?{}:t,a=e.path,o=Object(E.a)().t,r=(n.essayQuestions||[]).length;return s.a.createElement(h.a,null,s.a.createElement(_.a,{variant:"h4",gutterBottom:!0},o("testForm.essaySection")),s.a.createElement(d.a,{name:"essayQuestions",component:rt,formValues:n,path:a,t:o}),s.a.createElement(ee.a,{index:0,summary:o("testForm.selectQuestion")},s.a.createElement(te.a,{questionType:"Essay questions",selecting:!0,indexToAdd:r})))})),it=Object(c.b)((function(e){return{formValues:Object(m.a)("testForm")(e),token:e.authentication.token,initialValues:e.instructorTest.loadedTestFormData}}),null)(st),ct=n(947),lt=function(e){var t=e.changeField,n=e.makeAudioFieldTouched,a=e.fields,i=e.meta,c=e.formValues,l=void 0===c?{}:c,u=e.path,d=e.t,m=Object(r.useState)(!1),f=Object(o.a)(m,2),p=f[0],g=f[1],b=Object(r.useState)(null),E=Object(o.a)(b,2),k=E[0],F=E[1];Object(r.useEffect)((function(){return function(){clearTimeout(k)}}),[]);var y={label:d("testForm.fields.audioQuestion"),checked:!1},w={label:d("testForm.fields.audioAnswer"),checked:!1},O=function(e,n,a,o,r){r?("question"===o&&(t("speakingQuestions.".concat(a,".isRecordingQuestion"),r),t("speakingQuestions.".concat(a,".questionRecorder"),e),t("speakingQuestions.".concat(a,".questionRecordingTimeout"),n)),"answer"===o&&(t("speakingQuestions.".concat(a,".isRecording"),!0),t("speakingQuestions.".concat(a,".recorder"),e),t("speakingQuestions.".concat(a,".recordingTimeout"),n))):function(){clearTimeout(k),g(!0);var e=setTimeout((function(){g(!1)}),5e3);F(e)}()},T=function(e,a,o,r){"question"===r&&(t("speakingQuestions.".concat(o,".isRecordingQuestion"),!1),t("speakingQuestions.".concat(o,".questionRecordedBlob"),e),t("speakingQuestions.".concat(o,".audioFileQuestion"),a),n("speakingQuestions.".concat(o,".questionRecordedBlob"))),"answer"===r&&(t("speakingQuestions.".concat(o,".isRecording"),!1),t("speakingQuestions.".concat(o,".recordedBlob"),e),t("speakingQuestions.".concat(o,".audioFile"),a),n("speakingQuestions.".concat(o,".recordedBlob")))};return s.a.createElement("ul",{className:$e.a.TestFormList},a.map((function(e,n){var o,r,i=(l.speakingQuestions||[])[n]||{},c=i.recordingTimeout,m=i.questionRecordingTimeout,f=i.recorder,g=i.questionRecorder,b=i.questionRecordedBlob,E=i.recordedBlob,k=i.isRecordingQuestion,F=i.isRecording,x=["question","answer"].map((function(e,t){return s.a.createElement(v.a,{component:Ge.a,name:"speakingQuestions.".concat(n,".").concat(0===t?"questionRecordedBlob":"recordedBlob"),onStart:function(){var t=Object(Me.a)(Le.a.mark((function t(a){var o;return Le.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(He.c)(a,e,n,null,function(){var t=Object(Me.a)(Le.a.mark((function t(a){var o;return Le.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a;case 2:o=t.sent,T(o.blob,o.file,n,e);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0={};case 5:o=t.t0,O(o.recorder,o.recordingTimeout,n,e,o.isRecording);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),onStop:function(){var a=Object(Me.a)(Le.a.mark((function a(o){var r;return Le.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(He.d)(o,null,n,0===t?m:c,0===t?g:f);case 2:if(a.t0=a.sent,a.t0){a.next=5;break}a.t0={};case 5:r=a.t0,T(r.blob,r.file,n,e);case 7:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),onPreview:function(){Object(He.b)(0===t?"audioQuestion[".concat(n,"]"):"audioAnswer[".concat(n,"]"))},onClear:function(){return T(null,null,n,e)},id:0===t?"audioQuestion[".concat(n,"]"):"audioAnswer[".concat(n,"]"),recordDisabled:0===t?k:F,audioSource:0===t?b:E,isMicAlert:p})})),j=["question","answer"].map((function(e){return s.a.createElement(v.a,{name:"speakingQuestions.".concat(n,".").concat("question"===e?"audioQuestion":"audioAnswer"),options:"question"===e?y:w,component:Fe.a,type:"checkbox"})}));return s.a.createElement("li",{key:n,className:$e.a.QuestionCustomizationContainer},s.a.createElement(_.a,{variant:"h6",gutterBottom:!0},"".concat(d("testForm.question")," ").concat(n+1)),j[0],i.audioQuestion?s.a.createElement(h.a,null,s.a.createElement("div",{style:{textAlign:"center"}},s.a.createElement(v.a,(o={name:"speakingQuestions.".concat(n,".audioFileQuestion"),index:"q".concat(n),onChangeFile:function(e){t("speakingQuestions.".concat(n,".questionRecordedBlob"),e)},uploadButtonText:d("testForm.buttons.selectAudioFile"),component:ae.a},Object(Ve.a)(o,"uploadButtonText",d("testForm.buttons.selectAudioFile")),Object(Ve.a)(o,"mimeTypesAllowed","audio/*"),Object(Ve.a)(o,"extensionsAllowed",["mp3","wav","wma"]),Object(Ve.a)(o,"loadedFile",i.questionRecordedBlob),o))),x[0]):s.a.createElement("div",{className:$e.a.TextEditor},s.a.createElement(v.a,{name:"".concat(e,".question"),field:"".concat(e,".question"),reduxForm:"testForm",component:Pe.a,path:u})),s.a.createElement("div",null,j[1],!0===i.audioAnswer&&s.a.createElement(h.a,null,s.a.createElement("div",{style:{textAlign:"center"}},s.a.createElement(v.a,(r={name:"speakingQuestions.".concat(n,".audioFile"),uploadButtonText:d("testForm.buttons.selectAudioFile"),index:"a".concat(n),onChangeFile:function(e){t("speakingQuestions.".concat(n,".recordedBlob"),e)}},Object(Ve.a)(r,"uploadButtonText",d("testForm.buttons.selectAudioFile")),Object(Ve.a)(r,"component",ae.a),Object(Ve.a)(r,"mimeTypesAllowed","audio/*"),Object(Ve.a)(r,"extensionsAllowed",["mp3","wav","wma"]),Object(Ve.a)(r,"loadedFile",i.recordedBlob),r))),x[1])),s.a.createElement("div",{style:{marginTop:15}},s.a.createElement(v.a,{name:"".concat(e,".marks"),component:ve.a,options:{label:d("testForm.fields.marks"),size:"small"}})),s.a.createElement(Ke.a,{onClick:function(){return a.remove(n)},fullWidth:!0,disabled:1===(l.speakingQuestions||[]).length},d("testForm.buttons.removeQuestion")))})),s.a.createElement("li",null,s.a.createElement(Ke.a,{onClick:function(){return a.push({marks:1})},fullWidth:!0},d("testForm.buttons.addQuestion")),i.submitFailed&&i.error&&s.a.createElement("span",null,i.error)))},ut=Object(f.a)({form:"testForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0,validate:Ee.a})((function(e){var t=e.formValues,n=void 0===t?{}:t,a=Object(Je.a)(e,["formValues"]),o=Object(E.a)().t,r=(n.speakingQuestions||[]).length;return s.a.createElement(h.a,null,s.a.createElement(_.a,{variant:"h4",gutterBottom:!0,paragraph:!0},o("testForm.speakingSection")),s.a.createElement(d.a,{name:"speakingQuestions",formValues:n,component:lt,props:a,t:o}),s.a.createElement(ee.a,{index:0,summary:o("testForm.selectQuestion")},s.a.createElement(te.a,{questionType:"Speaking questions",selecting:!0,indexToAdd:r})))})),dt=Object(c.b)((function(e){return{formValues:Object(m.a)("testForm")(e),initialValues:e.instructorTest.loadedTestFormData}}),(function(e){return{changeField:function(t,n){e(Object(se.a)("testForm",t,n))},makeAudioFieldTouched:function(t){return e(Object(se.d)("testForm",t))}}}))(ut),mt=n(249),ft=n.n(mt),pt=n(248),gt=n.n(pt),bt=n(153),ht=n(747),Et=function(e){Object(fe.a)(n,e);var t=Object(pe.a)(n);function n(e){var a;return Object(de.a)(this,n),(a=t.call(this,e)).handleWindowClose=function(e){e.preventDefault(),a.state.isUpdating||a.handleDeleteUnsavedImages()},a.handleDeleteUnsavedImages=function(){var e=Object(be.a)(a.props.questions,"courseQuestions")||[],t=Object(be.a)(a.props.formValues,"testForm")||[],n=[];t.forEach((function(e){-1===a.state.initialUrls.findIndex((function(t){return t===e}))&&n.push(e)})),n.filter((function(t){return e.includes(t)?null:t})).filter((function(e){return e})).length>0&&a.props.deleteImg(n,a.props.token)},a.closeModalHandler=function(){a.setState({modalOpen:!1})},a.openModalHandler=function(){a.setState({modalOpen:!0})},a.onSubmit=function(){var e=a.props,t=e.addNewTest,n=e.formValues,o=e.token,r=e.editing,s=e.course,i=e.userId,c=e.initialValues,l=e.coursePanel,u=e.questions,d=e.students;e.t;if(a.checkPageValidity()){var m=[];d.forEach((function(e){e.testResults.forEach((function(e){m.push(e.test)}))})),r&&m.includes(c._id)?a.setState({isBlockedByStudent:!0}):a.setState({isUpdating:!0},(function(){var e=Object(be.a)(u,"courseQuestions")||[],d=Object(be.a)(n,"testForm")||[],m=(a.state.initialUrls||[]).filter((function(e){return d.includes(e)?null:e})).filter((function(t){return e.includes(t)?null:t}));t(n,o,r,s._id,i,r?c._id:a.state.newTestId,"test"===l?"test":"assignment",m)}))}},a.nextPage=function(){a.setState((function(e){return{page:e.page+1}}))},a.previousPage=function(){a.setState((function(e){return{page:e.page-1}}))},a.checkPageValidity=function(e){var t=a.props,n=t.touchField,o=(t.testForm,t.formValues),r=t.coursePanel,s=t.testFormSection,i=Object(Ee.a)(o),c="test"===r?"test":"assignment";if(1===e&&["".concat(c,"Name"),"".concat(c,"Weight"),"latePenalty","lateDaysAllowed","testTime","test"===r?"testType":null].forEach((function(e){n(e)})),2===e&&["mcSectionWeight","essaySectionWeight","speakingSectionWeight","fillBlankSectionWeight","testSections"].forEach((function(e){n(e)})),3===e&&(n("dueDate"),n("gradeReleaseDate"),n("availableOnDate")),4===e){["multipleChoice","essay","speaking","fillInTheBlanks","test"].forEach((function(e){n("readingMaterial.".concat(e,".file")),n("audioMaterial.".concat(e,".audioFile"))}))}return"mc"===s&&Array.from(o.mcQuestions||[]).forEach((function(e,t){n("mcQuestions.".concat(t,".question")),n("mcQuestions.".concat(t,".correctAnswers"))})),"essay"===s&&Array.from(o.essayQuestions||[]).forEach((function(e,t){n("essayQuestions.".concat(t,".question"))})),"speaking"===s&&Array.from(o.speakingQuestions||[]).forEach((function(e,t){n("speakingQuestions.".concat(t,".question")),n("speakingQuestions.".concat(t,".questionRecordedBlob")),n("speakingQuestions.".concat(t,".recordedBlob"))})),"fillblanks"===s&&Array.from(a.state.latestFillBlankAnswers).forEach((function(e,t){n("fillBlankQuestions.answers.".concat(t,".browserAudioFile")),n("fillBlankQuestions.answers.".concat(t,".audioFile")),n("fillBlankQuestions.answers.".concat(t,".answerOptions.incorrectAnswerThree"))})),1===e&&i.infoPageOneError||2===e&&i.infoPageTwoError||3===e&&i.infoPageThreeError||4===e&&i.infoPageFourError||"mc"===s&&i.mcSectionPageError||"essay"===s&&i.essayPageError||"speaking"===s&&i.speakingPageError?(a.setState({isValid:!1}),!1):"fillblanks"!==s||!i.fillblankPageError||(a.setState({isValid:!1}),!1)},a.getButtons=function(e,t,n,o,r){var i=a.props.t;return s.a.createElement(h.a,null,s.a.createElement("div",{className:1===e?$e.a.flexPositioningEnd:$e.a.flexPositioningSpaceBetween},1!==e&&s.a.createElement(Ke.a,{color:"primary",onClick:function(){a.previousPage(),a.resetFormValidity()},startIcon:s.a.createElement(gt.a,null)},""),!(t===e)&&s.a.createElement(Ke.a,{color:r?"secondary":"primary",onClick:function(){a.checkPageValidity(e)&&(a.nextPage(),a.resetFormValidity())},startIcon:s.a.createElement(ft.a,null)},"")),s.a.createElement("div",{className:$e.a.flexPositioningEven},t===e&&!n&&s.a.createElement(ne.a,{fullWidth:!0,isError:!(!r&&!a.state.isBlockedByStudent),clicked:a.onSubmit},i(o?"testForm.buttons.update":"testForm.buttons.publish"))))},a.resetFormValidity=function(){a.setState((function(e){if(e.page!==a.state.page)return{isValid:!0}}))},a.state={page:1,modalOpen:!1,initialUrls:[],latestFillBlankAnswers:[],newTestId:null,isValid:!0,isUpdating:!1,isBlockedByStudent:!1},a}return Object(me.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("beforeunload",this.handleWindowClose);var e=Object(be.a)(this.props.initialValues,"testForm");this.setState({initialUrls:e,newTestId:this.props.editing?null:(new bt.a.ObjectId).toHexString()})}},{key:"componentWillReceiveProps",value:function(e){var t=((e.formValues||{}).fillBlankQuestions||{}).answers;this.setState({latestFillBlankAnswers:t})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("beforeunload",this.handleWindowClose),this.state.isUpdating||this.handleDeleteUnsavedImages(),this.props.clearTestForm()}},{key:"render",value:function(){var e,t=this.props,n=(t.testForm,t.setTestSection),a=t.questions,o=t.setQuestionEditing,r=t.addQuestionToTest,i=t.editing,c=t.loading,l=t.coursePanel,u=t.course,d=t.formValues,m=void 0===d?{}:d,f=t.formErrors,g=t.testFormSection,b=t.initialValues,h=t.t,E=this.state.isValid||!f.infoPageOneError&&"info1"===g||!f.infoPageTwoError&&"info2"===g||!f.infoPageThreeError&&"info3"===g||!f.infoPageFourError&&"info4"===g||!f.mcSectionPageError&&"mc"===g||!f.essayPageError&&"essay"===g||!f.speakingPageError&&"speaking"===g||!f.fillblankPageError&&"fillblanks"===g||!1!==f.fillblankPageError&&!0!==f.fillblankPageError&&"fillblanks"===g,v="test"===l,k=m.testSections||[],F=k.find((function(e){return"mc"===e})),y=k.find((function(e){return"essay"===e})),w=k.find((function(e){return"fillblanks"===e})),O=k.find((function(e){return"speaking"===e})),T=k.length+4,x="mc"===F?6:5;"mc"===F&&"essay"===y&&(e=7),"mc"!==F&&"essay"===y&&(e=6),"mc"===F&&"essay"!==y&&(e=6),"mc"!==F&&"essay"!==y&&(e=5);var j=T,S=this.state,A=S.page,C=S.newTestId;A>=1&&A<5&&n("info".concat(A)),F&&5===A&&n("mc"),A===x&&y&&n("essay"),A===e&&O&&n("speaking"),A===j&&w&&n("fillblanks");var D="courses/".concat(u._id,"/tests/").concat(i?m._id:C);return s.a.createElement("div",{className:$e.a.Background},s.a.createElement(p.a,{active:c,transparent:!0}),s.a.createElement(he.a,{activeStep:this.state.page-1,steps:T+1,progress:!0}),s.a.createElement("div",{style:{paddingTop:"20px"}},1===A&&s.a.createElement(_e,{isTest:v}),2===A&&s.a.createElement(Ne,{isTest:v}),3===A&&s.a.createElement(Ie,{isTest:v}),4===A&&s.a.createElement(Xe,{path:D,isTest:v}),5===A&&F&&s.a.createElement(ot,{path:D,questions:a,setQuestionEditing:function(e){return o(e)},addQuestionToTest:function(e,t){return r(e,t)}}),A===x&&y&&s.a.createElement(it,{path:D,questions:a,setQuestionEditing:function(e){return o(e)},addQuestionToTest:function(e,t){return r(e,t)}}),A===e&&O&&s.a.createElement(dt,{path:D,questions:a,setQuestionEditing:function(e){return o(e)},addQuestionToTest:function(e,t){return r(e,t)}}),A===j&&w&&s.a.createElement(ct.a,{path:D,form:"testForm",questions:a,setQuestionEditing:function(e){return o(e)},addQuestionToTest:function(e,t){return r(e,t)}})),!E&&s.a.createElement("div",{style:{margin:"auto",textAlign:"center"}},s.a.createElement(_.a,{color:"error"},h("testForm.errors.correctForm"))),this.state.isBlockedByStudent&&i&&s.a.createElement("div",{style:{margin:"auto",textAlign:"center"}},s.a.createElement(_.a,{variant:"caption",color:"error"},b.assignment?h("testForm.errors.studentTakingAssignment"):h("testForm.errors.studentTakingTest"))),this.getButtons(A,T,null,i,!E))}}]),n}(r.Component),vt=Object(f.a)({form:"testForm",enableReinitialize:!1,validate:Ee.a,destroyOnUnmount:!0,forceUnregisterOnUnmount:!0})(Et),kt=Object(c.b)((function(e){var t=oe.a.t("testForm.fillblanksSectionDefaultText"),n=e.common.selectedCourse,a=e.instructorTest.loadedTestFormData,o=(n.tests||[]).filter((function(e){return!e.assignment})),r=(n.tests||[]).filter((function(e){return e.assignment})),s=e.common.configuration.instructorFileSizeLimit,i={instructorFileSizeLimit:s,tests:o,assignments:r,course:n,published:!0,isGradeIncluded:!0,passingRequired:!1,assignment:"assignment"===e.common.coursePanel||null,materialsDisplay:"test",equalSectionWeight:!0,mcQuestions:((a||{}).mcQuestions||[]).length>0?(a||{}).mcQuestions:[{marks:1,answers:["".concat(oe.a.t("testForm.fields.option")," 1"),"".concat(oe.a.t("testForm.fields.option")," 2")],correctAnswers:["1"]}],essayQuestions:((a||{}).essayQuestions||[]).length>0?(a||{}).essayQuestions:[{marks:1}],speakingQuestions:((a||{}).speakingQuestions||[]).length>0?(a||{}).speakingQuestions:[{marks:1}],fillBlankQuestions:((a||{}).fillBlankQuestions||{}).question?(a||{}).fillBlankQuestions:{question:t,answers:[{marks:1,selectableAnswer:!1,answer:"piece of text"}],correctAnswers:["piece of text"]}},c=(a||{}).testSections||[],l=[];c.forEach((function(e){"mc"===e&&l.push("multipleChoice"),"essay"===e&&l.push("essay"),"speaking"===e&&l.push("speaking"),"fillblanks"===e&&l.push("fillInTheBlanks")}));var u=l.includes("fillInTheBlanks"),d=e.common.editing;return{formValues:Object(m.a)("testForm")(e),formErrors:Object(ge.a)("testForm")(e),token:e.authentication.token,userId:e.authentication.userId,initialValues:d?Object(ue.a)(Object(ue.a)({},a),{},{instructorFileSizeLimit:s,tests:o,fillBlankQuestions:u?a.fillBlankQuestions:{question:t,answers:[{marks:1,selectableAnswer:!1,answer:"piece of text"}],correctAnswers:["piece of text"]},assignments:r,course:n,materialsDisplay:l[0]||"test"}):i,editing:e.common.editing,course:e.common.selectedCourse,testForm:e.form.testForm,testFormSection:e.instructorTest.testFormSection,section:e.instructorTest.testSection,coursePanel:e.common.coursePanel,questions:e.instructorQuestion.questionBank,loading:e.instructorTest.loading,students:e.common.students}}),(function(e){return{addNewTest:function(t,n,a,o,r,s,c,l){e(i.M(t,n,a,o,r,s,c,l))},clearTestForm:function(){return e(i.r())},setTestSection:function(t){return e(i.ad(t))},touchField:function(t){e(Object(se.d)("testForm",t))},deleteImg:function(t,n){e(i.S(t),n)}}}))(Object(ht.a)("common")(vt)),Ft=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={slides:[],isValid:!0};e.lessonName&&(e.lessonName||"").trim()||(t.isValid=!1,t.lessonName=oe.a.t("lessonForm.errors.required")),Array.from(e.lessons||[]).forEach((function(n){e._id!==n._id&&(n.lessonName||"").toLowerCase().trim()===(e.lessonName||"").toLowerCase().trim()&&(t.isValid=!1,t.lessonName=oe.a.t("lessonForm.errors.noDuplicateLessonNames"))}));var n=parseInt((e.course||{}).courseStartDate),a=parseInt((e.course||{}).courseEndDate),o=new Date(e.availableOnDate).getTime();return!(n&&a&&o)||o>n&&o<a||(t.availableOnDate=oe.a.t("lessonForm.errors.availableOnDateInCourseDuration"),t.isValid=!1),t.slides=Array.from(e.slides||{}).map((function(n){var a={};return n.slideContent||n.videoContent||(t.isValid=!1,a.slideContent=oe.a.t("lessonForm.errors.required")),!n.loadedVideo&&n.videoContent&&(t.isValid=!1,a.videoFile=oe.a.t("lessonForm.errors.uploadOrDisable")),n.audioFile instanceof File&&n.audioUpload&&(n.audioFile||{}).size>1e3*e.instructorFileSizeLimit*1e3&&(t.isValid=!1,a.audioFile="".concat(oe.a.t("lessonForm.errors.audioCannotExceed")," ").concat(e.instructorFileSizeLimit,"MB")),n.videoFile instanceof File&&n.videoContent&&(n.videoFile||{}).size>1e3*e.instructorFileSizeLimit*1e3&&(t.isValid=!1,a.videoFile="".concat(oe.a.t("lessonForm.errors.videoCannotExceed")," ").concat(e.instructorFileSizeLimit,"MB")),a.videoFile||a.audioFile||a.slideContent?a:null})),t},yt=n(1231),wt=n.n(yt),Ot=n(865),Tt=function(e){Object(fe.a)(n,e);var t=Object(pe.a)(n);function n(e){var a;return Object(de.a)(this,n),(a=t.call(this,e)).handleWindowClose=function(e){e.preventDefault(),a.state.isUpdating||a.handleDeleteUnsavedImages()},a.handleDeleteUnsavedImages=function(){var e=Object(be.a)(a.props.formValues.values,"lessonForm"),t=[];(e||[]).forEach((function(e){-1===a.state.initialUrls.findIndex((function(t){return t===e}))&&t.push(e)})),t.length>0&&a.props.deleteImg(t,a.props.token)},a.checkPageValidity=function(){var e=a.props,t=e.formErrors,n=e.touchField;if(((e.formValues.values||{}).slides||[]).forEach((function(e,t){n("slides.".concat(t,".slideContent")),n("slides.".concat(t,".videoFile")),n("slides.".concat(t,".audioFile"))})),n("availableOnDate"),n("lessonName"),t.isValid)return!0},a.onSubmit=function(){var e=a.props,t=e.addNewLesson,n=e.editing,o=e.token,r=e.course,s=(e.changeTab,e.formValues);if(a.checkPageValidity()){var i=Object(be.a)(s.values,"lessonForm"),c=(a.state.initialUrls||[]).filter((function(e){return i.includes(e)?null:e}));a.setState({isUpdating:!0},(function(){t(n?s.values:Object(ue.a)(Object(ue.a)({},s.values),{},{_id:a.state.newLessonId}),o,n,r._id,c)}))}else a.setState({isValid:!1})},a.initiateRecording=function(e,t,n){var o=a.props.changeField;o("slides.".concat(n,".recording"),!0),o("slides.".concat(n,".recorder"),e),o("slides.".concat(n,".recordingTimeout"),t)},a.setAudioData=function(e,t,n){var o=a.props.changeField;o("slides.".concat(n,".recording"),!1),o("slides.".concat(n,".recordedBlob"),e),o("slides.".concat(n,".audioFile"),t)},a.getAudioSource=function(e,t){return((e.slides||[])[t]||{}).recordedBlob},a.getAudioRecording=function(e,t){return((e.slides||[])[t]||{}).recording},a.getRecorderFromClick=function(e,t){return((e.slides||[])[t]||{}).recorder||{}},a.getRecordingTimeout=function(e,t){return((e.slides||[])[t]||{}).recordingTimeout},a.renderSlides=function(e){var t=e.fields,n=e.meta,o=n.error,r=n.submitFailed,i=e.formValues,c=void 0===i?{}:i,l=e.course,u=e.formErrors,d=e.touchField,m=e.t;return s.a.createElement("ul",{className:wt.a.FormList},t.map((function(e,n){var o={label:m("lessonForm.fields.videoContent"),checked:!1},r={label:m("lessonForm.fields.audioFromFile"),checked:!1,disabled:!!((u.slides||[])[n]||{}).audioFile},i=a.props.changeField;return s.a.createElement("li",{className:wt.a.SlideCustomizationContainer,key:n},s.a.createElement(_.a,{variant:"h6",gutterBottom:!0},"".concat(m("lessonForm.slide")," ").concat(n+1)),s.a.createElement(v.a,{name:"slides.".concat(n,".videoContent"),options:o,component:Fe.a}),((c.slides||[])[n]||{}).videoContent?s.a.createElement("div",{style:{textAlign:"center"}},s.a.createElement(v.a,{name:"slides.".concat(n,".videoFile"),onChangeFile:function(e){i("slides.".concat(n,".loadedVideo"),e)},uploadButtonText:m("lessonForm.buttons.selectVideoFile"),index:n,component:ae.a,loadedFile:((c.slides||[])[n]||{}).loadedVideo,onClear:function(){i("slides.".concat(n,".loadedVideo"),null),i("slides.".concat(n,".videoFile"),null)},videoFile:!0,mimeTypesAllowed:"video/*,video/x-matroska",extensionsAllowed:["mp4","avi","mov","mkv","webm"]},((c.slides||[])[n]||{}).loadedVideo&&s.a.createElement(Ot.a,{url:((c.slides||[])[n]||{}).loadedVideo}))):s.a.createElement(h.a,null,s.a.createElement("div",{className:wt.a.TextEditor},s.a.createElement(v.a,{name:"slides.".concat(n,".slideContent"),component:Pe.a,path:"courses/".concat(l._id,"/lessons/").concat(a.props.editing?c._id:a.state.newLessonId),reduxForm:"lessonForm",field:"slides.".concat(n,".slideContent")})),s.a.createElement(v.a,{name:"slides.".concat(n,".audioUpload"),options:r,component:Fe.a}),s.a.createElement(h.a,null,((c.slides||[])[n]||{}).audioUpload?s.a.createElement(h.a,null,s.a.createElement("div",{style:{textAlign:"center"},className:wt.a.flexPositioningEven},s.a.createElement(v.a,{name:"slides.".concat(n,".audioFile"),index:n,uploadButtonText:m("lessonForm.buttons.selectAudioFile"),onChangeFile:function(e){i("slides.".concat(n,".recordedBlob"),e),d("slides.".concat(n,".audioFile"))},component:ae.a,loadedFile:a.getAudioRecording(c,n),mimeTypesAllowed:"audio/*",extensionsAllowed:["mp3","wav","wma"]}),s.a.createElement(Ge.b,{onPreview:function(){a.getAudioSource(c,n)&&Object(He.b)("slideAudio[".concat(n,"]"))},id:"slideAudio[".concat(n,"]"),audioSource:a.getAudioSource(c,n)})),s.a.createElement(Ge.c,{onClear:function(){return a.setAudioData(null,null,n)}})):s.a.createElement(Ge.a,{onStart:function(){var e=Object(Me.a)(Le.a.mark((function e(t){var o;return Le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(He.c)(t,null,n,null,function(){var e=Object(Me.a)(Le.a.mark((function e(t){var o;return Le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:o=e.sent,a.setAudioData(o.blob,o.file,n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:o=e.t0,a.initiateRecording(o.recorder,o.recordingTimeout,n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onStop:function(){var e=Object(Me.a)(Le.a.mark((function e(t){var o;return Le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(He.d)(t,null,n,a.getRecordingTimeout(c,n),a.getRecorderFromClick(c,n));case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:o=e.t0,a.setAudioData(o.blob,o.file,n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onPreview:function(){Object(He.b)("slideAudio[".concat(n,"]"))},onClear:function(){return a.setAudioData(null,null,n)},id:"slideAudio[".concat(n,"]"),recordDisabled:a.getAudioRecording(c,n),audioSource:a.getAudioSource(c,n)}))),s.a.createElement(Ke.a,{fullWidth:!0,type:"button",title:"Remove Slide",onClick:function(){t.remove(n)},disabled:1===(c.slides||[]).length},m("lessonForm.buttons.removeSlide")))})),s.a.createElement("li",null,s.a.createElement(Ke.a,{title:"Add Slide",type:"button",onClick:function(){return t.push({})},fullWidth:!0},m("lessonForm.buttons.addSlide")),r&&o&&s.a.createElement("span",null,o)))},a.state={initialUrls:[],newLessonId:null,isValid:!0,isUpdating:!1},a}return Object(me.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("beforeunload",this.handleWindowClose);var e=Object(be.a)(this.props.initialValues,"lessonForm");this.setState({initialUrls:e,newLessonId:this.props.editing?null:(new bt.a.ObjectId).toHexString()})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("beforeunload",this.handleWindowClose),this.state.isUpdating||this.handleDeleteUnsavedImages(),this.props.clearLessonForm()}},{key:"render",value:function(){var e=this.props,t=e.submitting,n=e.formValues,a=void 0===n?{}:n,o=e.editing,r=(e.handleSubmit,e.loading,e.course),i=e.changeField,c=e.formErrors,l=e.touchField,u=e.t,m={label:u("lessonForm.fields.publish"),checked:!1},f=(a.values||{}).createdAt;return s.a.createElement(h.a,null,s.a.createElement("div",{style:{paddingTop:"20px"}},s.a.createElement(v.a,{className:wt.a.center,name:"lessonName",type:"text",component:k.a,label:u("lessonForm.fields.lessonName")}),s.a.createElement(v.a,{name:"published",options:m,component:Fe.a}),s.a.createElement(v.a,{name:"availableOnDate",type:"dateTime",handleChange:function(e){return i("availableOnDate",e)},component:Re.a,fullWidth:!0,options:{disablePast:!0,label:u("lessonForm.fields.availableOnDate"),minDate:f}})),s.a.createElement(d.a,{formValues:a.values,t:u,name:"slides",component:this.renderSlides,course:r,formErrors:c,touchField:l}),!this.state.isValid&&!c.isValid&&s.a.createElement(_.a,{style:{textAlign:"center",marginBottom:"20px"},gutterBottom:!0,color:"error"},u("lessonForm.errors.correctForm")),s.a.createElement(ne.a,{isError:!(this.state.isValid||c.isValid),disabled:t,clicked:this.onSubmit},u(o?"lessonForm.buttons.update":"lessonForm.buttons.publish")))}}]),n}(r.Component),xt=Object(f.a)({form:"lessonForm",enableReinitialize:!0,validate:Ft})(Tt),jt=Object(c.b)((function(e,t){var n=e.common.selectedCourse,a=n.lessons||[],o=e.common.editing,r=e.common.configuration.instructorFileSizeLimit;return{formErrors:Object(ge.a)("lessonForm")(e),loading:e.instructorLesson.loading,token:e.authentication.token,formValues:e.form.lessonForm,initialValues:Object(ue.a)(Object(ue.a)({},e.instructorLesson.loadedLessonFormData),{},{instructorFileSizeLimit:r,lessons:a,course:n,published:!o||e.instructorLesson.loadedLessonFormData.published}),editing:o,course:n}}),(function(e){return{addNewLesson:function(t,n,a,o,r){e(i.D(t,n,a,o,r))},changeField:function(t,n){return e(Object(se.a)("lessonForm",t,n))},touchField:function(t){e(Object(se.d)("lessonForm",t))},clearLessonForm:function(){return e(i.r())},deleteImg:function(t,n){e(i.S(t),n)}}}))(Object(ht.a)("common")(xt)),St=n(867),At=n(5),Ct=n(11),_t=(n(2),n(10)),Dt=n(13),Qt=r.forwardRef((function(e,t){var n=e.classes,a=e.className,o=e.component,s=void 0===o?"div":o,i=Object(Ct.a)(e,["classes","className","component"]);return r.createElement(s,Object(At.a)({ref:t,className:Object(_t.a)(n.root,a)},i))})),Bt=Object(Dt.a)({root:{width:"100%",overflowX:"auto"}},{name:"MuiTableContainer"})(Qt),Nt=n(269),Rt=n(61),qt=n.n(Rt),It=n(178),Wt=Object(g.a)({table:{minWidth:200},MuiTableRowBlue:{background:"#2196f3"},MuiTableRowDanger:{background:"#f44336"},WhiteText:{color:"white"},DangerText:{color:"#f44336"},SuccessText:{color:"#4caf50"},MuiButton:{marginLeft:"20px","&:hover":{border:"1px solid #1976d2",backgroundColor:"#e3f2fd",color:"#1976d2"}},MuiButtonDark:{backgroundColor:"#595959",marginLeft:"20px","&:hover":{border:"1px solid #1976d2",backgroundColor:"#424242",color:"#1976d2"}},studentFilterContainer:{width:"100%",display:"flex",justifyContent:"space-around",marginBottom:10,marginTop:30}});var Lt=Object(c.b)((function(e){var t=e.common.selectedCourse,n=[];return t.studentsEnrollRequests.forEach((function(e){return n.push(e.student)})),{token:e.authentication.token,selectedTest:e.instructorTest.selectedTest,testGrading:e.instructorTest.testGrading,course:t,students:n,initialGradeValues:e.instructorTest.initialGradeValues,isDarkTheme:e.common.isDarkTheme}}),(function(e){return{setTestToGrade:function(t,n){return e(i.bd(t,n))},setInitialGradeValues:function(t){return e(i.Pc(t))},closeTest:function(t,n,a,o,r){e(i.x(t,n,a,o,r))},openModal:function(t,n){return e(i.tc(t,n))}}}))((function(e){var t=e.isTest,n=e.isAssignment,a=e.course,i=(e.testGrading,e.students),c=void 0===i?[]:i,l=e.setInitialGradeValues,u=e.token,d=e.closeTest,m=e.openModal,f=e.isDarkTheme,p=Object(E.a)().t,g=Object(r.useState)(""),b=Object(o.a)(g,2),v=b[0],F=b[1],y=Object(r.useState)(""),w=Object(o.a)(y,2),O=w[0],T=w[1],x=Object(r.useState)(""),j=Object(o.a)(x,2),S=j[0],A=j[1],C=Object(r.useState)("studentName"),_=Object(o.a)(C,2),D=_[0],Q=_[1],B=Object(r.useState)("all"),N=Object(o.a)(B,2),R=N[0],q=N[1];Object(r.useEffect)((function(){var e=(c||[])[0];if(e){F("".concat(e.firstName," ").concat(e.lastName)),A(e._id.replace(/\D/g,""));var n=t?(a.tests||[]).filter((function(e){return!e.assignment}))[0]:(a.tests||[]).filter((function(e){return e.assignment}))[0];T((n||{}).testName)}}),[JSON.stringify(c)]);var I=Wt();function W(e,t){return{info:e,value:t}}var L=a.tests.filter((function(e){return!e.assignment&&e.published}))||[],M=function(e){return a.tests.find((function(t){return t._id===e}))},V=a.tests.filter((function(e){return e.assignment&&e.published}))||[],P=L.map((function(e){return e._id})),z=V.map((function(e){return e._id})),U=[],H=L.filter((function(e){var t=parseInt(e.dueDate);return Date.now()>t?e:null})).map((function(e){return e._id})),G=V.filter((function(e){var t=parseInt(e.dueDate);return Math.ceil((Date.now()-t)/864e5)>(e.lateDaysAllowed||0)?e:null})).map((function(e){return e._id})),Y=[],X=[];t&&((c||[]).forEach((function(e){e.testResults.forEach((function(t){var n={student:e,testResult:t,test:L.find((function(e){return e._id===t.test}))};P.includes(t.test)&&t.closed&&U.push(n),(P.includes(t.test)&&!t.closed&&H.includes(t.test)||(t||{}).test===(e.testInSession||{}).test)&&X.push(n)}))})),H.forEach((function(e){(c||[]).forEach((function(t){var n={student:t,test:L.find((function(t){return t._id===e}))};t.testResults.map((function(e){return e.test})).includes(e)||Y.push(n)}))})));var J=[],K=[];n&&((c||[]).forEach((function(e){return e.testResults.forEach((function(t){var n={student:e,testResult:t,test:V.find((function(e){return e._id===t.test}))};z.includes(t.test)&&t.closed&&U.push(n),z.includes(t.test)&&!t.closed&&K.push(n)}))})),G.forEach((function(e){(c||[]).forEach((function(t){var n={student:t,test:V.find((function(t){return t._id===e}))};t.testResults.map((function(e){return e.test})).includes(e)||J.push(n)}))})));var Z=(c||[]).map((function(e){return"".concat(e.firstName," ").concat(e.lastName)})),$=(L||[]).map((function(e){return e.testName})),ee=(V||[]).map((function(e){return e.testName})),te=[{label:p("gradeWork.all"),value:"all",placement:"end",color:"primary"},{label:p("gradeWork.toReview"),value:"toReview",placement:"end",color:"primary"},{label:p("gradeWork.graded"),value:"graded",placement:"end",color:"primary"}],ne=[{label:p("gradeWork.studentName"),value:"studentName",placement:"end",color:"primary"},{label:p("gradeWork.studentId"),value:"studentId",placement:"end",color:"primary"},{label:"".concat(p(t?"gradeWork.test":"gradeWork.assignment")),value:"testName",placement:"end",color:"primary"}];return s.a.createElement(h.a,null,s.a.createElement("div",{className:I.studentFilterContainer},"studentName"===D&&s.a.createElement(Nt.a,{id:"student-autocomplete",selectedOption:v,onOptionChange:function(e,t){F(t)},options:Z,label:p("gradeWork.student"),width:300,margin:"0 0 22px 0"}),"testName"===D&&s.a.createElement(Nt.a,{id:"test-autocomplete",selectedOption:O,onOptionChange:function(e,t){T(t)},options:t?$:ee,label:"".concat(p(t?"gradeWork.test":"gradeWork.assignment")),width:300,margin:"0 0 22px 0"}),"studentId"===D&&s.a.createElement(k.a,{fullWidth:!0,type:"text",label:p("gradeWork.studentId"),input:{value:S,onChange:function(e,t){A(e.target.value)}}})),s.a.createElement("div",{className:I.studentFilterContainer},s.a.createElement(ke.a,{title:p("gradeWork.searchBy"),options:ne,input:{value:D,onChange:function(e){Q(e.target.value)}}}),s.a.createElement(ke.a,{title:p(t?"gradeWork.filterTests":"gradeWork.filterAssignments"),options:te,input:{value:R,onChange:function(e){q(e.target.value)}}})),s.a.createElement(Bt,null,U.map((function(e,t){var n,o=(a.studentsEnrollRequests||[]).find((function(t){return t.student._id===e.student._id&&t.droppedOut})),r=(a.studentsEnrollRequests||[]).find((function(t){return t.student._id===e.student._id&&t.denied})),i=(a.studentsEnrollRequests||[]).find((function(t){return t.student._id===e.student._id&&t.approved})),c="";if(o&&(c="Dropped out"),r&&(c="Access denied"),i||o||r){if(v!=="".concat(e.student.firstName," ").concat(e.student.lastName)&&"studentName"===D)return null;if(O!==e.test.testName&&"testName"===D)return null;if(S.replace(/\D/g,"")!==e.student._id.replace(/\D/g,"")&&"studentId"===D)return null;if("toReview"===R&&(e.testResult||{}).graded)return null;if("graded"===R&&!(e.testResult||{}).graded)return null;var g=(e.testResult||{}).graded,b=[W("",e.test.testName),W(p("gradeWork.studentName"),"".concat(e.student.firstName," ").concat(e.student.lastName," ").concat(c?"- "+c:"")),e.test.gradeReleaseDate?W(p("gradeWork.gradeExpectedOn"),e.test.gradeReleaseDate?qt()(parseInt(e.test.gradeReleaseDate)).locale(localStorage.getItem("i18nextLng")).format("dddd, MMMM DD YYYY, HH:mm"):""):null,W(p("gradeWork.submittedOn"),(e.testResult||{}).submittedOn?qt()(parseInt((e.testResult||{}).submittedOn)).locale(localStorage.getItem("i18nextLng")).format("dddd, MMMM DD YYYY, HH:mm"):""),W(p("gradeWork.status"),(e.testResult||{}).isExcused?p("gradeWork.buttons.excused"):(e.testResult||{}).graded?"".concat(p("gradeWork.graded")," ").concat((e.testResult||{}).grade,"%"):p("gradeWork.gradePending"))],E=(e.testResult||{}).isExcused;return s.a.createElement(h.a,{key:e.testResult._id},s.a.createElement(ye.a,{className:I.table,"aria-label":"simple table"},s.a.createElement(we.a,null,b.map((function(t,n){var a;if(0===n&&(a="WhiteText"),2===n&&parseInt(e.test.gradeReleaseDate)<Date.now()+864e5&&!g&&(a="DangerText"),4===n&&g&&!e.testResult.isExcused&&(a="SuccessText"),4===n&&g&&e.testResult.isExcused&&(a="DangerText"),4===n&&E&&(a="DangerText"),t)return s.a.createElement(Te.a,{key:t.info+n,className:0===n?I.MuiTableRowBlue:""},s.a.createElement(Oe.a,{className:0===n?I.WhiteText:"",component:"th",scope:"row"},t.info,0===n&&s.a.createElement(Ke.a,{size:"small",className:!i&&f?I.MuiButtonDark:I.MuiButton,variant:"outlined",color:"primary",type:"button",title:"Grade",disabled:r||o,onClick:function(){m({results:U,testId:e.test._id,studentId:e.student._id},"gradeTest"),l(Object(It.a)(e,U))}},(e.testResult||{}).graded||(e.testResult||{}).gradingInProgress?p("gradeWork.buttons.editGrade"):p("gradeWork.buttons.grade"))),s.a.createElement(Oe.a,{className:I[a],align:"right"},t.value))})))),s.a.createElement("div",{style:{display:"flex",justifyContent:"space-around"}},s.a.createElement(Ke.a,{style:{width:"40%"},disabled:r||o,color:"secondary",onClick:function(t){t.stopPropagation(),m(Object(ue.a)(Object(ue.a)({},e.test),{},{student:e.student}),"resetTest")}},p("gradeWork.buttons.reset")),s.a.createElement(Ke.a,(n={disabled:r||o,color:"secondary",style:{width:"40%"}},Object(Ve.a)(n,"disabled",r||o||e.testResult.isExcused),Object(Ve.a)(n,"onClick",(function(){var t=e.student._id,n=e.test._id;d(n,t,u,M(n),!0)})),n),e.testResult.isExcused?p("gradeWork.buttons.excused"):p("gradeWork.buttons.excuse"))))}})),(t?X:K).map((function(e){var t=(a.studentsEnrollRequests||[]).find((function(t){return t.student._id===e.student._id&&t.droppedOut})),n=(a.studentsEnrollRequests||[]).find((function(t){return t.student._id===e.student._id&&t.denied})),o=(a.studentsEnrollRequests||[]).find((function(t){return t.student._id===e.student._id&&t.approved})),r="";if(t&&(r="Dropped out"),n&&(r="Access denied"),o||t||n){var i=e.test||{};if(v!=="".concat(e.student.firstName," ").concat(e.student.lastName)&&"studentName"===D)return null;if(O!==i.testName&&"testName"===D)return null;if(S.replace(/\D/g,"")!==e.student._id.replace(/\D/g,"")&&"studentId"===D)return null;if("graded"===R)return null;var c=[W("",i.testName),W(p("gradeWork.student"),"".concat(e.student.firstName," ").concat(e.student.lastName," ").concat(r?"- "+r:"")),i.gradeReleaseDate?W(p("gradeWork.gradeExpectedOn"),i.gradeReleaseDate?qt()(parseInt(i.gradeReleaseDate)).locale(localStorage.getItem("i18nextLng")).format("dddd, MMMM DD YYYY, HH:mm"):""):null,i.lastSavedOn?W(p("gradeWork.lastSavedOn"),(e.testResult||{}).lastSavedOn?qt()(parseInt((e.testResult||{}).lastSavedOn)).locale(localStorage.getItem("i18nextLng")).format("dddd, MMMM DD YYYY, HH:mm"):""):null,W(p("gradeWork.status"),p("gradeWork.inProgress"))];return s.a.createElement(h.a,{key:e.testResult._id},s.a.createElement(ye.a,{key:e.testResult._id,className:I.table,"aria-label":"simple table"},s.a.createElement(we.a,null,c.map((function(a,r){var c;if(0===r&&(c="WhiteText"),4===r&&(c="DangerText"),a)return s.a.createElement(Te.a,{key:a.info+r,className:0===r?I.MuiTableRowBlue:""},s.a.createElement(Oe.a,{className:0===r?I.WhiteText:"",component:"th",scope:"row"},a.info,0===r&&s.a.createElement(Ke.a,{disabled:n||t,size:"small",className:!o&&f?I.MuiButtonDark:I.MuiButton,variant:"outlined",color:"primary",type:"button",title:"Grade",onClick:function(){var t=e.student._id,n=i._id;d(n,t,u,M(n),!1)}},p("gradeWork.buttons.closeAndGrade"))),s.a.createElement(Oe.a,{className:I[c],align:"right"},a.value))})))),s.a.createElement("div",{style:{display:"flex",justifyContent:"space-around"}},s.a.createElement(Ke.a,{disabled:n||t,color:"secondary",style:{width:"40%"},onClick:function(t){t.stopPropagation(),m(Object(ue.a)(Object(ue.a)({},e.test),{},{student:e.student}),"resetTest")}},p("gradeWork.buttons.reset")),s.a.createElement(Ke.a,{color:"secondary",style:{width:"40%"},disabled:e.testResult.isExcused||n||t,onClick:function(){var t=e.student._id,n=e.test._id;d(n,t,u,M(n),!0)}},e.testResult.isExcused?p("gradeWork.buttons.excused"):p("gradeWork.buttons.excuse"))))}})),(t?Y:J).map((function(e){var t=(a.studentsEnrollRequests||[]).find((function(t){return t.student._id===e.student._id&&t.droppedOut})),n=(a.studentsEnrollRequests||[]).find((function(t){return t.student._id===e.student._id&&t.denied})),o=(a.studentsEnrollRequests||[]).find((function(t){return t.student._id===e.student._id&&t.approved})),r="";if(t&&(r="Dropped out"),n&&(r="Access denied"),o||t||n){if(v!=="".concat(e.student.firstName," ").concat(e.student.lastName)&&"studentName"===D)return null;if(O!==e.test.testName&&"testName"===D)return null;if(S.replace(/\D/g,"")!==e.student._id.replace(/\D/g,"")&&"studentId"===D)return null;if("graded"===R)return null;var i=[W("",e.test.testName),W(p("gradeWork.student"),"".concat(e.student.firstName," ").concat(e.student.lastName," ").concat(r?"- "+r:"")),e.test.gradeReleaseDate?W(p("gradeWork.gradeExpectedOn"),e.test.gradeReleaseDate?qt()(parseInt(e.test.gradeReleaseDate)).locale(localStorage.getItem("i18nextLng")).format("dddd, MMMM DD YYYY, HH:mm"):""):null,W(p("gradeWork.status"),p("gradeWork.missed"))];return s.a.createElement(h.a,null,s.a.createElement(ye.a,{key:"".concat(e.student.firstName,"[").concat(e.test._id,"]"),className:I.table,"aria-label":"simple table"},s.a.createElement(we.a,null,i.map((function(a,r){var i,c;if(0===r&&(i="MuiTableRowBlue"),0===r&&(c="WhiteText"),3===r&&(c="DangerText"),a)return s.a.createElement(Te.a,{key:a.info+r,className:I[i]},s.a.createElement(Oe.a,{className:0===r?I.WhiteText:"",component:"th",scope:"row"},a.info,0===r&&s.a.createElement(h.a,null,s.a.createElement(Ke.a,{size:"small",disabled:n||t,className:!o&&f?I.MuiButtonDark:I.MuiButton,variant:"outlined",color:"primary",type:"button",title:"Grade",onClick:function(){var t=e.student._id,n=e.test._id;d(n,t,u,M(n),!1)}},p("gradeWork.buttons.closeAndGrade")))),s.a.createElement(Oe.a,{className:I[c],align:"right"},a.value))})))),s.a.createElement("div",{style:{display:"flex",justifyContent:"space-around"}},s.a.createElement(Ke.a,{disabled:n||t||(e.testResult||{}).isExcused,color:"secondary",style:{width:"40%"},onClick:function(){var t=e.student._id,n=e.test._id;d(n,t,u,M(n),!0)}},p("gradeWork.buttons.excuse"))))}})),(c||[]).map((function(e){var n=(a.studentsEnrollRequests||[]).find((function(t){return t.student._id===e._id&&t.droppedOut})),o=(a.studentsEnrollRequests||[]).find((function(t){return t.student._id===e._id&&t.denied})),r=(a.studentsEnrollRequests||[]).find((function(t){return t.student._id===e._id&&t.approved})),i="";if(n&&(i="Dropped out"),o&&(i="Access denied"),r||n||o){var c=a.tests.filter((function(e){return e.published}));return s.a.createElement(h.a,{key:e._id},c.map((function(a){if(e.testResults.find((function(t){return t.student===e._id&&t.test===a._id})))return null;var r=Y.find((function(e){return e.test._id===a._id})),c=J.find((function(e){return e.test._id===a._id})),l=X.find((function(e){return e.test._id===a._id})),m=K.find((function(e){return e.test._id===a._id}));if((!t||!a.assignment)&&(t||a.assignment)&&!(r||c||l||m)){if(v!=="".concat(e.firstName," ").concat(e.lastName)&&"studentName"===D)return null;if(O!==a.testName&&"testName"===D)return null;if(S.replace(/\D/g,"")!==e._id.replace(/\D/g,"")&&"studentId"===D)return null;if("all"!==R)return null;var f=[W("",a.testName),W(p("gradeWork.student"),"".concat(e.firstName," ").concat(e.lastName," ").concat(i?"- "+i:"")),a.gradeReleaseDate?W(p("gradeWork.gradeExpectedOn"),a.gradeReleaseDate?qt()(parseInt(a.gradeReleaseDate)).locale(localStorage.getItem("i18nextLng")).format("dddd, MMMM DD YYYY, HH:mm"):""):null,W(p("gradeWork.status"),p("gradeWork.notAttempted"))];return s.a.createElement(h.a,null,s.a.createElement(ye.a,{key:"".concat(e.firstName,"[").concat(a._id,"]"),className:I.table,"aria-label":"simple table"},s.a.createElement(we.a,null,f.map((function(e,t){var n,a;if(0===t&&(n="MuiTableRowBlue"),0===t&&(a="WhiteText"),e)return s.a.createElement(Te.a,{key:e.info+t,className:I[n]},s.a.createElement(Oe.a,{className:0===t?I.WhiteText:"",component:"th",scope:"row"},e.info),s.a.createElement(Oe.a,{className:I[a],align:"right"},e.value))})))),s.a.createElement("div",{style:{display:"flex",justifyContent:"space-around"}},s.a.createElement(Ke.a,{disabled:o||n,color:"secondary",style:{width:"40%"},onClick:function(){var t=e._id,n=a._id;d(n,t,u,M(n),!0)}},p("gradeWork.buttons.excuse"))))}})))}}))))})),Mt=n(948),Vt=Object(c.b)((function(e){return{courses:e.common.courses,course:e.common.selectedCourse,students:e.common.students}}),(function(e){return{openModal:function(t,n){return e(i.tc(t,n))}}}))((function(e){var t=e.enrollmentRequests,n=e.course,o=e.openModal,r=n.studentsEnrollRequests.filter((function(e){return!e.approved&&!e.denied&&!e.droppedOut}))||[],i=n.studentsEnrollRequests.filter((function(e){return e.denied}))||[],c=n.studentsEnrollRequests.filter((function(e){return e.approved}))||[],l=n.studentsEnrollRequests.filter((function(e){return e.droppedOut}))||[],u=function(e,t){o(e,t)},d=Object(E.a)().t;return t?s.a.createElement(h.a,null,r.length>0&&s.a.createElement(_.a,{paragraph:!0,variant:"h6",gutterBottom:!0},d("students.pendingRequests")),s.a.createElement(b.a,null,r.map((function(e,t){return s.a.createElement(F.a,{button:!0,key:e.student._id,onClick:function(){return u(e.student,"processEnrollmentRequest")}}," ",s.a.createElement(Mt.a,{src:e.student.profilePicture}),"".concat(e.student.firstName," ").concat(e.student.lastName))}))),i.length>0&&s.a.createElement(_.a,{paragraph:!0,variant:"h6",gutterBottom:!0},d("students.requestsDenied")),s.a.createElement(b.a,null,i.map((function(e){return s.a.createElement(F.a,{button:!0,key:e.student._id,onClick:function(){return u(Object(ue.a)(Object(ue.a)({},e.student),{},{isStudent:!0}),"userSummary")}}," ",s.a.createElement(Mt.a,{src:e.student.profilePicture}),s.a.createElement(w.a,{style:{marginLeft:"5px"},primary:"".concat(e.student.firstName," ").concat(e.student.lastName)}),e.resubmissionAllowed&&s.a.createElement(_.a,{style:{marginLeft:"10px"},variant:"caption",color:"primary"},d("students.resubmissionAllowed")))})))):s.a.createElement(h.a,null,s.a.createElement(b.a,null,[].concat(Object(a.a)(c||[]),Object(a.a)(l||[])).map((function(e,t){var n=(l||[]).findIndex((function(t){return t.student._id===e.student._id}))>-1;return s.a.createElement("div",{key:"".concat(e.student._id,"[").concat(e.droppedOut?"dropped":"enrolled","]"),style:{display:"flex"}},s.a.createElement(F.a,{button:!0,onClick:function(){return u(Object(ue.a)(Object(ue.a)({},e.student),{},{isStudent:!0}),"userSummary")}}," ",s.a.createElement(Mt.a,{src:e.student.profilePicture}),s.a.createElement(w.a,{style:{marginLeft:"5px"},primary:"".concat(e.student.firstName," ").concat(e.student.lastName)}),n&&s.a.createElement(_.a,{style:{marginLeft:10,marginRight:10},variant:"caption",color:"error"},d("students.droppedOut"))),s.a.createElement(Ke.a,{style:{minWidth:90,maxHeight:36},color:"primary",onClick:function(t){return function(e,t){e.stopPropagation(),o(t,"gradebook")}(t,e.student)}},d("students.buttons.gradebook")))}))))})),Pt=n(171),zt=n(143),Ut=n.n(zt),Ht=n(1021),Gt=n(96);t.default=Object(c.b)((function(e){var t=e.common.selectedCourse,n=JSON.stringify((e.common.courses||[]).find((function(e){return e._id===(t||{})._id})));return{coursePanel:e.common.coursePanel,selectedCourse:e.common.selectedCourse,courses:e.common.courses,loadedLessonFormData:e.instructorLesson.loadedLessonFormData,tab:e.common.tab,editing:e.common.editing,loadedTestFormData:e.instructorTest.loadedTestFormData,token:e.authentication.token,userId:e.authentication.userId,studentLoggedIn:e.authentication.studentLoggedIn,modules:e.common.modules,loading:e.instructorTest.loading||e.instructorLesson.loading||e.instructorQuestion.loading||e.instructorModules.loading,stringifiedCourse:n,selectedChatUser:e.common.selectedChatUser}}),(function(e){return{setChatUser:function(t){e(i.Ic(t))},setTab:function(t){e(i.Rc(t)),e(i.q()),e(i.Kc(1))},setCourse:function(t){e(i.Jc(t))},fetchModules:function(t,n){return e(i.Ib(t,n))},fetchStudents:function(t,n,a){return e(i.Rb(t,n,null,a))},fetchNotifications:function(t){return e(i.Lb(t))},fetchUser:function(t){return e(i.ac(t))},fetchInstructors:function(t){return e(i.Cb(t))},fetchQuestionBank:function(t,n){return e(i.Ob(t,n))},fetchConfig:function(t){return e(i.tb(t))}}}))((function(e){var t=e.coursePanel,n=e.tab,i=e.loadedLessonFormData,c=e.loading,d=e.token,m=e.c,f=e.studentLoggedIn,g=(e.modules,e.userId),b=e.fetchStudents,v=e.fetchNotifications,k=e.selectedCourse,F=e.setCourse,y=e.stringifiedCourse,w=e.selectedChatUser,O=e.fetchModules,T=e.fetchUser,x=e.fetchQuestionBank,j=e.fetchConfig,S=e.courses,A=Object(E.a)().t,C=Object(r.useState)(!1),_=Object(o.a)(C,2),D=_[0],Q=_[1],B=Object(Gt.i)().courseId,N=Object(Gt.h)().pathname,R=(S||[]).find((function(e){return e._id===B}));if(Object(r.useEffect)((function(){if(d){O(B,d),b(B,d),T(d),x(B,d),j(d);var e=(S||[]).find((function(e){return e._id===B}))||{};F(e)}var t;t=m||{};var n=Object(Ht.b)(t||{},Date.now()),o=n.isIrregOfficeHour,r=n.isRegOfficeHour;Q(!(!o&&!r));var s,i=Ut()("https://mernstackelearn.herokuapp.com/",{query:{token:d}});i.on("updateStudents",(function(e){"instructor"!==e.userType&&"all"!==e.userType||e.userId!==g&&e.courseId!==B||b(B,d,"noSpinner"),e.fetchNotifications&&v(d)}));!function e(n){s=setTimeout((function(){var a=Object(Ht.b)(t),o=a.isIrregOfficeHour,r=a.isRegOfficeHour;Q(!(!o&&!r)),n?e(Object(Ht.a)(t,Date.now())):clearTimeout(s)}),n-Date.now())}(Object(Ht.a)(t,Date.now()));var c=((t||{}).tests||[]).filter((function(e){return Date.now()<parseInt(e.dueDate)+864e5*e.lateDaysAllowed&&e.allowLateSubmission})).map((function(e){return parseInt(e.dueDate)+864e5*e.lateDaysAllowed})),l=((t||{}).tests||[]).filter((function(e){return e.dueDate&&Date.now()<parseInt(e.dueDate)&&!e.allowLateSubmission})).map((function(e){return parseInt(e.dueDate)})),u=[];return[].concat(Object(a.a)(l),Object(a.a)(c)).forEach((function(e){setTimeout((function(){u.push(s),b((t||{})._id,d)}),e-Date.now())})),function(){u.forEach((function(e){clearTimeout(e)})),clearTimeout(s),i.disconnect(),F(null)}}),[y,B]),!R&&S)return s.a.createElement(Gt.a,{to:"/instructor-panel/courses"});if(N==="/instructor-panel/course/".concat(B)&&f)return s.a.createElement(Gt.a,{to:"/student-panel/course/".concat(B)});var q;return"assignment"===t&&(q=s.a.createElement(h.a,null,s.a.createElement(Pt.a,{value:n,index:0},s.a.createElement($,{isAssignment:!0})),s.a.createElement(Pt.a,{value:n,index:1},!c&&s.a.createElement(kt,null)),s.a.createElement(Pt.a,{value:n,index:2},["Multiple-choice questions","Essay questions","Speaking questions","Fill-in-the-blanks questions"].map((function(e,t){return s.a.createElement(ee.a,{key:e,index:t,summary:A("questions.".concat(e.replace(/ /g,"").replace(/-/g,"").toLowerCase()))},s.a.createElement(te.a,{questionType:e}))}))))),"test"===t&&(q=s.a.createElement(h.a,null,s.a.createElement(Pt.a,{value:n,index:0},s.a.createElement($,{isTest:!0})),s.a.createElement(Pt.a,{value:n,index:1},!c&&s.a.createElement(kt,null)),s.a.createElement(Pt.a,{value:n,index:2},["Multiple-choice questions","Essay questions","Speaking questions","Fill-in-the-blanks questions"].map((function(e,t){return s.a.createElement(ee.a,{key:e,index:t,summary:e},s.a.createElement(te.a,{questionType:e}))}))))),"resources"===t&&(q=s.a.createElement(h.a,null,s.a.createElement(le,null))),"grade"===t&&(q=s.a.createElement(h.a,null,s.a.createElement(Pt.a,{value:n,index:0},s.a.createElement(Lt,{isTest:!0})),s.a.createElement(Pt.a,{value:n,index:1},s.a.createElement(Lt,{isAssignment:!0})))),"lesson"===t&&(q=s.a.createElement(h.a,null,s.a.createElement(Pt.a,{value:n,index:0},s.a.createElement(St.a,null)),s.a.createElement(Pt.a,{value:n,index:1},i&&s.a.createElement(jt,null)))),"chat"===t&&(q=s.a.createElement(h.a,null,s.a.createElement(Pt.a,{value:n,index:0},s.a.createElement(u.a,{isOfficeHour:D,instructorPanel:!0})),s.a.createElement(Pt.a,{value:n,index:1},k&&w&&s.a.createElement(l.a,{key:(w||{})._id,isOfficeHour:D,instructorPanel:!0,userType:"instructor"})))),"student"===t&&(q=s.a.createElement(h.a,null,s.a.createElement(Pt.a,{value:n,index:0},s.a.createElement(Vt,null)),s.a.createElement(Pt.a,{value:n,index:1},s.a.createElement(Vt,{enrollmentRequests:!0})))),"modules"===t&&(q=s.a.createElement(J,null)),s.a.createElement(h.a,null,s.a.createElement(p.a,{active:c,transparent:!0}),s.a.createElement("div",{style:{maxWidth:600,margin:"auto",height:"100%"}}," ",q))}))},818:function(e,t,n){"use strict";var a=n(27),o=n(0),r=n.n(o),s=n(30),i=n(744),c=n(740),l=Object(c.a)((function(e){return{root:{display:"flex",flexWrap:"wrap"},textField:{width:"100%",borderRadius:"1px",margin:"0 auto 5px"},textLabel:{margin:"0 3px 10px 3px"},marginTop:{marginTop:"5px"},darkBackground:{background:"#424242",color:"white"},lightBackground:{background:"white"}}}));t.a=Object(s.b)((function(e){return{isDarkTheme:e.common.isDarkTheme}}))((function(e){var t,n=e.input,s=e.label,c=(e.meta,e.options),u=void 0===c?{}:c,d=e.placeholder,m=e.textLabel,f=e.isDarkTheme,p=l();return r.a.createElement(o.Fragment,null,r.a.createElement("div",{className:[p.root,u.marginTop?p.marginTop:null].join(" ")},m?r.a.createElement("div",{className:p.textLabel},"".concat(s,":")):null,r.a.createElement(i.a,Object.assign({className:[p.textField,f?p.darkBackground:p.lightBackground].join(" "),autoComplete:"off"},n,(t={rows:u.rows,variant:u.variant,multiline:!0},Object(a.a)(t,"variant","outlined"),Object(a.a)(t,"placeholder",d),Object(a.a)(t,"InputProps",{readOnly:u.readOnly}),Object(a.a)(t,"disabled",u.disabled),t)))))}))},841:function(e,t,n){"use strict";var a=n(814),o=n(0),r=n.n(o),s=n(30),i=n(752),c=n(443),l=n(444),u=n(442),d=n(740),m=Object(d.a)((function(e){return{formControl:{minWidth:80,width:"100%",marginBottom:"20px"},textLabel:{margin:"0 3px 10px 3px"},SelectField:{boxSizing:"border-box",border:"1px solid #C2C2C2",borderRadius:"3px",padding:"7px",outline:"none",margin:"0 3px 0 0",cursor:"pointer"},SelectFieldDark:{background:"transparent",color:"white"}}}));t.a=Object(s.b)((function(e){return{isDarkTheme:e.common.isDarkTheme}}))((function(e){var t=e.input,n=e.meta,o=void 0===n?{}:n,s=e.options,d=e.label,f=e.fullWidth,p=e.simple,g=e.textLabel,b=e.error,h=e.disabled,E=e.isDarkTheme,v=m(),k=s.map((function(e){return r.a.createElement("option",{style:E?{background:"#424242",color:"white"}:{},key:e.primaryText,value:e.value},e.primaryText)})),F=r.a.useRef(null),y=r.a.useState(0),w=Object(a.a)(y,2),O=w[0],T=w[1];r.a.useEffect((function(){T((F.current||200).offsetWidth)}),[]);var x=r.a.createElement(u.a,{variant:"outlined",className:v.formControl},r.a.createElement(c.a,{ref:F},d),r.a.createElement(i.a,Object.assign({disabled:h,native:!0,renderValue:function(){return t.value},labelWidth:O,className:v.cssOutlinedInput},t),k),r.a.createElement(l.a,null,(o.error||b)&&o.touched?o.error||b:""));return p&&(x=r.a.createElement("div",null,g&&r.a.createElement("div",{className:v.textLabel},"".concat(g)),r.a.createElement("select",Object.assign({value:g?"":d,className:[v.SelectField,E?v.SelectFieldDark:""].join(" "),style:f?{width:"95%"}:null},t),!g&&r.a.createElement("option",{style:E?{background:"#424242",color:"white"}:{},hidden:!0,key:-1,value:d},d),k),o.error&&o.touched&&r.a.createElement("span",{style:{color:"#E91313",fontSize:"0.7em",display:"block"}},o.error))),x}))},845:function(e,t,n){e.exports={QuestionCustomizationContainer:"TestForm_QuestionCustomizationContainer__1B5i8",flexPositioningSpaceBetween:"TestForm_flexPositioningSpaceBetween__kdtqw",flexPositioningEnd:"TestForm_flexPositioningEnd__39gfc",AudioAlignment:"TestForm_AudioAlignment__2xVul",TextField:"TestForm_TextField__DjIDS",TextEditor:"TestForm_TextEditor__1VHzk",PreviewContainer:"TestForm_PreviewContainer__1YEM_",CorrectAnswer:"TestForm_CorrectAnswer__25di7",button:"TestForm_button__1y61_",FullWidthImg:"TestForm_FullWidthImg__1kaKf",Inline:"TestForm_Inline__MsvQq",center:"TestForm_center__1TCAd",TestTypeRadio:"TestForm_TestTypeRadio__2Hne_",ListHorizontalDisplay:"TestForm_ListHorizontalDisplay__-8t6U",TestFormList:"TestForm_TestFormList__3NFzO",greenIcon:"TestForm_greenIcon__JFFFl",redIcon:"TestForm_redIcon__1BnKX",CorrectAnswerHighlight:"TestForm_CorrectAnswerHighlight__3vZHd",BlankPreview:"TestForm_BlankPreview__3XprO",InputField:"TestForm_InputField__2kwvJ",FullWidth:"TestForm_FullWidth__1FYZJ",InputFieldBottomMargin:"TestForm_InputFieldBottomMargin__1OX1E",SelectField:"TestForm_SelectField__1FMX6",Pointer:"TestForm_Pointer__36bgT",audioPlayerPreview:"TestForm_audioPlayerPreview__2N6du",errorText:"TestForm_errorText__1QR7G",Editor:"TestForm_Editor__3WwHp"}},856:function(e,t,n){"use strict";var a=n(27),o=n(34),r=n(814),s=n(0),i=n.n(s),c=n(30),l=n(31),u=n(35),d=n(841),m=n(239),f=n(800),p=n(748),g=n(1316),b=n(803),h=n(824),E=n.n(h),v=n(78),k=n(441),F=n(250),y=n.n(F),w=n(740),O=n(4),T=n(24),x=n(421),j=Object(w.a)((function(e){return{root:{width:"100%",marginBottom:"20px"},heading:{fontSize:e.typography.pxToRem(15),flexShrink:0},headingModules:{fontSize:e.typography.pxToRem(18),flexShrink:0},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary,marginLeft:"10px"},flex:{display:"flex",marginTop:10,justifyContent:"space-between"},searchItem:{flexGrow:1,width:"98%"},createButton:{margin:"20px 0 20px 0"}}}));t.a=Object(c.b)((function(e){return{questions:e.instructorQuestion.questionBank,questionEditing:e.instructorQuestion.questionEditing,editing:e.common.editing,creatingQuestionType:e.instructorQuestion.creatingQuestionType}}),(function(e){var t;return t={addQToTest:function(t,n){e(Object(l.a)("testForm",t,n))},setQuestionForm:function(t,n,a){e(O.Uc(t,!!n,a)),e(O.tc({qType:t,questionFormData:a},"question"))},setQuestionEditing:function(t,n){return e(O.Tc(t,n))}},Object(a.a)(t,"setQuestionEditing",(function(t,n){return e(O.Tc(t,n))})),Object(a.a)(t,"setEditing",(function(){return e(O.Oc())})),t}))((function(e){var t=e.questions,n=(e.questionEditing,e.setQuestionForm),a=e.setQuestionEditing,s=e.selecting,c=e.questionType,l=e.indexToAdd,h=e.onBlockSync,F=(e.creatingQuestionType,e.addQToTest),w=e.setEditing,O=Object(x.a)().t,S=j(),A=i.a.useState(""),C=Object(r.a)(A,2),_=C[0],D=C[1],Q=i.a.useState(""),B=Object(r.a)(Q,2),N=B[0],R=B[1],q=i.a.useState(""),I=Object(r.a)(q,2),W=I[0],L=I[1],M=[{value:"",primaryText:""},{value:"easy",primaryText:O("questions.easy")},{value:"medium",primaryText:O("questions.medium")},{value:"hard",primaryText:O("questions.hard")}],V=(t||[]).filter((function(e){return""!==e.language||null!==e.language})).reduce((function(e,t){return e.map((function(e){return e.language})).indexOf(t.language)<0&&e.push(t),e}),[]).map((function(e){return{value:e.language,primaryText:e.language}})),P=0,z=0,U=0,H=0;return i.a.createElement(u.a,null,!s&&i.a.createElement("div",{style:{display:"flex",justifyContent:"center"}},i.a.createElement(k.a,{color:"primary",className:S.createButton,onClick:function(e){var t;e.stopPropagation(),"Multiple-choice questions"===c&&(t="mc"),"Essay questions"===c&&(t="essay"),"Speaking questions"===c&&(t="speaking"),"Fill-in-the-blanks questions"===c&&(t="fillInBlank"),n(t,!1,function(e,t){var n=t("questionForm.fillblanksSectionDefaultText"),a={difficulty:"medium",language:t("questionForm.english")};return"mc"===e&&(a=Object(T.a)(Object(T.a)({},a),{},{mcQuestion:{answers:["".concat(t("questionForm.option")," 1"),"".concat(t("questionForm.option")," 2")],correctAnswers:["1"]}})),"essay"===e&&(a=Object(T.a)(Object(T.a)({},a),{},{essayQuestion:{question:""}})),"speaking"===e&&(a=Object(T.a)(Object(T.a)({},a),{},{speakingQuestion:[{audioAnswer:!1,audioQuestion:!1}]})),"fillInBlank"===e&&(a=Object(T.a)(Object(T.a)({},a),{},{fillBlankQuestions:{question:n,answers:[{marks:1,selectableAnswer:!1,answer:t("questionForm.pieceOfText")}],correctAnswers:[t("questionForm.pieceOfText")]}})),a}(t,O))}},O("questions.buttons.createQuestion"))),i.a.createElement(v.a,{variant:"subtitle1"},O("questions.filterQuestions")),i.a.createElement("div",{className:S.flex},i.a.createElement("div",{className:S.searchItem},i.a.createElement(d.a,{fullWidth:!0,simple:!0,textLabel:O("questions.difficulty"),label:"difficulty",options:M,input:{onChange:function(e){D(e.target.value)},value:_}})),i.a.createElement("div",{className:S.searchItem}," ",i.a.createElement(d.a,{fullWidth:!0,simple:!0,textLabel:O("questions.language"),label:"language",options:[{primaryText:"",value:""}].concat(Object(o.a)(V)),input:{onChange:function(e){L(e.target.value)},value:W}})),i.a.createElement("div",{className:S.searchItem}," ",i.a.createElement(m.a,{label:"Tag",width:"97.5%",simple:!0,textLabel:O("questions.tag"),input:{onChange:function(e){R(e.target.value)},value:N}}))),i.a.createElement(k.a,{fullWidth:!0,color:"secondary",size:"small",onClick:function(){D(""),R(""),L("")},style:{margin:"5px 0 0 0"}},O("questions.buttons.resetFilters")),(t||[]).filter((function(e){if(""===W||e.language===W)return e})).filter((function(e){if(""===_||e.difficulty===_)return e})).filter((function(e){if((e.tags||[]).find((function(e){if(e.toLowerCase().includes(N.toLowerCase()))return e}))||""===N)return e})).map((function(e,o){var r;if("mc"===e.type&&(P+=1),"essay"===e.type&&(z+=1),"speaking"===e.type&&(U+=1),"fillInBlank"===e.type&&(H+=1),"Multiple-choice questions"===c&&(r="mc"),"Essay questions"===c&&(r="essay"),"Speaking questions"===c&&(r="speaking"),"Fill-in-the-blanks questions"===c&&(r="fillInBlank"),e.type===r)return i.a.createElement(f.a,{key:e._id},i.a.createElement(p.a,{dense:!0,button:!0,onClick:function(o){var r;s?(o.stopPropagation(),function(e,t,n,a){if("mc"===e.type&&n("mcQuestions.".concat(t),Object(T.a)(Object(T.a)({},e.mcQuestion),{},{marks:1})),"essay"===e.type&&n("essayQuestions.".concat(t),Object(T.a)(Object(T.a)({},e.essayQuestion),{},{marks:1})),"speaking"===e.type){var o={questionRecordedBlob:(e.speakingQuestion||{}).audioQuestion&&""!==(e.speakingQuestion||{}).audioQuestion?(e.speakingQuestion||{}).audioQuestion:"",recordedBlob:(e.speakingQuestion||{}).audio&&""!==(e.speakingQuestion||{}).audio?(e.speakingQuestion||{}).audio:"",question:(e.speakingQuestion||{}).question,audioAnswer:!!(e.speakingQuestion||{}).audio,audioQuestion:!!(e.speakingQuestion||{}).audioQuestion,audioFile:(e.speakingQuestion||{}).audio,audioFileQuestion:(e.speakingQuestion||{}).audioQuestion,marks:1};n("speakingQuestions.".concat(t),o)}"fillInBlank"===e.type&&(n("fillBlankQuestions",function(e){var t=(e.fillBlankQuestions||{}).blanks||[],n=t.map((function(e,t){var n=e.audio&&""!==e.audio,a=(e.incorrectAnswers||[]).filter((function(e){return e})).reduce((function(e,t,n){var a;return 0===n&&(a="One"),1===n&&(a="Two"),2===n&&(a="Three"),e["incorrectAnswer".concat(a)]=t,e}),{});return{answer:e.correctAnswer,selectableAnswer:e.selectableAnswer,answerOptions:a,marks:1,audio:n,browserAudioFile:n?e.audio:"",audioFile:n?e.audio:null}}));return{question:(e.fillBlankQuestions||{}).question,answers:n,correctAnswers:t.map((function(e){return e.correctAnswer}))}}(e)),a())}((r=e._id,(t||[]).find((function(e){return r===e._id}))),l,(function(e,t){F(e,t)}),h)):(n(e.type,!0,function(e,t){var n=(t||[]).find((function(t){return t._id===e})),a=(n||{}).speakingQuestion||{},o=n;"speaking"===(n||{}).type&&(o=Object(T.a)(Object(T.a)({},n),{},{speakingQuestion:[{question:a.question,questionRecordedBlob:a.audioQuestion?a.audioQuestion:"",recordedBlob:a.audio?a.audio:"",audioFileQuestion:a.audioQuestion,audioFile:a.audio,audioAnswer:!(!a.audio||""===a.audio),audioQuestion:!(!a.audioQuestion||""===a.audioQuestion)}]}));var r=(n||{}).fillBlankQuestions||{},s=r.blanks||[];return"fillInBlank"===(n||{}).type&&(o=Object(T.a)(Object(T.a)({},n),{},{fillBlankQuestions:{question:r.question,answers:s.map((function(e){var t=(e.incorrectAnswers||[]).filter((function(e){return e})).reduce((function(e,t,n){var a;return 0===n&&(a="One"),1===n&&(a="Two"),2===n&&(a="Three"),e["incorrectAnswer".concat(a)]=t,e}),{});return{answer:e.correctAnswer,audioFile:e.audio,browserAudioFile:e.audio?e.audio:"",audio:!(!e.audio||""===e.audio),selectableAnswer:e.selectableAnswer,answerOptions:t}})),correctAnswers:s.map((function(e){return e.correctAnswer}))}})),o}(e._id,t)),a(e._id),w())}},s?i.a.createElement(g.a,null,i.a.createElement(y.a,null)):i.a.createElement(g.a,null,i.a.createElement(E.a,null)),"mc"===e.type&&i.a.createElement(b.a,{primary:P+" "+((e.mcQuestion||{}).question||"").replace(/<[^>]+>/g,"").slice(0,25)+"..."}),"essay"===e.type&&i.a.createElement(b.a,{primary:z+" "+((e.essayQuestion||{}).question||"").replace(/<[^>]+>/g,"").slice(0,25)+"..."}),"speaking"===e.type&&i.a.createElement(b.a,{primary:(U+" "+(e.speakingQuestion||{}).question||"").replace(/<[^>]+>/g,"").slice(0,25)+"..."}),"fillInBlank"===e.type&&i.a.createElement(b.a,{primary:(H+" "+(e.fillBlankQuestions||{}).question||"").replace(/<[^>]+>/g,"").slice(0,25)+"..."})))})))}))},864:function(e,t,n){"use strict";var a=n(0),o=n.n(a),r=n(1239),s=n(1178),i=n(741),c=n(442),l=n(743),u=n(740),d=Object(u.a)((function(e){return{margin:{marginBottom:"15px"},MuiFormLabel:{fontSize:"1.2em"},errorText:{color:"#e91313",fontFamily:"Helvetica",fontSize:"0.75rem"},font:{fontSize:"0.7em !important"}}}));t.a=function(e){var t=e.input,n=e.meta,a=void 0===n?{}:n,u=e.options,m=e.title,f=e.error,p=e.row,g=void 0!==p&&p,b=d(),h=a.touched&&(a.error||f),E=u.map((function(e){return o.a.createElement(i.a,Object.assign({key:e.label},t,{value:e.value,control:o.a.createElement(r.a,{color:e.color}),label:e.label,labelPlacement:e.placement,checked:e.checked,className:b.font}))}));return o.a.createElement("div",{className:b.margin},o.a.createElement(c.a,{margin:"dense",component:"fieldset"},o.a.createElement(l.a,{className:b.MuiFormLabel},m),o.a.createElement(s.a,{row:g,value:t.value,"aria-label":"gender"},E),o.a.createElement("span",{className:b.errorText},h?a.error||f:""," ")))}},886:function(e,t,n){"use strict";var a=n(0),o=n.n(a),r=n(30),s=n(1024);t.a=Object(r.b)((function(e){return{width:e.common.width,isDarkTheme:e.common.isDarkTheme}}))((function(e){var t=e.data,n=e.width,a=e.testForm,r=e.isDarkTheme,i={top:n>450?0:-200,right:110,bottom:n>450?0:-200,left:110};return a&&(i={top:n>450?50:-150,right:n>450?130:70,bottom:n>450?50:-150,left:n>450?130:70}),o.a.createElement(s.a,{data:t,margin:i,innerRadius:0,padAngle:.7,cornerRadius:3,colors:{scheme:"category10"},borderWidth:1,borderColor:{from:"color",modifiers:[["darker","0.2"]]},radialLabelsSkipAngle:10,radialLabelsTextXOffset:0,radialLabelsLinkOffset:-10,radialLabelsLinkDiagonalLength:15,radialLabelsLinkHorizontalLength:3,radialLabelsLinkStrokeWidth:1,radialLabelsLinkColor:{from:"color"},enableSlicesLabels:!1,slicesLabelsSkipAngle:3,slicesLabelsTextColor:"#333333",animate:!0,motionStiffness:90,motionDamping:15,theme:r?{textColor:"white",labels:{text:{fill:"white"}},background:"#424242",tooltip:{chip:{color:"white"},basic:{background:"#424242"},container:{background:"#424242"}}}:{}})}))},899:function(e,t,n){"use strict";var a=n(0),o=n.n(a),r=n(840),s=n.n(r);t.a=function(e){var t=e.source,n=e.id;return o.a.createElement("td",{dangerouslySetInnerHTML:{__html:'\n        <audio id="'.concat(n,'" src="').concat(t,'">\n        </audio>\n        <span class="').concat(s.a.Pointer,'" onClick="(function(){\n        const audio = document.getElementById(\'').concat(n,'\');\n        audio.play()\n        return false;\n        })();return false;" >\n        <i class="fa fa-volume-down"></i>\n        </span>\n        ')}})}},947:function(e,t,n){"use strict";var a=n(6),o=n.n(a),r=n(53),s=n(24),i=n(51),c=n(52),l=n(57),u=n(56),d=n(0),m=n.n(d),f=n(851),p=n.n(f),g=n(30),b=n(333),h=n(337),E=n(339),v=n(31),k=n(332),F=n(34),y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3?arguments[3]:void 0,o=t.length-e.length;if(t.length!==e.length){var r={marks:1,incorrectAnswerOptions:{incorrectAnswerOne:"",incorrectAnswerTwo:"",incorrectAnswerThree:""},selectableAnswer:!1,audio:!1,browserAudioFile:null,audioFile:null},i={marks:null,answerOptions:{incorrectAnswerThree:null},browserAudioFile:null};if(e.length<t.length){var c=t.findIndex((function(t,n){return!e.includes(t)}));if(t.length>0){if(0!==c){var l=function(e,t,n){return[].concat(Object(F.a)(e.slice(0,t)),[n],Object(F.a)(e.slice(t)))},u=e.length-1;t.splice.apply(e,[u,0].concat(e));new Array(o);var d=l(n,c,Object(s.a)(Object(s.a)({},r),{},{answer:t[c]})),m=l(a,c,i);return{answersToUpdate:d.map((function(e,n){return Object(s.a)(Object(s.a)({},e),{},{answer:t[n]})})),errorsToUpdate:m}}n.unshift(Object(s.a)(Object(s.a)({},r),{},{answer:t[0]})),a.unshift(i)}}if(e.length>t.length){var f=function(e,t){var n=[];return e.forEach((function(a,o){t.includes(e[o])||n.push(o)})),n},p=f(e,t);if(1===p.length)n.splice(p[0],1),a.splice(p[0],1);else{var g=p[0],b=p.length;n.splice(g,b),a.splice(g,b)}}if(e.length<t.length&&!n){var h=e.length-1;t.splice.apply(e,[h,0].concat(e));var E=new Array(o);n=E.map((function(e){return r})),a=E.map((function(e){return i}))}return{answersToUpdate:n.map((function(e,n){return Object(s.a)(Object(s.a)({},e),{},{answer:t[n]})})),errorsToUpdate:a}}},w=n(142),O=n(239),T=n(238),x=n(820),j=n(856),S=n(35),A=n(241),C=n(852),_=n.n(C),D=n(845),Q=n.n(D),B=n(240),N=n(244),R=n(816),q=n(833),I=function(e){var t=e.blankIndex,n=e.t,a=e.answers,o=e.meta,r=void 0===o?{}:o,s=e.error;return m.a.createElement(S.a,null,m.a.createElement("select",{readOnly:!0,value:"select the correct answer",className:Q.a.SelectField},["select the correct answer","Correct option","Incorrect option 1","Incorrect option 2","Incorrect option 3"].map((function(e,o){var r,s=(a[t]||{}).answerOptions||{};return 0===o&&(r=n("testForm.fields.selectCorrectAnswerInline")),1===o&&(r=(a[t]||{}).answer),2===o&&(r=s.incorrectAnswerOne),3===o&&(r=s.incorrectAnswerTwo),4===o&&(r=s.incorrectAnswerThree),m.a.createElement("option",{key:"".concat(e,"[").concat(o,"]"),className:1===o?Q.a.CorrectAnswerHighlight:null,disabled:!0,value:e},r)}))),m.a.createElement("div",{className:Q.a.flexPositioningEven},m.a.createElement("span",{className:Q.a.errorText},(r.error||s)&&r.touched?r.error||s:""," ")))},W=n(899),L=n(900),M=n.n(L),V=n(78),P=(n(1005),n(821)),z=n.n(P),U=n(747),H=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e,a){var o;return Object(i.a)(this,n),(o=t.call(this,e,a)).handleMicAlert=function(){clearTimeout(o.state.micBlockedWarningTO),o.setState({micBlockedWarning:!0});var e=setTimeout((function(){o.setState({micBlockedWarning:!1})}),5e3);o.setState({micBlockedWarningTO:e})},o.initiateRecording=function(e,t,n,a){if(a){var r=o.props,s=r.changeField,i=r.form,c="fillBlankQuestions.answers";s(i,"".concat(c,".").concat(n,".recordingQuestion"),a),s(i,"".concat(c,".").concat(n,".questionRecorder"),e),s(i,"".concat(c,".").concat(n,".questionRecordingTimeout"),t)}else o.handleMicAlert()},o.setAudioData=function(e,t,n){var a=o.props,r=a.changeField,s=a.touchField,i=a.form,c="fillBlankQuestions.answers";r(i,"".concat(c,".").concat(n,".recordingQuestion"),!1),r(i,"".concat(c,".").concat(n,".browserAudioFile"),e),r(i,"".concat(c,".").concat(n,".audioFile"),t),s(i,"".concat(c,".").concat(n,".browserAudioFile"))},o.state={previousCorrectAnswers:[],currentCorrectAnswers:[],previousAnswers:[],currentAnswers:[],blockSync:!1,micBlockedWarning:!1,micBlockedWarningTO:null},o}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=Object(w.a)(this.props.formValues);this.props.updateErrors("testForm",e)}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.formValues,n=void 0===t?{}:t,a=e.formValues,o=void 0===a?{}:a,r=n.fillBlankQuestions||[],s=o.fillBlankQuestions||[];this.setState({previousAnswers:r.answers,currentAnswers:s.answers,previousCorrectAnswers:r.correctAnswers,currentCorrectAnswers:s.correctAnswers})}},{key:"componentDidUpdate",value:function(){this.state.blockSync&&this.setState({blockSync:!1})}},{key:"componentWillUnmount",value:function(){clearTimeout(this.state.micBlockedWarningTO)}},{key:"getRecordingTimeoutQuestion",value:function(e){return(((this.props.formValues.fillBlankQuestions||[]).answers||[])[e]||{}).questionRecordingTimeout}},{key:"getRecorderFromClickQuestion",value:function(e){return(((this.props.formValues.fillBlankQuestions||[]).answers||[])[e]||{}).questionRecorder}},{key:"touchIncorrectAnswerFields",value:function(e){var t=this,n="fillBlankQuestions.answers.".concat(e,".answerOptions.incorrectAnswer");["One","Two","Three"].forEach((function(e){t.props.touchField(t.props.form,n+e)}))}},{key:"handleBlockSync",value:function(e){this.setState({blockSync:!!e})}},{key:"render",value:function(){var e=this,t=this.props,n=t.formValues,a=void 0===n?{}:n,i=t.formErrors,c=void 0===i?{}:i,l=t.touchField,u=t.changeField,d=t.updateErrors,f=t.form,g=t.isModal,h=t.path,E=t.t,v=(a.fillBlankQuestions||{}).answers||[],k=(c.fillBlankQuestions||{}).answers||[];if((this.state.previousCorrectAnswers||[]).findIndex((function(t,n){return t!==e.state.currentCorrectAnswers[n]?t:null}))>-1){var F=(this.state.currentAnswers||[]).map((function(t,n){return Object(s.a)(Object(s.a)({},t),{},{answer:e.state.currentCorrectAnswers[n]})}));u(f,"fillBlankQuestions.answers",F)}var C=(a.fillBlankQuestions||{}).correctAnswers;if((this.state.currentCorrectAnswers||[]).length!==(this.state.previousCorrectAnswers||[]).length&&!this.state.blockSync){var D=y(this.state.previousCorrectAnswers,C,this.state.currentAnswers,k),L=D.answersToUpdate,P=D.errorsToUpdate;u(f,"fillBlankQuestions.answers",L),d(f,Object(s.a)(Object(s.a)({},c),{},{fillBlankQuestions:{question:(c.fillBlankQuestions||{}).question,answers:P}})),this.state.currentCorrectAnswers.forEach((function(t,n){var a={fillBlankQuestions:{answers:L}};t.marks||l("fillBlankQuestions.answers.".concat(n,".marks"));var o=Object(w.a)(a);((o.fillBlankQuestions.answers[n]||{}).answerOptions||{}).incorrectAnswerThree&&e.touchIncorrectAnswerFields(n),(o.fillBlankQuestions.answers[n]||{}).browserAudioFile&&l("fillBlankQuestions.answers.".concat(n,".browserAudioFile"))}))}var U=(a.fillBlankQuestions||{}).question||"",H=U.match(/<mark [^>]+>(.*?)<\/mark>/g),G=_()(U,/<mark [^>]+>(.*?)<\/mark>/g,(function(e,t){var n=t/2-.5,a=((v||[])[n]||{}).answer,o=(v[n]||{}).browserAudioFile,r=((v||[])[n]||{}).selectableAnswer;return!0===r?m.a.createElement(S.a,{key:e+n},m.a.createElement("span",{className:Q.a.BlankPreview},n+1," "),(v[n]||{}).audio&&o&&m.a.createElement(W.a,{id:"audio[".concat(n,"]"),source:o}),m.a.createElement(I,{blankIndex:n,answers:v,t:E})):!1===r?m.a.createElement(S.a,{key:e+n},m.a.createElement("span",{className:Q.a.Inline},m.a.createElement("span",{className:Q.a.BlankPreview},n+1," "),(v[n]||{}).audio&&o&&m.a.createElement(W.a,{id:"audio[".concat(n,"]"),source:o}),m.a.createElement("input",{readOnly:!0,type:"text",className:Q.a.InputField,value:"".concat(M()(a))}))):void 0})),Y=[];G.forEach((function(e,t){"string"===typeof e?Y.push(e):Y.push(p.a.renderToString(e))}));var X=(Y||[]).join("").replace(/<img/g,'<img style="width:100%"'),J=(H||[]).map((function(e){return e.replace(/<[^>]+>/g,"")}));return u(f,"fillBlankQuestions.correctAnswers",J),m.a.createElement(S.a,null,"testForm"===f&&m.a.createElement(V.a,{variant:"h4",gutterBottom:!0,paragraph:!0},E("testForm.fillblanksSection")),m.a.createElement("div",{className:Q.a.TextEditor},m.a.createElement(b.a,{component:A.a,isModal:g,name:"fillBlankQuestions.question",label:E("testForm.fillblanksText"),field:"fillBlankQuestions.question",reduxForm:f,error:(c.fillBlankQuestions||{}).question,path:h,blockFillblankSynchronization:this.state.blockSync})),X&&m.a.createElement("div",{className:Q.a.PreviewContainer},m.a.createElement(V.a,{paragraph:!0,variant:"h6"},E("testForm.preview")),m.a.createElement("div",{dangerouslySetInnerHTML:{__html:z.a.sanitize(X,{ALLOW_UNKNOWN_PROTOCOLS:!0,ADD_ATTR:["src","onclick"],ADD_TAGS:["audio"]})}})),"testForm"===f&&m.a.createElement(x.a,{summary:E("testForm.textFromQuestionbank"),index:0},m.a.createElement(j.a,{questionType:"Fill-in-the-blanks questions",selecting:!0,onBlockSync:function(){return e.handleBlockSync(!0)}})),v.length>0?m.a.createElement(V.a,{style:{marginTop:20},variant:"h6",gutterBottom:!0,paragraph:!0},E("testForm.customizeAnswers")):"",m.a.createElement("ul",{className:Q.a.TestFormList},v.map((function(t,n){var a=m.a.createElement(S.a,null,m.a.createElement("div",{style:{display:"flex",justifyContent:"space-evenly"}},m.a.createElement(b.a,{name:"fillBlankQuestions.answers.".concat(n,".audioFile"),component:N.a,uploadButtonText:E("testForm.buttons.selectAudioFile"),index:n,onChangeFile:function(e,t){u(f,"fillBlankQuestions.answers.".concat(t,".browserAudioFile"),e)},mimeTypesAllowed:"audio/*",extensionsAllowed:["mp3","wav","wma"]})),m.a.createElement(b.a,{component:q.a,name:"fillBlankQuestions.answers.".concat(n,".browserAudioFile"),onStart:function(){var t=Object(r.a)(o.a.mark((function t(a){var s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(R.c)(a,null,n,null,function(){var t=Object(r.a)(o.a.mark((function t(a){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a;case 2:r=t.sent,e.setAudioData(r.blob,r.file,n);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0={};case 5:s=t.t0,e.initiateRecording(s.recorder,s.recordingTimeout,n,s.isRecording);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),onStop:function(){var t=Object(r.a)(o.a.mark((function t(a){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(R.d)(a,null,n,e.getRecordingTimeoutQuestion(n),e.getRecorderFromClickQuestion(n));case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0={};case 5:r=t.t0,e.setAudioData(r.blob,r.file,n);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),onPreview:function(){Object(R.b)("audioQuestion[".concat(n,"]"))},onClear:function(){return e.setAudioData(null,null,n)},id:"audioQuestion[".concat(n,"]"),recordDisabled:(v[n]||{}).recordingQuestion,audioSource:(v[n]||{}).browserAudioFile,isMicAlert:e.state.micBlockedWarning}));return m.a.createElement("li",{key:"blanks[".concat(n,"]")},m.a.createElement("div",{className:Q.a.QuestionCustomizationContainer},m.a.createElement(V.a,{variant:"h6",gutterBottom:!0},"".concat(E("testForm.blank")," ").concat(n+1)),m.a.createElement(V.a,{className:Q.a.CorrectAnswer,variant:"body1",gutterBottom:!0,paragraph:!0},"".concat(E("testForm.correctAnswer"),": "),v[n]?v[n].answer.replace(/&nbsp;/g," "):""),m.a.createElement(b.a,{name:"fillBlankQuestions.answers.".concat(n,".selectableAnswer"),options:{checked:!1,label:E("testForm.fields.selectableAnswer")},component:B.a,type:"checkbox"}),m.a.createElement(b.a,{name:"fillBlankQuestions.answers.".concat(n,".audio"),type:"checkbox",options:{checked:!1,label:E("testForm.audio")},component:B.a}),v[n].selectableAnswer&&m.a.createElement(S.a,null,m.a.createElement(V.a,{variant:"body1",gutterBottom:!0,paragraph:!0},E("testForm.incorrectAnswerOptions")),["incorrectAnswerOne","incorrectAnswerTwo","incorrectAnswerThree"].map((function(t,a){return m.a.createElement("div",{key:"".concat(t,"[").concat(a,"]"),className:Q.a.TextField},m.a.createElement(b.a,{wait:250,component:O.a,name:"fillBlankQuestions.answers.".concat(n,".answerOptions.").concat(t),label:"".concat(E("testForm.incorrectOption")," ").concat(a+1),margin:"dense",variant:"outlined",size:"small",simple:!0,width:"95%",debounce:!0,onChange:function(){return e.touchIncorrectAnswerFields(a)}}))}))),(v[n]||{}).audio?a:null,"testForm"===f&&m.a.createElement("div",{style:{marginTop:15}},m.a.createElement(b.a,{name:"fillBlankQuestions.answers.".concat(n,".marks"),component:T.a,error:(k[n]||{}).marks,options:{label:E("testForm.fields.marks"),size:"small"}}))))}))))}}]),n}(d.Component),G=Object(k.a)({destroyOnUnmount:!1,forceUnregisterOnUnmount:!1,validate:w.a})(H);t.a=Object(g.b)((function(e,t){var n=t.form;return{formValues:Object(h.a)(n)(e),formErrors:Object(E.a)(n)(e)}}),(function(e){return{touchField:function(t,n){e(Object(v.d)(t,n))},changeField:function(t,n,a){e(Object(v.a)(t,n,a))},updateErrors:function(t,n){e(Object(v.e)(t,n))}}}))(Object(U.a)("common")(G))}}]);
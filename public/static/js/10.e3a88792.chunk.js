(this["webpackJsonpe-learn"]=this["webpackJsonpe-learn"]||[]).push([[10],{1016:function(e,t,n){"use strict";n.r(t);var a=n(52),r=n(53),o=n(56),s=n(55),i=n(0),c=n.n(i),l=n(4),u=n(25),d=n(336),m=n(338),f=n(331),p=n(332),g=n(32),v=function(e){var t={mc:!1,essay:!1,speaking:!1,fillblanks:!1,allAnswersFilled:!0};return(e.mcQuestions||[]).forEach((function(e){0===e.length&&(t.mc=!0,t.allAnswersFilled=!1)})),(e.essayQuestions||[]).forEach((function(e){e||(t.essay=!0,t.allAnswersFilled=!1)})),(e.speakingQuestions||[]).forEach((function(e){e.audioFile||(t.speaking=!0,t.allAnswersFilled=!1)})),((e.fillBlankQuestions||{}).answers||[]).forEach((function(e){e&&"Select the correct answer"!==e||(t.fillblanks=!0,t.allAnswersFilled=!1)})),t},b=n(853),E=n(31),h=n(80),y=n(814),k=n(817),_=n(341),T=Object(f.a)({form:"studentTest",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0,validate:v})((function(e){var t=e.testInSession,n=Object(_.a)().t,a=t.readingMaterials[0]||{},r=t.audioMaterials[0]||{},o={background:"#1976d2",borderRadius:4,color:"white",padding:10};return c.a.createElement(E.a,null,c.a.createElement(k.a,{audioId:"mcAudioMaterial",pdfIndex:1,readingContent:a.content,audioSource:r.audio,onPreview:function(){return Object(y.b)("mcAudioMaterial")},fileUpload:a.fileUpload}),((t||{}).multipleChoiceQuestions||[]).map((function(e,t){var a=((e||{}).answerOptions||[]).map((function(e,t){return{label:e,value:e,placement:"start",color:"primary",name:"mc"}}));return c.a.createElement(E.a,{key:e._id},c.a.createElement(h.a,{paragraph:!0,variant:"h6"},"".concat(n("testSession.question")," ").concat(t+1)),c.a.createElement("div",{style:o,dangerouslySetInnerHTML:{__html:e.question}}),c.a.createElement(p.a,{name:"mcQuestions.".concat(t),component:b.a,numbered:!0,options:a,required:!1,column:!0}))})))})),S=Object(u.b)(null,(function(e){return{clearAnswers:function(t){e(Object(g.a)("testForm","mcQuestions[".concat(t,".correctAnswers]"),[]))}}}))(T),w=n(240),I=Object(f.a)({form:"studentTest",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0,validate:v})((function(e){var t=e.testInSession,n=e.path,a=Object(_.a)().t,r=t.readingMaterials[1]||{},o=t.audioMaterials[1]||{},s={background:"#1976d2",borderRadius:4,color:"white",padding:10,marginBottom:30};return c.a.createElement(E.a,null,c.a.createElement(k.a,{audioId:"essayAudioMaterial",pdfIndex:2,readingContent:r.content,audioSource:o.audio,onPreview:function(){return Object(y.b)("essayAudioMaterial")},fileUpload:r.fileUpload}),((t||{}).essayQuestions||[]).map((function(e,t){return c.a.createElement(E.a,{key:e._id},c.a.createElement(h.a,{paragraph:!0,variant:"h6"},"".concat(a("testSession.question")," ").concat(t+1)),c.a.createElement("div",{style:s,dangerouslySetInnerHTML:{__html:e.question}}),c.a.createElement(p.a,{component:w.a,noImage:!0,name:"essayQuestions.".concat(t),field:"essayQuestions.".concat(t),reduxForm:"studentTest",path:n}))})))})),O=n(849),x=n.n(O),j=n(850),P=n.n(j),A=n(881),C=n.n(A),N=n(898),M=n.n(N),D=n(819),F=n.n(D),L=n(746),R=function(e){Object(o.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).blankListener=function(t){var n=parseInt((t.target.id.match(/\d+/)||[])[0]);(((e.props.formValues||{}).fillBlankQuestions||{}).answers||[]).map((function(e,t){return"blank-input-[".concat(t,"]")})).includes(t.target.id)&&e.props.updateAnswer(t.target.value,n)},e}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("change",(function(t){e.blankListener(t)}))}},{key:"render",value:function(){var e=this.props,t=e.formValues,n=e.t,a=e.testInSession,r=void 0===a?{}:a,o=(r.fillInBlanksQuestions||{}).blanks||[],s=P()(r.fillInBlanksQuestions.text,"-BLANK-",(function(e,a){var r=a/2-.5,s=(o[r]||[]).answerOptions;return!0===(o[r]||{}).selectableAnswer?c.a.createElement(E.a,{key:e+r},c.a.createElement("span",{className:C.a.BlankPreview},r+1," "),(o[r]||[]).audio&&c.a.createElement("span",{dangerouslySetInnerHTML:{__html:F.a.sanitize('\n                      <audio id="audio['.concat(r,']" src="').concat((o[r]||{}).audio,'">\n                        </audio>\n                        <span class="').concat(C.a.Pointer,'" onClick="(function(){\n                          const audio = document.getElementById(\'audio[').concat(r,']\');\n                          audio.play()\n                          return false;\n                          })();return false;" >\n                          <i class="fa fa-volume-down"></i>\n                        </span>\n                        '),{ADD_ATTR:["src","onclick"],ADD_TAGS:["audio"]})}}),c.a.createElement("select",{readOnly:!0,className:C.a.SelectField,id:"blank-input-[".concat(r,"]"),onChange:function(){return console.log("this is just to prevent error")},value:((((t||{}).fillBlankQuestions||{}).answers||[])[r]||"").trim()},c.a.createElement("option",null,n("testSession.fields.selectAnswer")),s.map((function(e,t){return c.a.createElement("option",{key:e+t,value:(e||"").replace(/"/g,"'").trim()},M()((e||"").replace(/"/g,"'")))})))):!1===(o[r]||[]).selectableAnswer?c.a.createElement(E.a,{key:e+r},c.a.createElement("span",{className:C.a.Inline},c.a.createElement("span",{className:C.a.BlankPreview},r+1," "),(o[r]||[]).audio&&c.a.createElement(E.a,null,c.a.createElement("span",{dangerouslySetInnerHTML:{__html:F.a.sanitize('\n                        <audio id="audio['.concat(r,']" src="').concat((o[r]||{}).audio,'">\n                        </audio>\n                        <span class="').concat(C.a.Pointer,'" onClick="(function(){\n                          const audio = document.getElementById(\'audio[').concat(r,']\');\n                          audio.play()\n                          return false;\n                          })();return false;" >\n                          <i class="fa fa-volume-down"></i>\n                        </span>\n                      '),{ADD_ATTR:["src","onclick"],ADD_TAGS:["audio"]})}})),c.a.createElement("input",{type:"text",className:C.a.InputField,id:"blank-input-[".concat(r,"]"),onChange:function(){return console.log("this is just to prevent error")},value:(((t||{}).fillBlankQuestions||{}).answers||[])[r]}))):void 0})),i=[];s.forEach((function(e,t){"string"===typeof e?i.push(e):i.push(x.a.renderToString(e))}));var l=(i||[]).join(""),u=r.readingMaterials[3]||{},d=r.audioMaterials[3]||{};return c.a.createElement(E.a,null,c.a.createElement(k.a,{audioId:"fillBlankAudioMaterial",pdfIndex:1,readingContent:u.content,audioSource:d.audio,onPreview:function(){return Object(y.b)("fillBlankAudioMaterial")},fileUpload:u.fileUpload}),c.a.createElement("div",{dangerouslySetInnerHTML:{__html:F.a.sanitize(l,{ADD_ATTR:["src","onclick"],ADD_TAGS:["audio"]})}}))}}]),n}(i.Component),B=Object(f.a)({form:"studentTest",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0,validate:v})(R),U=Object(u.b)(null,(function(e){return{updateAnswer:function(t,n){e(Object(g.a)("studentTest","fillBlankQuestions.answers.".concat(n),t))}}}))(Object(L.a)("common")(B)),Q=n(6),W=n.n(Q),z=n(73),H=n(812),V=n(438),q=n(894),Y=n.n(q),G=n(830),K=Object(f.a)({form:"studentTest",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0,validate:v})((function(e){var t=e.formValues,n=void 0===t?{}:t,a=e.changeField,r=e.testInSession,o={background:"#1976d2",borderRadius:4,color:"white",padding:10},s=Object(_.a)().t,l=Object(i.useState)(!1),u=Object(H.a)(l,2),d=u[0],m=u[1],f=Object(i.useState)(!1),g=Object(H.a)(f,2),v=g[0],b=g[1],T=function(e,t,n,r){r?(a("speakingQuestions.".concat(n,".recording"),r),a("speakingQuestions.".concat(n,".recorder"),e),a("speakingQuestions.".concat(n,".recordingTimeout"),t)):function(){clearTimeout(v),m(!0);var e=setTimeout((function(){m(!1)}),5e3);b(e)}()},S=function(e,t,n){a("speakingQuestions.".concat(n,".recording"),!1),a("speakingQuestions.".concat(n,".recordedBlob"),e),a("speakingQuestions.".concat(n,".audioFile"),t)},w=function(e){return((n||{}).speakingQuestions||[])[e]||{}},I=r.readingMaterials[2]||{},O=r.audioMaterials[2]||{};return Object(i.useEffect)((function(){return function(){clearTimeout(v)}}),[]),c.a.createElement(E.a,null,c.a.createElement(k.a,{audioId:"speakingAudioMaterial",pdfIndex:2,readingContent:I.content,audioSource:O.audio,onPreview:function(){return Object(y.b)("speakingAudioMaterial")},fileUpload:I.fileUpload}),r.speakingQuestions.map((function(e,t){return c.a.createElement(E.a,{key:e._id},c.a.createElement(h.a,{paragraph:!0,variant:"h6"},"".concat(s("testSession.question")," ").concat(t+1)),e.question?c.a.createElement("div",{style:o,dangerouslySetInnerHTML:{__html:e.question}}):c.a.createElement("div",null,c.a.createElement("audio",{id:"audioQuestion[".concat(t,"]"),src:e.questionAudio}),c.a.createElement(V.a,{fullWidth:!0,variant:"outlined",color:"primary",onClick:function(){Object(y.b)("audioQuestion[".concat(t,"]"))},startIcon:c.a.createElement(Y.a,null)},s("testSession.buttons.playQuestion"))),c.a.createElement(p.a,{component:G.a,isMicAlert:d,name:"speakingQuestions.".concat(t,".recordedBlob"),onStart:function(){var e=Object(z.a)(W.a.mark((function e(n){var a;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(y.c)(n,null,t,null,function(){var e=Object(z.a)(W.a.mark((function e(n){var a;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n;case 2:a=e.sent,S(a.blob,a.file,t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:a=e.t0,T(a.recorder,a.recordingTimeout,t,a.isRecording);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onStop:function(){var e=Object(z.a)(W.a.mark((function e(n){var a;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(y.d)(n,null,t,w(t).recordingTimeout,w(t).recorder);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:a=e.t0,S(a.blob,a.file,t);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onPreview:function(){Object(y.b)("audioAnswer[".concat(t,"]"))},onClear:function(){return S(null,null,t)},id:"audioAnswer[".concat(t,"]"),recordDisabled:w(t).recording,audioSource:w(t).recordedBlob,previewType:"button",recordButtonText:s("testSession.buttons.recordAnswer")}))})))})),J=Object(u.b)(null,(function(e){return{changeField:function(t,n){e(Object(g.a)("studentTest",t,n))}}}))(K),Z=n(248),X=n.n(Z),$=n(247),ee=n.n($),te=n(85),ne=n(246),ae=n(251),re=n(61),oe=n.n(re),se=Object(u.b)((function(e){return{testInSession:e.studentTest.testInSession}}))((function(e){var t=e.testInSession,n=e.classes,a=e.submitTest,r=Object(_.a)().t,o=t.endTime,s=c.a.useState(null),l=Object(H.a)(s,2),u=l[0],d=l[1];Object(i.useEffect)((function(){var e=setInterval((function(){var t=o-Date.now();d(t),t<0&&(a(),clearInterval(e))}),1e3);return function(){clearInterval(e)}}),[]);var m=parseInt(oe()(parseInt((t||{}).endTime)).format("H")),f=(parseInt(oe()(parseInt((t||{}).endTime)).format("HH")),oe()(parseInt((t||{}).endTime)).format("HH:mm"));return c.a.createElement("div",{style:{overflow:"hidden"}},u>0&&c.a.createElement(ae.a,{danger:u/1e3<60,activeStep:60*parseInt((t||{}).timer)-u/1e3-1,steps:60*parseInt((t||{}).timer),progress:!0}),u>0&&c.a.createElement("div",{className:u/1e3<60?n.timerDanger:n.timer},(t||{}).timer&&c.a.createElement("div",null,c.a.createElement(h.a,{variant:"subtitle1"},"".concat(r("testSession.testClosesAt",{laOrLas:1===m?"la":"las",time:f}))),u/1e3<300&&u/1e3>60&&(t||{}).timer>5&&c.a.createElement("div",{className:n.timeWarning},c.a.createElement(h.a,{variant:"caption"},r("testSession.lessThanFiveMin"))),u/1e3<60&&c.a.createElement("div",{className:n.timeWarning},c.a.createElement(h.a,{variant:"caption"},r("testSession.lessThanOneMin"))))))})),ie=n(865),ce=n(77),le=n.n(ce),ue=n(40),de=n(98),me=n(822),fe=function(e){Object(o.a)(n,e);var t=Object(s.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).onSubmit=function(e,t,n,a){if(t||n||r.props.formErrors.allAnswersFilled||r.state.isWarned||a){var o=Object(ne.a)((r.props.studentTest||{}).values,"studentTest"),s=(r.state.initialUrls||[]).filter((function(e){if(!o.includes(e))return e}));r.props.submitTest((r.props.studentTest||{}).values,r.props.token,r.props.userId,!t,r.props.testInSession,r.props.course._id,s,n,e),n&&r.props.exitAssignment()}else r.setState({isWarned:!0})},r.nextPage=function(){r.setState((function(e){return{page:e.page+1}}))},r.previousPage=function(){r.setState((function(e){return{page:e.page-1}}))},r.state={page:1,initialUrls:[],isWarned:!1,socket:null},r}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.startingValues,n=e.courses,a=e.notifications,r=(e.course,e.token),o=e.testInSession,s=e.setCourse,i=e.markAsSeen,c=e.fetchNotifications,l=e.fetchCourses,u=e.returnToCourses,d=e.fetchTestResults,m=e.userId,f=e.setTabLabels,p=Object(ne.a)(t,"studentTest"),g=t.course,v=(n||[]).find((function(e){return e._id===g}));s(v);var b=(a||[]).find((function(e){if(e.documentId===t.test&&"assignment"===e.documentType)return e}));b&&(i(b._id,r),c(r));var E=le()("https://mernstackelearn.herokuapp.com/",{query:{token:r}});E.on("mainMenu",(function(e){"student"!==e.userType&&e.userId!==m||!("deleteTest"===e.action&&o._id===e.testId||"deactivateCourse"===e.action&&(v||{})._id===e.course||("closeTest"===e.action||"excuseTest"===e.action)&&(t||{}).test===e.testId||"denyStudentCourseAccess"===e.action&&(v||{})._id===e.course&&e.userId===m||"resetTest"===e.action&&o._id===e.testId)||(f(["All courses","Your courses"]),l(r),d(r),u(),ue.a.push("/student-panel/courses"))})),this.setState({initialUrls:p,socket:E})}},{key:"componentWillUnmount",value:function(){this.state.socket.disconnect()}},{key:"render",value:function(){var e,t=this,n=this.props,a=n.testInSession,r=void 0===a?{}:a,o=n.isTest,s=n.loading,i=n.initialValues,l=n.formValues,u=n.formErrors,d=n.changeSection,m=(n.coursePanel,n.setCourse,n.width),f=n.t,p=(this.props.location.pathname,"courses/".concat((r||{}).course,"/tests/").concat((r||{})._id,"/results/").concat((i||{})._id)),g=(r||{}).sectionWeights||{},v=g.mcSection,b=g.essaySection,_=g.fillBlankSection,T=g.speakingSection,w=1,O=v?2:1;v&&b&&(e=3),!v&&b&&(e=2),v&&!b&&(e=2),v||b||(e=1);var x=((r||{}).audioMaterials||[])[4]||{},j=((r||{}).readingMaterials||[])[4]||{},P=x.audio&&""!==x.audio||j.content&&""!==j.content,A=Object.values((r||{}).sectionWeights||{}).filter((function(e){return null!==e})).length;P&&(w+=1,O+=1,e+=1,A+=1);var N=A,M=this.state.page;1===M&&P&&d("materials"),M===w&&v&&d("mc"),M===O&&b&&d("essay"),M===e&&T&&d("speaking"),M===N&&_&&d("fillblanks");var D,F=c.a.createElement("div",{className:1!==M?C.a.flexPositioningSpaceBetween:C.a.flexPositioningEnd},!(1===M)&&c.a.createElement(V.a,{color:"primary",style:{marginRight:"3px"},onClick:function(){t.previousPage(),t.setState({isWarned:!1})},startIcon:c.a.createElement(ee.a,null),size:"small"},P&&2===M?(r||{}).assignment?f("testSession.assignmentResources"):f("testSession.testResources"):f("testSession.buttons.previousSection")),!(M===A)&&c.a.createElement(V.a,{onClick:function(){t.nextPage(),t.setState({isWarned:!1})},style:{marginLeft:"3px"},color:"primary",endIcon:c.a.createElement(X.a,null),size:"small"},f(P&&1===M?"testSession.buttons.questions":"testSession.buttons.nextSection")));return M===w&&v&&(D=f("testSession.multiplechoicesection")),M===O&&b&&(D=f("testSession.essaysection")),M===e&&T&&(D=f("testSession.speakingsection")),M===N&&_&&(D=f("testSession.fillintheblankssection")),c.a.createElement("div",{style:m<500?{marginTop:30}:null,className:C.a.TestContainer},c.a.createElement(te.a,{active:s,transparent:!0}),c.a.createElement("div",{className:C.a.flexPositioningSpaceBetween},c.a.createElement(V.a,{onClick:function(){return t.onSubmit(p,!0)},size:"small"},f("testSession.buttons.save")),(r||{}).assignment&&c.a.createElement(V.a,{onClick:function(){return t.onSubmit(p,!0,!0)},color:"secondary",size:"small"},f("testSession.buttons.exit"))),(r||{}).timer&&c.a.createElement(se,{classes:C.a,submitTest:function(){return t.onSubmit(p,null,null,!0)}}),c.a.createElement(de.b,{exact:!0,path:o?"/student-panel/test-in-session":"*"},c.a.createElement(h.a,{style:{margin:20},variant:"h4",gutterBottom:!0},D),1===M&&P&&c.a.createElement(E.a,null,c.a.createElement(k.a,{audioId:"testAudioMaterial",pdfIndex:0,readingContent:j.content,audioSource:x.audio,onPreview:function(){return Object(y.b)("testAudioMaterial")},fileUpload:j.fileUpload})),M===w&&v&&c.a.createElement(E.a,null,c.a.createElement(S,{testInSession:r,test:o})),M===O&&b&&c.a.createElement(E.a,null,c.a.createElement(I,{test:o,path:p,testInSession:r})),M===e&&T&&c.a.createElement(E.a,null,c.a.createElement(J,{testInSession:r,test:o,formValues:l})),M===N&&_&&c.a.createElement(E.a,null,c.a.createElement(U,{formValues:l,testInSession:r,test:o})),F,this.state.isWarned&&!u.allAnswersFilled&&c.a.createElement(h.a,{paragraph:!0,color:"error",variant:"subtitle1",gutterBottom:!0},f("testSession.errors.questionsUnanswered")),c.a.createElement(me.a,{clicked:function(e){t.onSubmit(p)},isError:this.state.isWarned&&!u.allAnswersFilled},this.state.isWarned&&!u.allAnswersFilled?f("testSession.buttons.submitAnyway"):f("testSession.buttons.submit"))),c.a.createElement(de.b,{exact:!0,component:ie.a,path:"/student-panel/test-in-session/lessons"}))}}]),n}(i.Component);fe.getDerivedStateFromProps=function(e,t){return e.formErrors.allAnswersFilled?{isWarned:!1}:null};var pe=Object(f.a)({form:"studentTest",enableReinitialize:!0,destroyOnUnmount:!0,forceUnregisterOnUnmount:!0,validate:v})(fe);t.default=Object(de.k)(Object(u.b)((function(e,t){return{formValues:Object(d.a)("studentTest")(e),formErrors:Object(m.a)("studentTest")(e),token:e.authentication.token,userId:e.authentication.userId,testInSession:t.isTest?e.studentTest.testInSession:e.studentTest.assignmentInSession,studentTest:e.form.studentTest,testTimesUp:e.studentTest.testTimesUp,initialValues:e.studentTest.loadedTestDataInProgress,intervalId:e.studentTest.testTimerCheckerIntervalId,timeLeft:e.studentTest.testTimeLeft,loading:e.studentTest.loading,coursePanel:e.common.coursePanel,courses:e.common.courses,course:e.common.selectedCourse,testResults:e.studentTest.testResults,notifications:e.common.notifications,width:e.common.width,startingValues:e.studentTest.loadedTestDataInProgress}}),(function(e){return{submitTest:function(t,n,a,r,o,s,i,c,u){e(l.bd(t,n,a,r,o,s,i,c,u))},fetchNotifications:function(t){e(l.Fb(t))},fetchCourses:function(t,n){return e(l.tb(t,n))},fetchTestResults:function(t,n){return e(l.Pb(t,n))},changeSection:function(){e(l.Rc())},exitAssignment:function(){e(l.mb())},setTabLabels:function(t){e(l.Tc(t))},setCourse:function(t){e(l.Dc(t))},markAsSeen:function(t,n){e(l.fc(t,n))},returnToCourses:function(){e(l.xc())}}}))(Object(L.a)("common")(pe)))},814:function(e,t,n){"use strict";n.d(t,"d",(function(){return f})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return v}));var a=n(6),r=n.n(a),o=n(812),s=n(73),i=n(934),c=n.n(i),l=n(451),u=n(935),d=n.n(u),m=function(){var e=Object(s.a)(r.a.mark((function e(t,n,a,s){var i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("saving"),i=new c.a({bitRate:128}),(s||{}).lameEncoder&&(i=s),(t||{}).lameEncoder&&(i=t),console.log("is recorder: ",i),!i){e.next=9;break}return e.next=8,i.stop().getMp3().then((function(e){var t=Object(o.a)(e,2),r=t[0],s=t[1];return{blob:URL.createObjectURL(s),file:new File(r,n?"".concat(a,"-[").concat(n,"]recording.mp3"):"".concat(a,"-recording.mp3"),{type:s.type,lastModified:Date.now()}),index:a}}));case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),f=function(e,t,n,a,r){if(e){e.preventDefault();var o=m(null,t,n,r);return clearTimeout(a),o}},p=function(){var e=Object(s.a)(r.a.mark((function e(t,n,a,o,s){var i,u,d,f;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=new c.a({bitRate:128}),t){e.next=3;break}return e.abrupt("return");case 3:return t.preventDefault(),e.prev=4,e.next=7,i.start();case 7:return u=l.store.getState(),d=u.common.configuration.voiceRecordTimeLimit||60,f=setTimeout((function(){var e=m(i,n,a);s(e)}),1e3*d),e.abrupt("return",{recordingTimeout:f,isRecording:!0,recorder:i,index:a});case 13:return e.prev=13,e.t0=e.catch(4),e.abrupt("return",{isRecording:!1});case 16:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t,n,a,r,o){return e.apply(this,arguments)}}(),g=function(e){var t=document.getElementById(e);t&&t.play()},v=function(){var e=Object(s.a)(r.a.mark((function e(t,n){var a,o,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({video:!0,audio:!0});case 3:a=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log("e: ",e.t0);case 9:return o=d()(a,{type:"video",mimeType:"video/webm;codecs=h264",canvas:{width:640,height:480}}),t({recorder:o,stream:a}),o.startRecording(),i=function(e){return new Promise((function(t){return setTimeout(t,e)}))},6e4,e.next=16,i(6e4);case 16:o.stopRecording(Object(s.a)(r.a.mark((function e(){var s,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=o.getBlob(),i=new File([s],"video-recording.webm",{type:"video/webm"}),n(i),t({recorder:null,stream:null}),a.stop();case 5:case"end":return e.stop()}}),e)}))));case 17:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,n){return e.apply(this,arguments)}}()},817:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(832),s=n(103),i=n(245),c=n.n(i),l=n(844),u=n(80),d=n(819),m=n.n(d),f=(n(872),n(341));t.a=function(e){var t,n=e.readingContent,a=e.audioSource,i=e.fileUpload,d=e.materialsSection,p=Object(f.a)().t,g=(Object(s.a)(n)||"").split(".").pop();return i&&("pdf"===g&&(t=r.a.createElement(o.a,{url:n,index:d})),"jfif"!==g&&"jpgeg"!==g&&"jpg"!==g||(t=r.a.createElement("div",{style:{backgroundImage:'url("'.concat(n,'")'),backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",height:"200px",borderRadius:"3px",width:"100%",margin:"auto"}}))),"docx"!==g&&"doc"!==g||(t=r.a.createElement(c.a,{fileType:g,filePath:n})),r.a.createElement("div",{style:{marginBottom:20}},n&&r.a.createElement(u.a,{paragraph:!0,variant:"h6"},p("testMaterials.useTheFollowingContent")),!i&&n&&r.a.createElement("div",{style:{background:"#1976d2",borderRadius:4,color:"white",padding:10,marginTop:40},dangerouslySetInnerHTML:{__html:m.a.sanitize(n)}}),i&&n&&r.a.createElement("div",null,t),a&&r.a.createElement("div",{style:{marginTop:40}},r.a.createElement(u.a,{paragraph:!0,variant:"h6"},p("testMaterials.useTheAudio")),r.a.createElement(l.a,{audioSource:a})))}},822:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(739),s=n(434),i=n(438),c=Object(o.a)((function(e){return{SuccessButton:{background:"#4caf50","&:hover":{backgroundColor:"#388e3c",color:"#FFF"}},ErrorButton:{background:"#c62828","&:hover":{backgroundColor:"#b71c1c",color:"#FFF"}}}})),l=Object(s.a)(i.a)({border:0,borderRadius:3,color:"white",height:48,padding:"0 30px"});t.a=function(e){var t=e.isError,n=e.children,o=e.clicked,s=e.disabled,i=c();return r.a.createElement(a.Fragment,null,r.a.createElement(l,{disabled:s,onClick:o,fullWidth:!0,className:t?i.ErrorButton:i.SuccessButton},n))}},830:function(e,t,n){"use strict";n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return b}));var a=n(0),r=n.n(a),o=n(438),s=n(895),i=n.n(s),c=n(896),l=n.n(c),u=n(837),d=n.n(u),m=n(31),f=n(80),p=n(341),g=function(e){var t=e.onPreview,n=e.audioSource,a=e.id,s=e.previewType,i=e.previewText,c=e.disabled,l=e.fullWidth,u=Object(p.a)().t;return r.a.createElement(m.a,null,"button"===s?r.a.createElement(m.a,null,r.a.createElement("audio",{id:a,src:n}),r.a.createElement(o.a,{fullWidth:l,onClick:t,color:"primary",disabled:!n||""===n||c},i||u("audioRecorder.buttons.preview"))):r.a.createElement("div",{className:d.a.AudioAlignment},r.a.createElement("audio",{id:a,src:n}),r.a.createElement("span",{className:d.a.Pointer,onClick:t},r.a.createElement("i",{className:"fa fa-volume-down fa-2x ".concat(n?d.a.greenIcon:d.a.redIcon)}))))},v=function(e){var t=e.onClear,n=e.clearDisabled,a=Object(p.a)().t;return r.a.createElement("div",{className:d.a.flexPositioningEven},r.a.createElement(o.a,{color:"secondary",onClick:t,disabled:n},a("audioRecorder.buttons.clearAudio")))},b=function(e){var t=e.onStart,n=e.onStop,a=e.onPreview,s=e.recordDisabled,c=e.audioSource,u=e.id,b=e.meta,E=void 0===b?{}:b,h=e.error,y=e.onClear,k=e.clearDisabled,_=(e.playerDisabled,e.recordButtonText),T=e.previewType,S=e.isMicAlert,w=(e.chatRecorder,e.token,Object(p.a)().t);return r.a.createElement(m.a,null,"button"===T&&r.a.createElement("div",{className:d.a.flexPositioningEven},r.a.createElement(o.a,{onClick:t,disabled:s||S,startIcon:r.a.createElement(i.a,null),fullWidth:!0},_||w("audioRecorder.buttons.record"))),r.a.createElement("div",{style:{margin:"auto",display:"block",width:"60%"}},S&&r.a.createElement(f.a,{style:{textAlign:"center"},variant:"caption",color:"error"},w("audioRecorder.errors.micBlocked"))),r.a.createElement("div",{className:d.a.flexPositioningEven},"button"!==T&&r.a.createElement(o.a,{onClick:t,disabled:s||S,startIcon:r.a.createElement(i.a,null)},_||w("audioRecorder.buttons.record")),r.a.createElement(o.a,{onClick:n,disabled:!s||S,startIcon:r.a.createElement(l.a,null)},w("audioRecorder.buttons.stop")),r.a.createElement(g,{onPreview:c?a:null,audioSource:c,id:u,previewType:T})),r.a.createElement("div",{className:d.a.flexPositioningEven},r.a.createElement("span",{className:d.a.errorText},(E.error||h)&&E.touched?E.error||h:""," ")),r.a.createElement("div",{className:d.a.flexPositioningEven},r.a.createElement(v,{onClear:y,clearDisabled:k})))}},832:function(e,t,n){"use strict";var a=n(52),r=n(53),o=n(56),s=n(55),i=n(0),c=n.n(i),l=n(870),u=n.n(l),d=n(922),m=n(248),f=n.n(m),p=n(247),g=n.n(p),v=n(438),b=n(437),E=n(931),h=n.n(E),y=n(930),k=n.n(y),_=n(237),T=n(746);d.pdfjs.GlobalWorkerOptions.workerSrc="//cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(d.pdfjs.version,"/pdf.worker.js");var S=function(e){Object(o.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).state={numPages:null,pageNumber:1,scale:.6},e.onDocumentLoadSuccess=function(t){var n=t.numPages;e.setState({numPages:n,pageNumber:1})},e.previousPdfPage=function(){e.state.pageNumber>1&&e.setState({pageNumber:e.state.pageNumber-1})},e.nextPdfPage=function(){e.state.pageNumber<e.state.numPages&&e.setState({pageNumber:e.state.pageNumber+1})},e.setPdfPage=function(t){var n=parseInt(t.target.value),a=n;n>e.state.numPages&&(a=e.state.numPages),n<1&&(a=1),NaN!==n&&n||(a=1),e.setState({pageNumber:parseInt(a)})},e.handleScale=function(t){"in"===t&&e.setState((function(e){return{scale:e.scale+.2}})),"out"===t&&e.setState((function(e){return{scale:e.scale-.2}}))},e}return Object(r.a)(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.pageNumber,a=t.numPages,r=t.scale,o=this.props,s=o.url,i=o.t,l={label:i("pdf.goToPage"),size:"small"};return c.a.createElement("div",null,c.a.createElement("p",{className:u.a.pageNumberDisplay},i("pdf.page")," ",n," ",i("pdf.of")," ",a),c.a.createElement("div",{className:u.a.flexPositioningEven},c.a.createElement(v.a,{disabled:1===n,color:"default",onClick:this.previousPdfPage,startIcon:c.a.createElement(g.a,null),size:"small"},i("pdf.page")," ",1===n?1:n-1),c.a.createElement(v.a,{disabled:n===a,onClick:this.nextPdfPage,color:"default",endIcon:c.a.createElement(f.a,null),size:"small"},i("pdf.page")," ",n===a?a:n+1)),c.a.createElement("div",{style:{display:"flex",justifyContent:"space-evenly"}},c.a.createElement(_.a,{options:l,input:{onChange:this.setPdfPage}})),c.a.createElement("div",{style:{overflow:"scroll",maxHeight:"450px"}},c.a.createElement(d.Document,{className:u.a.pdfCanvas,file:s,onLoadSuccess:this.onDocumentLoadSuccess,onLoadError:function(e){return console.log(e)},renderMode:"svg"},c.a.createElement(d.Page,{scale:r,pageNumber:n}))),c.a.createElement("div",{className:u.a.flexPositioningEven},c.a.createElement(b.a,{onClick:function(){e.state.scale>=0&&e.handleScale("out")},color:"primary",component:"span"},c.a.createElement(k.a,null)),c.a.createElement(b.a,{onClick:function(){e.handleScale("in")},color:"primary",component:"span"},c.a.createElement(h.a,null))))}}]),n}(i.Component);t.a=Object(T.a)("common")(S)},837:function(e,t,n){e.exports={greenIcon:"AudioPlayer_greenIcon__knaj_",redIcon:"AudioPlayer_redIcon__VtpzN",flexPositioningEven:"AudioPlayer_flexPositioningEven__mBu5R",AudioAlignment:"AudioPlayer_AudioAlignment__1RjTd",Pointer:"AudioPlayer_Pointer__3IoHf",errorText:"AudioPlayer_errorText__1KeLa",advancedAudioPlayer:"AudioPlayer_advancedAudioPlayer__2hxRe","audio-player":"AudioPlayer_audio-player__q667P"}},844:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(932),s=n.n(o),i=(n(837),{width:"fit-content"}),c=[{className:"tier-top",style:{padding:"5px 0",margin:"auto",textAlign:"center"},innerComponents:[{type:"play",style:i},{type:"time",style:i}]}],l=[{className:"tier-top",style:{padding:"5px 0",margin:"auto",textAlign:"center"},innerComponents:[{type:"play",style:i},{type:"time",style:i},{type:"seek"}]}];t.a=function(e){var t=e.audioSource,n=e.noSeek,a=e.id;return r.a.createElement(s.a,{id:a||"audioplayerabc",playerWidth:"100%",audioFiles:[{src:t}],rearrange:n?c:l,iconSize:"1.5rem",fontSize:"1.2rem",sliderClass:"invert-blue-grey",hideForward:!0,hideRewind:!0,hideLoop:!0})}},853:function(e,t,n){"use strict";var a=n(35),r=n(52),o=n(53),s=n(56),i=n(55),c=n(0),l=n.n(c),u=n(332),d=n(13),m=n(1124),f=n(741),p=n(440),g=n(442),v=n(806),b=n(80),E=(n(31),function(e){Object(s.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(r.a)(this,n);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).field=function(t){var n=t.input,r=t.meta,o=t.options,s=t.classes,i=t.column,c=t.error,u=(n.name,n.onChange),d=n.value,E=o.map((function(t,n){var r=t.label,o=t.value,s=t.name,i=d.includes(o);return l.a.createElement("div",{key:r+n,style:{display:"flex",alignItems:"center"}},e.props.numbered&&l.a.createElement(b.a,{style:{marginRight:10},variant:"subtitle1"},n+1),l.a.createElement(f.a,{key:"checkbox-".concat(n),control:l.a.createElement(v.a,{name:"".concat(s,"[").concat(n,"]"),value:o,checked:i,onChange:function(e){var t=Object(a.a)(d);return e.target.checked?t.push(o):t.splice(t.indexOf(o),1),u(t)}}),label:r}))}));return l.a.createElement(p.a,{component:"fieldset"},l.a.createElement(b.a,{variant:"h6"},e.props.title),l.a.createElement(m.a,{row:!i,className:s.Margin},E),l.a.createElement(g.a,null,(r.error||c)&&r.touched?c||r.error:""))},e}return Object(o.a)(n,[{key:"render",value:function(){return l.a.createElement(u.a,Object.assign({name:"checkbox"},this.props,{type:"checkbox",component:this.field}))}}]),n}(c.Component));t.a=Object(d.a)((function(){return{MuiFormLabel:{fontSize:"1.2em"},Margin:{marginBottom:"15px"}}}))(E)},858:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=858},865:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(4),s=n(31),i=n(800),c=n(61),l=n.n(c),u=n(747),d=n(437),m=n(144),f=n.n(m),p=n(821),g=n.n(p),v=n(25),b=n(80),E=n(1309),h=n(847),y=n.n(h),k=n(806),_=n(741),T=n(341),S=function(e){var t=e.lessonSlides.length,n=e.lessonSlides.filter((function(e){return e.seen})).length/t*100;return Number.isNaN(n)?0:Math.round(100*(n+Number.EPSILON))/100};t.a=Object(v.b)((function(e){return{course:e.common.selectedCourse,studentLoggedIn:e.authentication.studentLoggedIn,instructorLoggedIn:e.authentication.instructorLoggedIn,token:e.authentication.token,notifications:e.common.notifications,testInSession:e.studentTest.testInSession}}),(function(e){return{onEditLesson:function(t,n){return e(o.zb(t,n))},changeTab:function(t){return e(o.Sc(t))},openModal:function(t,n){return e(o.nc(t,n))}}}))((function(e){var t=e.course,n=void 0===t?{}:t,a=e.instructorLoggedIn,o=e.studentLoggedIn,c=e.token,m=e.folder,p=e.isModules,v=e.onEditLesson,h=e.openModal,w=e.changeTab,I=e.testInSession,O=Object(T.a)().t;return((n||{}).lessons||[]).map((function(e,t){var T=n.lessons.map((function(e){return e._id})),x=(m||[]).filter((function(e){return"lesson"===e.documentType})).map((function(e){return e.documentId}))||[];if(!x.includes(e._id)&&p)return null;var j=[];return T.forEach((function(e){x.includes(e)&&j.push(e)})),r.a.createElement(s.a,{key:e._id},I&&0===t&&r.a.createElement(b.a,{style:{margin:20},variant:"h4"},"Lessons"),p&&j[0]===e._id&&r.a.createElement(u.a,{style:{background:"#2196f3"}},r.a.createElement(b.a,{style:{color:"white"}},O("lessons.lessons"))),r.a.createElement("div",null,r.a.createElement(u.a,{onClick:function(){h(e,"lesson")},button:!0,disabled:o&&Date.now()<e.availableOnDate},o&&0===(e.lessonSlides||[]).length&&r.a.createElement(_.a,{control:r.a.createElement(k.a,{disabled:!0,checked:!1,value:"checked"})}),o&&(e.lessonSlides||[]).length>0&&r.a.createElement(_.a,{control:r.a.createElement(k.a,{checked:-1===e.lessonSlides.findIndex((function(e){return!e.seen})),value:"checked"})}),p&&r.a.createElement(E.a,{style:{margin:"auto",minWidth:"30px"}},r.a.createElement(y.a,{color:"primary"})),r.a.createElement(i.a,{primary:p?o?"".concat(e.lessonName," ").concat(S(e),"%"):e.lessonName:o?"".concat(O("lessons.lesson")," ").concat(t+1," ").concat(e.lessonName," ").concat(S(e),"%"):"".concat(O("lessons.lesson")," ").concat(t+1," ").concat(e.lessonName),secondary:Date.now()<e.availableOnDate?"".concat(O("lessons.availableOn")," ").concat(l()(parseInt(e.availableOnDate)).locale(localStorage.getItem("i18nextLng")).format("dddd, MMMM DD YYYY, HH:mm")):null}),a&&r.a.createElement(s.a,null,r.a.createElement(d.a,{onClick:function(t){t.stopPropagation(),v((e||{})._id,c),w(1)}},r.a.createElement(g.a,{color:"primary"})),r.a.createElement(d.a,{onClick:function(t){t.stopPropagation(),h(e,"deleteLesson")}},r.a.createElement(f.a,{color:"secondary"}))))))}))}))},870:function(e,t,n){e.exports={pdfCanvas:"PdfViewer_pdfCanvas__2nu4D",flexPositioningEven:"PdfViewer_flexPositioningEven__1Lffj",pageNumberDisplay:"PdfViewer_pageNumberDisplay__qHBe7"}},872:function(e,t,n){},881:function(e,t,n){e.exports={TestContainer:"Test_TestContainer__7fONJ",flexPositioningSpaceBetween:"Test_flexPositioningSpaceBetween__3qcOt",flexPositioningEnd:"Test_flexPositioningEnd__1BT0d",button:"Test_button__3kZ9Q",Inline:"Test_Inline__2KPBl",center:"Test_center__3KQMR",TestTypeRadio:"Test_TestTypeRadio__2JWt_",ListHorizontalDisplay:"Test_ListHorizontalDisplay__3rpFy",TestFormList:"Test_TestFormList__2tEwo",Editor:"Test_Editor__1CVT1",greenIcon:"Test_greenIcon__3Ki1h",redIcon:"Test_redIcon__3oB4F",timer:"Test_timer__3Gexz",timerDanger:"Test_timerDanger__1UcdL",CorrectAnswerHighlight:"Test_CorrectAnswerHighlight__22Ntw",BlankPreview:"Test_BlankPreview__35Isy",InputField:"Test_InputField__36Ygf",FullWidth:"Test_FullWidth__3a30R",InputFieldBottomMargin:"Test_InputFieldBottomMargin__-lmnr",SelectField:"Test_SelectField__149Z_",Pointer:"Test_Pointer__8Sq0r",audioPlayerPreview:"Test_audioPlayerPreview__1ht6R"}},894:function(e,t,n){"use strict";var a=n(84);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(0)),o=(0,a(n(100)).default)(r.default.createElement("path",{d:"M3 10v4c0 .55.45 1 1 1h3l3.29 3.29c.63.63 1.71.18 1.71-.71V6.41c0-.89-1.08-1.34-1.71-.71L7 9H4c-.55 0-1 .45-1 1zm13.5 2c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 4.45v.2c0 .38.25.71.6.85C17.18 6.53 19 9.06 19 12s-1.82 5.47-4.4 6.5c-.36.14-.6.47-.6.85v.2c0 .63.63 1.07 1.21.85C18.6 19.11 21 15.84 21 12s-2.4-7.11-5.79-8.4c-.58-.23-1.21.22-1.21.85z"}),"VolumeUpRounded");t.default=o},923:function(e,t){},924:function(e,t){},925:function(e,t){},926:function(e,t){},927:function(e,t){},937:function(e,t){}}]);